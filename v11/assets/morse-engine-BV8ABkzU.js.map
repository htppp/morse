{"version":3,"file":"morse-engine-BV8ABkzU.js","sources":["../../../lib/dist/index.js"],"sourcesContent":["const f = {\n  A: \".-\",\n  B: \"-...\",\n  C: \"-.-.\",\n  D: \"-..\",\n  E: \".\",\n  F: \"..-.\",\n  G: \"--.\",\n  H: \"....\",\n  I: \"..\",\n  J: \".---\",\n  K: \"-.-\",\n  L: \".-..\",\n  M: \"--\",\n  N: \"-.\",\n  O: \"---\",\n  P: \".--.\",\n  Q: \"--.-\",\n  R: \".-.\",\n  S: \"...\",\n  T: \"-\",\n  U: \"..-\",\n  V: \"...-\",\n  W: \".--\",\n  X: \"-..-\",\n  Y: \"-.--\",\n  Z: \"--..\",\n  0: \"-----\",\n  1: \".----\",\n  2: \"..---\",\n  3: \"...--\",\n  4: \"....-\",\n  5: \".....\",\n  6: \"-....\",\n  7: \"--...\",\n  8: \"---..\",\n  9: \"----.\",\n  \" \": \"/\",\n  \".\": \".-.-.-\",\n  \",\": \"--..--\",\n  \":\": \"---...\",\n  \"?\": \"..--..\",\n  _: \"..--.-\",\n  \"+\": \".-.-.\",\n  \"-\": \"-....-\",\n  \"×\": \"-..-\",\n  \"^\": \"......\",\n  \"/\": \"-..-.\",\n  \"@\": \".--.-.\",\n  \"(\": \"-.--.\",\n  \")\": \"-.--.-\",\n  '\"': \".-..-.\",\n  \"'\": \".----.\",\n  \"=\": \"-...-\"\n}, U = Object.fromEntries(\n  Object.entries(f).map(([m, e]) => [e, m])\n);\nclass g {\n  /**\n   * テキストをモールス符号に変換\n   * @param text 変換するテキスト\n   * @returns モールス符号文字列（スペース区切り）\n   */\n  static textToMorse(e) {\n    const t = e.toUpperCase(), s = /\\[([A-Z]+)\\]/g, n = [];\n    let r = 0, i;\n    for (; (i = s.exec(t)) !== null; ) {\n      if (i.index > r) {\n        const h = t.substring(r, i.index), E = Array.from(h).map((l) => f[l] || l);\n        n.push(E.join(\" \"));\n      }\n      const c = Array.from(i[1]).map((h) => f[h] || h);\n      n.push(c.join(\"\")), r = s.lastIndex;\n    }\n    if (r < t.length) {\n      const a = t.substring(r), c = Array.from(a).map((h) => f[h] || h);\n      n.push(c.join(\" \"));\n    }\n    return n.filter((a) => a).join(\" \");\n  }\n  /**\n   * モールス符号シーケンスを文字に変換\n   * @param sequences モールス符号の配列（['.-', '-...', '...']など）\n   * @returns デコードされたテキスト\n   */\n  static morseToText(e) {\n    let t = \"\";\n    for (const s of e)\n      s === \"/\" ? t += \" \" : s && s !== \"\" && (t += U[s] || \"?\");\n    return t;\n  }\n  /**\n   * モールス符号マップを取得\n   * @returns 文字→モールス符号のマップ\n   */\n  static getMorseMap() {\n    return { ...f };\n  }\n  /**\n   * 1文字からモールス符号を取得\n   * @param char 変換する文字\n   * @returns モールス符号、未対応文字の場合はundefined\n   */\n  static charToMorse(e) {\n    return f[e.toUpperCase()];\n  }\n}\nclass x {\n  /**\n   * WPMからモールス信号のタイミングを計算する\n   *\n   * @param wpm - Words Per Minute（1分間あたりの単語数）\n   * @param options - タイミング計算のオプション\n   * @returns モールス信号のタイミング情報\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * console.log(timings.dot); // 60ms\n   * console.log(timings.dash); // 180ms\n   * ```\n   */\n  static calculate(e, t = {}) {\n    if (e <= 0)\n      throw new Error(`Invalid WPM value: ${e}. WPM must be greater than 0.`);\n    const s = 1200 / e, n = t.shortenGaps ? 0.9 : 1;\n    return {\n      dot: s,\n      dash: s * 3,\n      elementGap: s,\n      charGap: s * 3 * n,\n      wordGap: s * 7 * n\n    };\n  }\n  /**\n   * タイミング情報から文字確定までの待機時間を計算する\n   *\n   * @param timings - モールス信号のタイミング情報\n   * @returns 文字確定までの待機時間（ミリ秒）\n   */\n  static getCharGapDelay(e) {\n    const t = e.charGap / (e.dot * 3);\n    return e.dot * 4 * t;\n  }\n  /**\n   * タイミング情報から語間スペース確定までの待機時間を計算する\n   *\n   * @param timings - モールス信号のタイミング情報\n   * @returns 語間スペース確定までの待機時間（ミリ秒）\n   */\n  static getWordGapDelay(e) {\n    return e.wordGap;\n  }\n  /**\n   * 押下時間からdot/dashを判定する\n   *\n   * @param pressDuration - キー押下時間（ミリ秒）\n   * @param dotDuration - dot時間（ミリ秒）\n   * @returns '.'（dot）または '-'（dash）\n   */\n  static classifyElement(e, t) {\n    const s = t * 1.5;\n    return e < s ? \".\" : \"-\";\n  }\n}\nclass T {\n  /**\n   * タイミングレコードを作成する\n   *\n   * @param element - 入力された要素（'.' または '-'）\n   * @param actualDuration - 実際の押下時間（ミリ秒）\n   * @param timings - モールス信号のタイミング情報\n   * @param timestamp - 入力時刻（エポックミリ秒、省略時は現在時刻）\n   * @returns タイミングレコード\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * const record = TimingEvaluator.createRecord('.', 58, timings);\n   * console.log(record.expectedDuration); // 60ms (20 WPMの場合)\n   * ```\n   */\n  static createRecord(e, t, s, n = Date.now()) {\n    const r = e === \".\" ? s.dot : s.dash;\n    return {\n      element: e,\n      actualDuration: t,\n      expectedDuration: r,\n      timestamp: n\n    };\n  }\n  /**\n   * タイミングレコードを評価する\n   *\n   * @param record - タイミングレコード\n   * @returns タイミング評価結果\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * const record = TimingEvaluator.createRecord('.', 58, timings);\n   * const evaluation = TimingEvaluator.evaluate(record);\n   * console.log(evaluation.accuracy); // 96.67%\n   * console.log(evaluation.absoluteError); // 2ms\n   * ```\n   */\n  static evaluate(e) {\n    const t = Math.abs(e.actualDuration - e.expectedDuration), s = t / e.expectedDuration * 100, n = Math.max(0, 100 - s);\n    return {\n      record: e,\n      absoluteError: t,\n      relativeError: s,\n      accuracy: n\n    };\n  }\n  /**\n   * 複数の評価結果から統計情報を計算する\n   *\n   * @param evaluations - タイミング評価結果の配列\n   * @returns 統計情報\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * const records = [\n   *   TimingEvaluator.createRecord('.', 58, timings),\n   *   TimingEvaluator.createRecord('.', 62, timings),\n   *   TimingEvaluator.createRecord('-', 178, timings),\n   * ];\n   * const evaluations = records.map(r => TimingEvaluator.evaluate(r));\n   * const stats = TimingEvaluator.calculateStatistics(evaluations);\n   * console.log(stats.averageAccuracy); // 平均精度\n   * ```\n   */\n  static calculateStatistics(e) {\n    if (e.length === 0)\n      return {\n        count: 0,\n        averageAccuracy: 0,\n        averageAbsoluteError: 0,\n        averageRelativeError: 0,\n        maxAccuracy: 0,\n        minAccuracy: 0,\n        standardDeviation: 0\n      };\n    const t = e.map((o) => o.accuracy), s = e.map((o) => o.absoluteError), n = e.map((o) => o.relativeError), r = t.reduce((o, u) => o + u, 0) / t.length, i = s.reduce((o, u) => o + u, 0) / s.length, a = n.reduce((o, u) => o + u, 0) / n.length, c = Math.max(...t), h = Math.min(...t), E = t.reduce((o, u) => o + Math.pow(u - r, 2), 0) / t.length, l = Math.sqrt(E);\n    return {\n      count: e.length,\n      averageAccuracy: r,\n      averageAbsoluteError: i,\n      averageRelativeError: a,\n      maxAccuracy: c,\n      minAccuracy: h,\n      standardDeviation: l\n    };\n  }\n  /**\n   * 評価結果を要素タイプ（dot/dash）別に分類する\n   *\n   * @param evaluations - タイミング評価結果の配列\n   * @returns 要素タイプ別の評価結果\n   *\n   * @example\n   * ```ts\n   * const evaluations = [...]; // TimingEvaluation[]\n   * const classified = TimingEvaluator.classifyByElement(evaluations);\n   * console.log(classified.dot.length); // dot入力の数\n   * console.log(classified.dash.length); // dash入力の数\n   * ```\n   */\n  static classifyByElement(e) {\n    const t = e.filter((n) => n.record.element === \".\"), s = e.filter((n) => n.record.element === \"-\");\n    return { dot: t, dash: s };\n  }\n  /**\n   * 最近のN件の評価結果を取得する\n   *\n   * @param evaluations - タイミング評価結果の配列\n   * @param count - 取得する件数\n   * @returns 最近のN件の評価結果\n   *\n   * @example\n   * ```ts\n   * const evaluations = [...]; // TimingEvaluation[]\n   * const recent = TimingEvaluator.getRecent(evaluations, 10);\n   * console.log(recent.length); // 最大10件\n   * ```\n   */\n  static getRecent(e, t) {\n    return t <= 0 ? [] : [...e].sort(\n      (n, r) => r.record.timestamp - n.record.timestamp\n    ).slice(0, t);\n  }\n  /**\n   * 期間内の評価結果を取得する\n   *\n   * @param evaluations - タイミング評価結果の配列\n   * @param startTime - 開始時刻（エポックミリ秒）\n   * @param endTime - 終了時刻（エポックミリ秒、省略時は現在時刻）\n   * @returns 期間内の評価結果\n   *\n   * @example\n   * ```ts\n   * const evaluations = [...]; // TimingEvaluation[]\n   * const oneHourAgo = Date.now() - 60 * 60 * 1000;\n   * const recent = TimingEvaluator.getByTimeRange(evaluations, oneHourAgo);\n   * console.log(recent.length); // 直近1時間の件数\n   * ```\n   */\n  static getByTimeRange(e, t, s = Date.now()) {\n    return e.filter(\n      (n) => n.record.timestamp >= t && n.record.timestamp <= s\n    );\n  }\n  /**\n   * スペーシングレコードを作成する\n   *\n   * @param actualDuration - 実際のスペース時間（ミリ秒）\n   * @param timings - モールス信号のタイミング情報\n   * @param timestamp - 記録時刻（エポックミリ秒、省略時は現在時刻）\n   * @returns スペーシングレコード\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * const record = TimingEvaluator.createSpacingRecord(150, timings);\n   * console.log(record.type); // 'character'（3 dot = 180ms に近い）\n   * ```\n   */\n  static createSpacingRecord(e, t, s = Date.now()) {\n    //! スペースタイプを判定する。\n    //! 0 〜 2 dot: 要素間スペース\n    //! 2 〜 5 dot: 文字間スペース\n    //! 5 dot 以上: 単語間スペース\n    const n = t.dot;\n    let r, i;\n    if (e < n * 2) {\n      //! 要素間スペース（同じ文字内の次の要素）\n      r = \"element\", i = 0;\n    } else if (e < n * 5) {\n      //! 文字間スペース\n      r = \"character\", i = t.charGap;\n    } else {\n      //! 単語間スペース\n      r = \"word\", i = t.wordGap;\n    }\n    return {\n      type: r,\n      actualDuration: e,\n      expectedDuration: i,\n      timestamp: s\n    };\n  }\n  /**\n   * スペーシングレコードを評価する\n   *\n   * @param record - スペーシングレコード\n   * @returns スペーシング評価結果\n   *\n   * @example\n   * ```ts\n   * const timings = TimingCalculator.calculate(20);\n   * const record = TimingEvaluator.createSpacingRecord(150, timings);\n   * const evaluation = TimingEvaluator.evaluateSpacing(record);\n   * console.log(evaluation.accuracy); // スペーシング精度\n   * ```\n   */\n  static evaluateSpacing(e) {\n    const t = Math.abs(e.actualDuration - e.expectedDuration);\n    //! 期待値が0の場合（要素間スペース）、相対誤差の計算で除算エラーを避ける。\n    //! この場合、絶対誤差をそのまま相対誤差（%）として扱う（1ms = 1%）。\n    const s = e.expectedDuration === 0 ? t : t / e.expectedDuration * 100, n = Math.max(0, 100 - s);\n    return {\n      record: e,\n      absoluteError: t,\n      relativeError: s,\n      accuracy: n\n    };\n  }\n  /**\n   * 複数のスペーシング評価結果から統計情報を計算する\n   *\n   * @param evaluations - スペーシング評価結果の配列\n   * @returns 統計情報\n   *\n   * @example\n   * ```ts\n   * const evaluations = [...]; // SpacingEvaluation[]\n   * const stats = TimingEvaluator.calculateSpacingStatistics(evaluations);\n   * console.log(stats.averageAccuracy); // 平均精度\n   * ```\n   */\n  static calculateSpacingStatistics(e) {\n    if (e.length === 0)\n      return {\n        count: 0,\n        averageAccuracy: 0,\n        averageAbsoluteError: 0,\n        averageRelativeError: 0,\n        maxAccuracy: 0,\n        minAccuracy: 0,\n        standardDeviation: 0\n      };\n    const t = e.map((o) => o.accuracy), s = e.map((o) => o.absoluteError), n = e.map((o) => o.relativeError), r = t.reduce((o, u) => o + u, 0) / t.length, i = s.reduce((o, u) => o + u, 0) / s.length, a = n.reduce((o, u) => o + u, 0) / n.length, c = Math.max(...t), h = Math.min(...t);\n    //! 標準偏差を計算する。\n    const E = t.reduce((o, u) => o + Math.pow(u - r, 2), 0) / t.length, l = Math.sqrt(E);\n    return {\n      count: e.length,\n      averageAccuracy: r,\n      averageAbsoluteError: i,\n      averageRelativeError: a,\n      maxAccuracy: c,\n      minAccuracy: h,\n      standardDeviation: l\n    };\n  }\n  /**\n   * スペーシング評価結果をスペースタイプ別に分類する\n   *\n   * @param evaluations - スペーシング評価結果の配列\n   * @returns スペースタイプ別の評価結果\n   *\n   * @example\n   * ```ts\n   * const evaluations = [...]; // SpacingEvaluation[]\n   * const classified = TimingEvaluator.classifyBySpacingType(evaluations);\n   * console.log(classified.element.length); // 要素間スペースの数\n   * console.log(classified.character.length); // 文字間スペースの数\n   * console.log(classified.word.length); // 単語間スペースの数\n   * ```\n   */\n  static classifyBySpacingType(e) {\n    const t = e.filter((r) => r.record.type === \"element\"), s = e.filter((r) => r.record.type === \"character\"), n = e.filter((r) => r.record.type === \"word\");\n    return { element: t, character: s, word: n };\n  }\n}\nclass w {\n  constructor() {\n    this.buffer = \"\", this.sequence = \"\";\n  }\n  /**\n   * 現在入力中のシーケンスを取得する\n   *\n   * @returns 入力中のモールス符号シーケンス\n   */\n  getSequence() {\n    return this.sequence;\n  }\n  /**\n   * 確定済みのバッファを取得する\n   *\n   * @returns 確定済みのモールス符号バッファ\n   */\n  getBuffer() {\n    return this.buffer;\n  }\n  /**\n   * 入力中のシーケンスに符号要素を追加する\n   *\n   * @param element - 追加する符号要素（'.' または '-'）\n   */\n  addElement(e) {\n    this.sequence += e;\n  }\n  /**\n   * 入力中のシーケンスを確定してバッファに追加する\n   *\n   * @param addSpace - 確定後にスペースを追加するか（デフォルト: true）\n   */\n  commitSequence(e = !0) {\n    this.sequence && (this.buffer += this.sequence, e && (this.buffer += \" \"), this.sequence = \"\");\n  }\n  /**\n   * 語間スペース（'/'）を追加する\n   * すでに語間スペースで終わっている場合は追加しない\n   */\n  addWordSeparator() {\n    this.commitSequence(!0), this.buffer.endsWith(\"/ \") || (this.buffer += \"/ \");\n  }\n  /**\n   * バッファとシーケンスをクリアする\n   */\n  clear() {\n    this.buffer = \"\", this.sequence = \"\";\n  }\n  /**\n   * バッファの末尾が指定の文字列で終わっているかチェックする\n   *\n   * @param suffix - チェックする末尾文字列\n   * @returns 末尾が一致する場合true\n   */\n  endsWith(e) {\n    return this.buffer.endsWith(e);\n  }\n  /**\n   * バッファの長さを取得する\n   *\n   * @returns バッファの長さ\n   */\n  getBufferLength() {\n    return this.buffer.length;\n  }\n  /**\n   * シーケンスの長さを取得する\n   *\n   * @returns シーケンスの長さ\n   */\n  getSequenceLength() {\n    return this.sequence.length;\n  }\n  /**\n   * バッファが空かどうかをチェックする\n   *\n   * @returns バッファとシーケンスの両方が空の場合true\n   */\n  isEmpty() {\n    return this.buffer.length === 0 && this.sequence.length === 0;\n  }\n}\nclass k {\n  constructor() {\n    this.timers = /* @__PURE__ */ new Map();\n  }\n  /**\n   * タイマーを設定する\n   *\n   * @param name - タイマーの識別名\n   * @param callback - タイマー実行時のコールバック\n   * @param delay - 遅延時間（ミリ秒）\n   *\n   * @example\n   * ```ts\n   * const manager = new TimerManager();\n   * manager.set('charGap', () => console.log('Character committed'), 200);\n   * ```\n   */\n  set(e, t, s) {\n    this.clear(e);\n    const n = window.setTimeout(t, s);\n    this.timers.set(e, n);\n  }\n  /**\n   * 指定したタイマーをクリアする\n   *\n   * @param name - タイマーの識別名\n   *\n   * @example\n   * ```ts\n   * manager.clear('charGap');\n   * ```\n   */\n  clear(e) {\n    const t = this.timers.get(e);\n    t !== void 0 && (clearTimeout(t), this.timers.delete(e));\n  }\n  /**\n   * 全てのタイマーをクリアする\n   *\n   * @example\n   * ```ts\n   * manager.clearAll();\n   * ```\n   */\n  clearAll() {\n    for (const e of this.timers.values())\n      clearTimeout(e);\n    this.timers.clear();\n  }\n  /**\n   * 指定したタイマーが存在するかチェックする\n   *\n   * @param name - タイマーの識別名\n   * @returns タイマーが存在する場合true\n   */\n  has(e) {\n    return this.timers.has(e);\n  }\n  /**\n   * 管理中のタイマー数を取得する\n   *\n   * @returns タイマー数\n   */\n  count() {\n    return this.timers.size;\n  }\n}\nclass W {\n  /**\n   * AudioGeneratorを初期化する\n   *\n   * @param settings - 音声設定\n   */\n  constructor(e = { frequency: 750, volume: 0.7, wpm: 20 }) {\n    this.audioContext = null, this.currentOscillator = null, this.currentGain = null, this.isPlaying = !1, this.settings = e;\n  }\n  /**\n   * AudioContextの初期化\n   */\n  ensureAudioContext() {\n    this.audioContext || (this.audioContext = new (window.AudioContext || window.webkitAudioContext)()), this.audioContext.state === \"suspended\" && this.audioContext.resume();\n  }\n  /**\n   * 設定を更新する\n   *\n   * @param settings - 更新する設定（部分更新可能）\n   */\n  updateSettings(e) {\n    this.settings = { ...this.settings, ...e };\n  }\n  /**\n   * 現在の設定を取得する\n   *\n   * @returns 現在の音声設定\n   */\n  getSettings() {\n    return { ...this.settings };\n  }\n  /**\n   * 指定された時間に音を再生する\n   *\n   * @param startTime - 開始時刻（AudioContext時刻）\n   * @param durationMs - 音の長さ（ミリ秒）\n   */\n  scheduleTone(e, t) {\n    if (this.ensureAudioContext(), !!this.audioContext)\n      try {\n        const s = this.audioContext.createOscillator(), n = this.audioContext.createGain();\n        s.connect(n), n.connect(this.audioContext.destination), s.frequency.value = this.settings.frequency, s.type = \"sine\";\n        const r = this.audioContext.currentTime, i = Math.max(r, e);\n        n.gain.setValueAtTime(0, i), n.gain.linearRampToValueAtTime(this.settings.volume, i + 1e-3), n.gain.setValueAtTime(this.settings.volume, i + (t - 1) / 1e3), n.gain.linearRampToValueAtTime(0, i + t / 1e3), s.start(i), s.stop(i + t / 1e3);\n      } catch (s) {\n        console.error(\"音声エラー:\", s);\n      }\n  }\n  /**\n   * 連続音の開始\n   */\n  startContinuousTone() {\n    if (this.ensureAudioContext(), !!this.audioContext)\n      try {\n        this.stopContinuousTone();\n        const e = this.audioContext.createOscillator(), t = this.audioContext.createGain();\n        e.connect(t), t.connect(this.audioContext.destination), e.frequency.value = this.settings.frequency, e.type = \"sine\";\n        const s = this.audioContext.currentTime;\n        t.gain.setValueAtTime(0, s), t.gain.linearRampToValueAtTime(this.settings.volume, s + 1e-3), e.start(s), this.currentOscillator = e, this.currentGain = t;\n      } catch (e) {\n        console.error(\"連続音開始エラー:\", e);\n      }\n  }\n  /**\n   * 連続音の停止\n   */\n  stopContinuousTone() {\n    if (this.audioContext)\n      try {\n        if (this.currentOscillator && this.currentGain) {\n          const e = this.audioContext.currentTime;\n          this.currentGain.gain.cancelScheduledValues(e), this.currentGain.gain.setValueAtTime(this.currentGain.gain.value, e), this.currentGain.gain.linearRampToValueAtTime(0, e + 1e-3), this.currentOscillator.stop(e + 2e-3), this.currentOscillator = null, this.currentGain = null;\n        }\n      } catch (e) {\n        console.error(\"連続音停止エラー:\", e);\n      }\n  }\n  /**\n   * モールス符号文字列を再生する\n   *\n   * @param morse - モールス符号文字列（'.-', ' ', '/' を含む）\n   * @returns 再生が完了したらtrueを返すPromise（中断された場合はfalse）\n   *\n   * @example\n   * ```ts\n   * const audio = new AudioGenerator({ frequency: 750, volume: 0.7, wpm: 20 });\n   * await audio.playMorseString('.- -... -.-. / -.. . ..-.');\n   * ```\n   */\n  async playMorseString(e) {\n    if (this.isPlaying || !e || (this.ensureAudioContext(), !this.audioContext)) return !1;\n    this.isPlaying = !0;\n    const t = this.settings.wpm || 20, s = Math.min(this.settings.effectiveWpm || t, t), n = 1200 / t, r = n, i = 3 * n, a = n, c = 3 * n, E = 7 * (1200 / s);\n    let l = this.audioContext.currentTime + 0.02;\n    for (let S = 0; S < e.length && this.isPlaying; S++) {\n      const d = e[S];\n      d === \".\" ? (this.scheduleTone(l, r), l += (r + a) / 1e3) : d === \"-\" ? (this.scheduleTone(l, i), l += (i + a) / 1e3) : d === \" \" ? l += (c - a) / 1e3 : d === \"/\" && (l += (E - a) / 1e3);\n    }\n    const o = (l - this.audioContext.currentTime) * 1e3;\n    await new Promise((S) => setTimeout(S, o));\n    const u = this.isPlaying;\n    return this.isPlaying = !1, u;\n  }\n  /**\n   * 再生を停止する\n   */\n  stopPlaying() {\n    this.isPlaying = !1;\n  }\n  /**\n   * 再生中かどうかを確認する\n   *\n   * @returns 再生中の場合true\n   */\n  isCurrentlyPlaying() {\n    return this.isPlaying;\n  }\n  /**\n   * AudioContextを取得する\n   *\n   * @returns AudioContextインスタンス（未初期化の場合null）\n   */\n  getAudioContext() {\n    return this.audioContext;\n  }\n  /**\n   * 音量を取得する\n   *\n   * @returns 現在の音量（0-1）\n   */\n  getVolume() {\n    return this.settings.volume;\n  }\n  /**\n   * 音量を設定する\n   *\n   * @param volume - 音量（0-1）\n   */\n  setVolume(e) {\n    this.settings.volume = Math.max(0, Math.min(1, e));\n  }\n  /**\n   * 周波数を取得する\n   *\n   * @returns 現在の周波数（Hz）\n   */\n  getFrequency() {\n    return this.settings.frequency;\n  }\n  /**\n   * 周波数を設定する\n   *\n   * @param frequency - 周波数（Hz、400-1200の範囲）\n   */\n  setFrequency(e) {\n    this.settings.frequency = Math.max(400, Math.min(1200, e));\n  }\n  /**\n   * WPMを取得する\n   *\n   * @returns 現在のWPM\n   */\n  getWPM() {\n    return this.settings.wpm || 20;\n  }\n  /**\n   * WPMを設定する\n   *\n   * @param wpm - WPM（5-40の範囲）\n   */\n  setWPM(e) {\n    this.settings.wpm = Math.max(5, Math.min(40, e));\n  }\n  /**\n   * モールス符号文字列からWAVファイルを生成する\n   *\n   * @param morse - モールス符号文字列（'.-', ' ', '/' を含む）\n   * @returns WAVファイルのBlob\n   *\n   * @example\n   * ```ts\n   * const audio = new AudioGenerator({ frequency: 750, volume: 0.7, wpm: 20 });\n   * const wavBlob = await audio.generateWav('.- -... -.-. / -.. . ..-.');\n   * ```\n   */\n  async generateWav(e) {\n    if (!e)\n      throw new Error(\"モールス符号が空です\");\n    const t = this.settings.wpm || 20, s = Math.min(this.settings.effectiveWpm || t, t), n = 1200 / t, r = n, i = 3 * n, a = n, c = 3 * n, E = 7 * (1200 / s);\n    let l = 0;\n    for (let A = 0; A < e.length; A++) {\n      const I = e[A];\n      I === \".\" ? l += r + a : I === \"-\" ? l += i + a : I === \" \" ? l += c - a : I === \"/\" && (l += E - a);\n    }\n    const o = 44100, u = (l + 100) / 1e3, S = new OfflineAudioContext(1, Math.ceil(u * o), o);\n    let d = 0.02;\n    for (let A = 0; A < e.length; A++) {\n      const I = e[A];\n      I === \".\" ? (this.scheduleOfflineTone(S, d, r), d += (r + a) / 1e3) : I === \"-\" ? (this.scheduleOfflineTone(S, d, i), d += (i + a) / 1e3) : I === \" \" ? d += (c - a) / 1e3 : I === \"/\" && (d += (E - a) / 1e3);\n    }\n    const p = await S.startRendering();\n    return this.audioBufferToWav(p);\n  }\n  /**\n   * OfflineAudioContextで音を生成する\n   *\n   * @param context - OfflineAudioContext\n   * @param startTime - 開始時刻（秒）\n   * @param durationMs - 音の長さ（ミリ秒）\n   */\n  scheduleOfflineTone(e, t, s) {\n    const n = e.createOscillator(), r = e.createGain();\n    n.connect(r), r.connect(e.destination), n.frequency.value = this.settings.frequency, n.type = \"sine\";\n    const i = t;\n    r.gain.setValueAtTime(0, i), r.gain.linearRampToValueAtTime(this.settings.volume, i + 1e-3), r.gain.setValueAtTime(this.settings.volume, i + (s - 1) / 1e3), r.gain.linearRampToValueAtTime(0, i + s / 1e3), n.start(i), n.stop(i + s / 1e3);\n  }\n  /**\n   * AudioBufferをWAVファイルに変換する\n   *\n   * @param buffer - AudioBuffer\n   * @returns WAVファイルのBlob\n   */\n  audioBufferToWav(e) {\n    const t = e.numberOfChannels, s = e.sampleRate, n = 1, r = 16, i = r / 8, a = t * i, c = new Float32Array(e.length * t);\n    for (let d = 0; d < e.numberOfChannels; d++) {\n      const p = e.getChannelData(d);\n      for (let A = 0; A < p.length; A++)\n        c[A * t + d] = p[A];\n    }\n    const h = c.length * i, E = 44 + h, l = new ArrayBuffer(E), o = new DataView(l), u = (d, p) => {\n      for (let A = 0; A < p.length; A++)\n        o.setUint8(d + A, p.charCodeAt(A));\n    };\n    u(0, \"RIFF\"), o.setUint32(4, E - 8, !0), u(8, \"WAVE\"), u(12, \"fmt \"), o.setUint32(16, 16, !0), o.setUint16(20, n, !0), o.setUint16(22, t, !0), o.setUint32(24, s, !0), o.setUint32(28, s * a, !0), o.setUint16(32, a, !0), o.setUint16(34, r, !0), u(36, \"data\"), o.setUint32(40, h, !0);\n    let S = 44;\n    for (let d = 0; d < c.length; d++) {\n      const p = Math.max(-1, Math.min(1, c[d])), A = p < 0 ? p * 32768 : p * 32767;\n      o.setInt16(S, A, !0), S += 2;\n    }\n    return new Blob([l], { type: \"audio/wav\" });\n  }\n}\nclass P {\n  /**\n   * 縦振り電鍵トレーナーを初期化する\n   * @param buffer - モールスバッファインスタンス\n   * @param timer - タイマーマネージャーインスタンス\n   * @param timings - タイミング設定\n   * @param callbacks - イベントコールバック\n   */\n  constructor(e, t, s, n = {}) {\n    this.buffer = e, this.timer = t, this.timings = s, this.callbacks = n, this.keyDown = !1, this.keyDownTime = 0, this.evaluations = [];\n  }\n  /**\n   * キーが押された時の処理\n   * 連続音の開始と状態の記録を行う\n   */\n  keyPress() {\n    this.keyDown || (this.keyDown = !0, this.keyDownTime = Date.now(), this.timer.clearAll(), this.callbacks.onKeyPress?.());\n  }\n  /**\n   * キーが離された時の処理\n   * 押下時間からdot/dashを判定し、バッファに追加する\n   */\n  keyRelease() {\n    if (!this.keyDown) return;\n    this.keyDown = !1;\n    const e = Date.now() - this.keyDownTime, t = e < this.timings.dot * 2 ? \".\" : \"-\";\n    this.buffer.addElement(t);\n    const s = T.createRecord(t, e, this.timings), n = T.evaluate(s);\n    this.evaluations.push(n), this.callbacks.onKeyRelease?.(t), this.callbacks.onSequenceUpdate?.(this.buffer.getSequence()), this.callbacks.onTimingEvaluated?.(n), this.notifyBufferUpdate(), this.setupCharWordTimers();\n  }\n  /**\n   * 文字確定・語間スペースタイマーを設定する\n   */\n  setupCharWordTimers() {\n    this.timer.clearAll();\n    const e = this.timings.charGap;\n    this.timer.set(\"charGap\", () => {\n      const s = this.buffer.getSequence();\n      if (s) {\n        const n = g.morseToText([s]);\n        this.buffer.commitSequence(), this.callbacks.onCharacter?.(s, n || \"?\"), this.notifyBufferUpdate();\n      }\n    }, e);\n    const t = this.timings.wordGap;\n    this.timer.set(\"wordGap\", () => {\n      const s = this.buffer.getSequence();\n      if (s) {\n        const n = g.morseToText([s]);\n        this.buffer.commitSequence(), this.callbacks.onCharacter?.(s, n || \"?\");\n      }\n      this.buffer.addWordSeparator(), this.callbacks.onWordSeparator?.(), this.notifyBufferUpdate();\n    }, t);\n  }\n  /**\n   * バッファ更新を通知する\n   */\n  notifyBufferUpdate() {\n    const e = this.buffer.getBuffer(), t = e.trim().split(/\\s+/), s = g.morseToText(t);\n    this.callbacks.onBufferUpdate?.(e, s);\n  }\n  /**\n   * バッファとタイマーをクリアする\n   */\n  clear() {\n    this.buffer.clear(), this.timer.clearAll(), this.evaluations = [], this.notifyBufferUpdate();\n  }\n  /**\n   * 現在のモールス信号バッファを取得する\n   * @returns モールス信号文字列 (例: \".- -...\")\n   */\n  getBuffer() {\n    return this.buffer.getBuffer();\n  }\n  /**\n   * 現在入力中のシーケンスを取得する\n   * @returns シーケンス文字列 (例: \".-\")\n   */\n  getSequence() {\n    return this.buffer.getSequence();\n  }\n  /**\n   * 現在のバッファを解読した文字列を取得する\n   * @returns 解読された文字列 (例: \"AB\")\n   */\n  getDecoded() {\n    const t = this.buffer.getBuffer().trim().split(/\\s+/);\n    return g.morseToText(t);\n  }\n  /**\n   * キーが現在押されているかどうかを取得する\n   * @returns キーが押されている場合true\n   */\n  isKeyDown() {\n    return this.keyDown;\n  }\n  /**\n   * タイマーの状態を取得する（主にテスト用）\n   * @returns アクティブなタイマーの数\n   */\n  getTimerCount() {\n    return this.timer.count();\n  }\n  /**\n   * タイミング評価の統計情報を取得する\n   * @returns 統計情報\n   */\n  getTimingStatistics() {\n    return T.calculateStatistics(this.evaluations);\n  }\n  /**\n   * 最近のN件のタイミング評価結果を取得する\n   * @param count - 取得する件数\n   * @returns タイミング評価結果の配列\n   */\n  getRecentEvaluations(e) {\n    return T.getRecent(this.evaluations, e);\n  }\n  /**\n   * 全てのタイミング評価結果を取得する\n   * @returns タイミング評価結果の配列\n   */\n  getAllEvaluations() {\n    return [...this.evaluations];\n  }\n  /**\n   * 要素タイプ（dot/dash）別の統計情報を取得する\n   * @returns dot/dash別の統計情報\n   */\n  getStatisticsByElement() {\n    const e = T.classifyByElement(this.evaluations);\n    return {\n      dot: T.calculateStatistics(e.dot),\n      dash: T.calculateStatistics(e.dash)\n    };\n  }\n}\nclass $ {\n  /**\n   * 横振り電鍵トレーナーを初期化する\n   * @param buffer - モールスバッファインスタンス\n   * @param timer - タイマーマネージャーインスタンス\n   * @param timings - タイミング設定\n   * @param callbacks - イベントコールバック\n   * @param settings - トレーナー設定\n   */\n  constructor(e, t, s, n = {}, r = {}) {\n    this.buffer = e, this.timer = t, this.timings = s, this.callbacks = n, this.leftDown = !1, this.rightDown = !1, this.sending = !1, this.lastSent = null, this.forceNextElement = null, this.squeezeDetected = !1, this.isSqueezing = !1, this.spacingEvaluations = [], this.lastElementEndTime = null, this.currentWordElements = [], this.currentWordGaps = [], this.currentWordPaddleInputs = [], this.currentWordSqueezeIntervals = [], this.lastWordTimingData = null, this.currentElementStartTime = null, this.squeezeStartTime = null, this.iambicMode = r.iambicMode || \"A\", this.paddleLayout = r.paddleLayout || \"normal\";\n  }\n  /**\n   * 左パドルが押された時の処理\n   */\n  leftPaddlePress() {\n    //! パドル入力イベントを記録（タイミングチャート用）。\n    if (this.currentWordPaddleInputs.push({\n      paddle: \"left\",\n      state: \"press\",\n      timestamp: Date.now()\n    }), this.leftDown = !0, this.updateSqueezeState(), this.iambicMode === \"B\" && this.sending && this.rightDown) {\n      const e = this.paddleLayout === \"reversed\" ? \"-\" : \".\";\n      this.forceNextElement = e, this.squeezeDetected = !0;\n    }\n    if (!this.sending) {\n      const e = this.paddleLayout === \"reversed\" ? \"-\" : \".\";\n      this.sendPaddleElement(e);\n    }\n  }\n  /**\n   * 右パドルが押された時の処理\n   */\n  rightPaddlePress() {\n    //! パドル入力イベントを記録（タイミングチャート用）。\n    if (this.currentWordPaddleInputs.push({\n      paddle: \"right\",\n      state: \"press\",\n      timestamp: Date.now()\n    }), this.rightDown = !0, this.updateSqueezeState(), this.iambicMode === \"B\" && this.sending && this.leftDown) {\n      const e = this.paddleLayout === \"reversed\" ? \".\" : \"-\";\n      this.forceNextElement = e, this.squeezeDetected = !0;\n    }\n    if (!this.sending) {\n      const e = this.paddleLayout === \"reversed\" ? \".\" : \"-\";\n      this.sendPaddleElement(e);\n    }\n  }\n  /**\n   * 左パドルが離された時の処理\n   */\n  leftPaddleRelease() {\n    //! パドル入力イベントを記録（タイミングチャート用）。\n    this.currentWordPaddleInputs.push({\n      paddle: \"left\",\n      state: \"release\",\n      timestamp: Date.now()\n    }), this.leftDown = !1, this.updateSqueezeState();\n  }\n  /**\n   * 右パドルが離された時の処理\n   */\n  rightPaddleRelease() {\n    //! パドル入力イベントを記録（タイミングチャート用）。\n    this.currentWordPaddleInputs.push({\n      paddle: \"right\",\n      state: \"release\",\n      timestamp: Date.now()\n    }), this.rightDown = !1, this.updateSqueezeState();\n  }\n  /**\n   * パドル要素を送信する\n   * @param element - 送信する要素 ('.' | '-')\n   */\n  sendPaddleElement(e) {\n    if (this.sending) return;\n    this.sending = !0, this.timer.clearAll(), this.leftDown && this.rightDown || (this.squeezeDetected = !1);\n    const t = Date.now();\n    if (this.currentElementStartTime = t, this.lastElementEndTime !== null) {\n      const n = t - this.lastElementEndTime, r = T.createSpacingRecord(\n        n,\n        this.timings\n      ), i = r.type === \"character\" ? this.timings.charGap : r.type === \"word\" ? this.timings.wordGap : 0, a = T.evaluateSpacing(r), c = {\n        type: r.type,\n        startTime: this.lastElementEndTime,\n        endTime: t,\n        duration: n,\n        expectedDuration: i,\n        accuracy: a.accuracy\n      };\n      this.currentWordGaps.push(c), r.type !== \"element\" && (this.spacingEvaluations.push(a), this.callbacks.onSpacingEvaluated?.(a));\n    }\n    const s = e === \".\" ? this.timings.dot : this.timings.dash;\n    this.callbacks.onElementStart?.(e, s), this.buffer.addElement(e), this.lastSent = e, this.callbacks.onSequenceUpdate?.(this.buffer.getSequence()), this.notifyBufferUpdate(), this.timer.set(\"iambicCheck\", () => {\n      const n = this.leftDown && this.rightDown;\n      this.iambicMode === \"B\" && this.squeezeDetected && !this.forceNextElement && (this.forceNextElement = e === \".\" ? \"-\" : \".\"), n && !this.forceNextElement && (this.forceNextElement = e === \".\" ? \"-\" : \".\");\n    }, Math.max(0, s - 5)), this.timer.set(\"elementEnd\", () => {\n      this.sending = !1, this.callbacks.onElementEnd?.(e);\n      const n = Date.now();\n      if (this.lastElementEndTime = n, this.currentElementStartTime !== null) {\n        const r = n - this.currentElementStartTime, i = e === \".\" ? this.timings.dot : this.timings.dash, a = {\n          element: e,\n          startTime: this.currentElementStartTime,\n          endTime: n,\n          duration: r,\n          expectedDuration: i\n        };\n        this.currentWordElements.push(a), this.currentElementStartTime = null;\n      }\n      this.forceNextElement ? this.scheduleNext() : this.leftDown || this.rightDown ? this.scheduleNext() : this.setupCharWordTimers();\n    }, s + this.timings.dot);\n  }\n  /**\n   * 次の要素をスケジュールする\n   */\n  scheduleNext() {\n    if (this.forceNextElement) {\n      const e = this.forceNextElement;\n      this.forceNextElement = null, this.sendPaddleElement(e);\n    } else if (this.leftDown && this.rightDown) {\n      const e = this.lastSent === \".\" ? \"-\" : \".\";\n      this.sendPaddleElement(e);\n    } else if (this.leftDown) {\n      const e = this.paddleLayout === \"reversed\" ? \"-\" : \".\";\n      this.sendPaddleElement(e);\n    } else if (this.rightDown) {\n      const e = this.paddleLayout === \"reversed\" ? \".\" : \"-\";\n      this.sendPaddleElement(e);\n    }\n  }\n  /**\n   * 文字確定・語間スペースタイマーを設定する\n   */\n  setupCharWordTimers() {\n    this.timer.clearAll(), this.timer.set(\"charGap\", () => {\n      const e = this.buffer.getSequence();\n      if (e) {\n        const t = g.morseToText([e]);\n        this.buffer.commitSequence(), this.callbacks.onCharacter?.(e, t || \"?\"), this.notifyBufferUpdate(), this.lastWordTimingData = {\n          elements: [...this.currentWordElements],\n          gaps: [...this.currentWordGaps],\n          paddleInputs: [...this.currentWordPaddleInputs],\n          squeezeIntervals: [...this.currentWordSqueezeIntervals],\n          decodedChar: t || \"?\",\n          morseCode: e\n        }, this.currentWordElements = [], this.currentWordGaps = [];\n      }\n    }, this.timings.charGap), this.timer.set(\"wordGap\", () => {\n      const e = this.buffer.getSequence();\n      if (e) {\n        const t = g.morseToText([e]);\n        this.buffer.commitSequence(), this.callbacks.onCharacter?.(e, t || \"?\"), this.lastWordTimingData = {\n          elements: [...this.currentWordElements],\n          gaps: [...this.currentWordGaps],\n          paddleInputs: [...this.currentWordPaddleInputs],\n          squeezeIntervals: [...this.currentWordSqueezeIntervals],\n          decodedChar: t || \"?\",\n          morseCode: e\n        }, this.currentWordElements = [], this.currentWordGaps = [];\n      }\n      this.buffer.addWordSeparator(), this.callbacks.onWordSeparator?.(), this.notifyBufferUpdate();\n    }, this.timings.wordGap);\n  }\n  /**\n   * スクイーズ状態を更新する\n   */\n  updateSqueezeState() {\n    const e = this.leftDown && this.rightDown;\n    if (this.isSqueezing !== e) {\n      this.isSqueezing = e, this.callbacks.onSqueezeChange?.(e);\n      //! スクイーズ区間を記録（タイミングチャート用）。\n      e ? this.squeezeStartTime = Date.now() : this.squeezeStartTime !== null && (this.currentWordSqueezeIntervals.push({\n        startTime: this.squeezeStartTime,\n        endTime: Date.now()\n      }), this.squeezeStartTime = null);\n    }\n  }\n  /**\n   * バッファ更新を通知する\n   */\n  notifyBufferUpdate() {\n    const e = this.buffer.getBuffer(), t = e.trim().split(/\\s+/), s = g.morseToText(t);\n    this.callbacks.onBufferUpdate?.(e, s);\n  }\n  /**\n   * バッファとタイマーをクリアする\n   */\n  clear() {\n    this.buffer.clear(), this.timer.clearAll(), this.sending = !1, this.forceNextElement = null, this.squeezeDetected = !1, this.lastSent = null, this.spacingEvaluations = [], this.lastElementEndTime = null, this.currentWordElements = [], this.currentWordGaps = [], this.currentWordPaddleInputs = [], this.currentWordSqueezeIntervals = [], this.lastWordTimingData = null, this.currentElementStartTime = null, this.squeezeStartTime = null, this.notifyBufferUpdate();\n  }\n  /**\n   * 現在のモールス信号バッファを取得する\n   * @returns モールス信号文字列 (例: \".- -...\")\n   */\n  getBuffer() {\n    return this.buffer.getBuffer();\n  }\n  /**\n   * 現在入力中のシーケンスを取得する\n   * @returns シーケンス文字列 (例: \".-\")\n   */\n  getSequence() {\n    return this.buffer.getSequence();\n  }\n  /**\n   * 現在のバッファを解読した文字列を取得する\n   * @returns 解読された文字列 (例: \"AB\")\n   */\n  getDecoded() {\n    const t = this.buffer.getBuffer().trim().split(/\\s+/);\n    return g.morseToText(t);\n  }\n  /**\n   * 左パドルが押されているかどうかを取得する\n   * @returns 左パドルが押されている場合true\n   */\n  isLeftPaddleDown() {\n    return this.leftDown;\n  }\n  /**\n   * 右パドルが押されているかどうかを取得する\n   * @returns 右パドルが押されている場合true\n   */\n  isRightPaddleDown() {\n    return this.rightDown;\n  }\n  /**\n   * 現在送信中かどうかを取得する\n   * @returns 送信中の場合true\n   */\n  isSending() {\n    return this.sending;\n  }\n  /**\n   * スクイーズ中かどうかを取得する\n   * @returns スクイーズ中の場合true\n   */\n  isSqueezingNow() {\n    return this.isSqueezing;\n  }\n  /**\n   * Iambicモードを設定する\n   * @param mode - 'A' または 'B'\n   */\n  setIambicMode(e) {\n    this.iambicMode = e;\n  }\n  /**\n   * パドルレイアウトを設定する\n   * @param layout - 'normal' または 'reversed'\n   */\n  setPaddleLayout(e) {\n    this.paddleLayout = e;\n  }\n  /**\n   * 現在のIambicモードを取得する\n   * @returns 'A' または 'B'\n   */\n  getIambicMode() {\n    return this.iambicMode;\n  }\n  /**\n   * 現在のパドルレイアウトを取得する\n   * @returns 'normal' または 'reversed'\n   */\n  getPaddleLayout() {\n    return this.paddleLayout;\n  }\n  /**\n   * スペーシング評価の統計情報を取得する\n   * @returns 統計情報\n   */\n  getSpacingStatistics() {\n    return T.calculateSpacingStatistics(this.spacingEvaluations);\n  }\n  /**\n   * 最近のN件のスペーシング評価結果を取得する\n   * @param count - 取得する件数\n   * @returns スペーシング評価結果の配列\n   */\n  getRecentSpacingEvaluations(e) {\n    return [...this.spacingEvaluations].sort(\n      (s, n) => n.record.timestamp - s.record.timestamp\n    ).slice(0, e);\n  }\n  /**\n   * 全てのスペーシング評価結果を取得する\n   * @returns スペーシング評価結果の配列\n   */\n  getAllSpacingEvaluations() {\n    return [...this.spacingEvaluations];\n  }\n  /**\n   * スペースタイプ（element/character/word）別の統計情報を取得する\n   * @returns スペースタイプ別の統計情報\n   */\n  getStatisticsBySpacingType() {\n    const e = T.classifyBySpacingType(this.spacingEvaluations);\n    return {\n      element: T.calculateSpacingStatistics(e.element),\n      character: T.calculateSpacingStatistics(e.character),\n      word: T.calculateSpacingStatistics(e.word)\n    };\n  }\n  /**\n   * 最後に確定した単語のタイミングデータを取得する（タイミング図表示用）\n   * @returns 単語のタイミングデータ、またはnull（まだ文字が確定していない場合）\n   */\n  getLastWordTimingData() {\n    return this.lastWordTimingData;\n  }\n}\nconst N = [\n  \"K\",\n  \"M\",\n  \"U\",\n  \"R\",\n  \"E\",\n  \"S\",\n  \"N\",\n  \"A\",\n  \"P\",\n  \"T\",\n  \"L\",\n  \"W\",\n  \"I\",\n  \".\",\n  \"J\",\n  \"Z\",\n  \"=\",\n  \"F\",\n  \"O\",\n  \"Y\",\n  \",\",\n  \"V\",\n  \"G\",\n  \"5\",\n  \"/\",\n  \"Q\",\n  \"9\",\n  \"2\",\n  \"H\",\n  \"3\",\n  \"8\",\n  \"B\",\n  \"?\",\n  \"4\",\n  \"7\",\n  \"C\",\n  \"1\",\n  \"D\",\n  \"6\",\n  \"0\",\n  \"X\"\n];\nclass M {\n  /**\n   * コッホ法トレーナーを初期化する\n   * @param initialLesson - 初期レッスン番号（1-40、デフォルト: 1）\n   */\n  constructor(e = 1) {\n    this.currentLesson = 1, this.currentLesson = Math.max(1, Math.min(40, e));\n  }\n  /**\n   * レッスン番号で学習する文字を取得\n   * @param lessonNum - レッスン番号（1-40）\n   * @returns 学習文字の配列\n   */\n  static getCharsForLesson(e) {\n    const t = Math.max(1, Math.min(40, e));\n    return N.slice(0, t + 1);\n  }\n  /**\n   * ランダムな文字グループを生成\n   * @param chars - 使用する文字の配列\n   * @param settings - 練習設定\n   * @returns 文字グループの配列\n   */\n  static generateRandomGroups(e, t = {}) {\n    const s = t.groupSize || 5, n = t.duration || 60, r = t.wpm || 20, i = Math.floor(n * r / (s * 5)), a = [];\n    for (let c = 0; c < i; c++) {\n      let h = \"\";\n      for (let E = 0; E < s; E++) {\n        const l = e[Math.floor(Math.random() * e.length)];\n        h += l;\n      }\n      a.push(h);\n    }\n    return a;\n  }\n  /**\n   * 指定した文字セットでランダムグループを生成\n   * @param charSet - 使用する文字セット\n   * @param settings - 練習設定\n   * @returns 文字グループの配列\n   */\n  static generateCustomGroups(e, t = {}) {\n    const s = Array.from(e);\n    if (s.length < 2)\n      throw new Error(\"文字セットには最低2文字必要です\");\n    return M.generateRandomGroups(s, t);\n  }\n  /**\n   * 正答率を計算する\n   * @param correctAnswer - 正解の文字列\n   * @param userInput - ユーザー入力の文字列\n   * @returns 正答率（0-100）\n   */\n  static calculateAccuracy(e, t) {\n    if (!t) return 0;\n    const s = e.replace(/\\s/g, \"\"), n = t.replace(/\\s/g, \"\"), r = Math.max(s.length, n.length);\n    if (r === 0) return 0;\n    let i = 0;\n    for (let a = 0; a < r; a++)\n      s[a] === n[a] && i++;\n    return i / r * 100;\n  }\n  /**\n   * 合格判定（90%以上）\n   * @param accuracy - 正答率（0-100）\n   * @returns 合格の場合true\n   */\n  static isPassed(e) {\n    return e >= 90;\n  }\n  /**\n   * 現在のレッスン番号を取得\n   * @returns レッスン番号（1-40）\n   */\n  getCurrentLesson() {\n    return this.currentLesson;\n  }\n  /**\n   * レッスン番号を設定\n   * @param lessonNum - レッスン番号（1-40）\n   */\n  setCurrentLesson(e) {\n    this.currentLesson = Math.max(1, Math.min(40, e));\n  }\n  /**\n   * 現在のレッスンで学習する文字を取得\n   * @returns 学習文字の配列\n   */\n  getCurrentChars() {\n    return M.getCharsForLesson(this.currentLesson);\n  }\n  /**\n   * 現在のレッスン用の練習問題を生成\n   * @param settings - 練習設定\n   * @returns 練習問題（文字グループの配列）\n   */\n  generatePractice(e = {}) {\n    const t = this.getCurrentChars();\n    return M.generateRandomGroups(t, e);\n  }\n  /**\n   * 次のレッスンに進む\n   * @returns 次のレッスン番号（最大40）\n   */\n  advanceLesson() {\n    return this.currentLesson < 40 && this.currentLesson++, this.currentLesson;\n  }\n  /**\n   * 前のレッスンに戻る\n   * @returns 前のレッスン番号（最小1）\n   */\n  previousLesson() {\n    return this.currentLesson > 1 && this.currentLesson--, this.currentLesson;\n  }\n  /**\n   * 最後のレッスンかどうかを判定\n   * @returns 最後のレッスンの場合true\n   */\n  isLastLesson() {\n    return this.currentLesson === 40;\n  }\n  /**\n   * 最初のレッスンかどうかを判定\n   * @returns 最初のレッスンの場合true\n   */\n  isFirstLesson() {\n    return this.currentLesson === 1;\n  }\n  /**\n   * 全レッスン数を取得\n   * @returns 全レッスン数（40）\n   */\n  static getTotalLessons() {\n    return 40;\n  }\n  /**\n   * 全文字数を取得\n   * @returns 全文字数（41）\n   */\n  static getTotalChars() {\n    return N.length;\n  }\n  /**\n   * コッホシーケンス全体を取得\n   * @returns 全41文字の配列\n   */\n  static getAllChars() {\n    return [...N];\n  }\n}\n//! 日本の都市名（ローマ字）。\nconst b = [\n  \"TOKYO\",\n  \"OSAKA\",\n  \"KYOTO\",\n  \"NAGOYA\",\n  \"YOKOHAMA\",\n  \"KOBE\",\n  \"FUKUOKA\",\n  \"SAPPORO\",\n  \"SENDAI\",\n  \"HIROSHIMA\",\n  \"KAWASAKI\",\n  \"SAITAMA\",\n  \"CHIBA\",\n  \"KITAKYUSHU\",\n  \"SAKAI\",\n  \"NIIGATA\",\n  \"HAMAMATSU\",\n  \"KUMAMOTO\",\n  \"OKAYAMA\",\n  \"SAGAMIHARA\",\n  \"SHIZUOKA\",\n  \"KAGOSHIMA\",\n  \"MATSUYAMA\",\n  \"GIFU\",\n  \"UTSUNOMIYA\",\n  \"KANAZAWA\",\n  \"TOYAMA\",\n  \"NARA\",\n  \"NAGASAKI\",\n  \"OITA\",\n  \"KOCHI\",\n  \"MIYAZAKI\",\n  \"NAHA\",\n  \"WAKAYAMA\",\n  \"AOMORI\",\n  \"AKITA\",\n  \"FUKUSHIMA\",\n  \"MORIOKA\",\n  \"MAEBASHI\",\n  \"KOFU\",\n  \"MATSUMOTO\",\n  \"TOYOHASHI\",\n  \"FUKUI\",\n  \"OTSU\",\n  \"TSU\",\n  \"YOKKAICHI\",\n  \"MATSUE\",\n  \"TOTTORI\",\n  \"YAMAGUCHI\",\n  \"TOKUSHIMA\",\n  \"TAKAMATSU\",\n  \"MITO\",\n  \"KORIYAMA\",\n  \"IWAKI\",\n  \"TAKASAKI\",\n  \"HACHIOJI\",\n  \"MACHIDA\",\n  \"KURASHIKI\",\n  \"HIMEJI\",\n  \"NISHINOMIYA\",\n  \"AMAGASAKI\",\n  \"TAKATSUKI\",\n  \"TOYONAKA\",\n  \"SUITA\",\n  \"KAWAGUCHI\",\n  \"FUNABASHI\",\n  \"HAKODATE\",\n  \"ASAHIKAWA\",\n  \"OTARU\",\n  \"KUSHIRO\",\n  \"OBIHIRO\",\n  \"TOMAKOMAI\",\n  \"IWAMIZAWA\",\n  \"HACHINOHE\",\n  \"HIROSAKI\",\n  \"ISHINOMAKI\",\n  \"YAMAGATA\",\n  \"TSURUOKA\",\n  \"YONEZAWA\",\n  \"HITACHI\",\n  \"TSUKUBA\",\n  \"KASUKABE\",\n  \"KAWAGOE\",\n  \"TOKOROZAWA\",\n  \"AGEO\",\n  \"FUCHU\",\n  \"CHOFU\",\n  \"HINO\",\n  \"KOKUBUNJI\",\n  \"ATSUGI\",\n  \"ODAWARA\",\n  \"HIRATSUKA\",\n  \"FUJISAWA\",\n  \"KAMAKURA\",\n  \"ZUSHI\",\n  \"NUMAZU\",\n  \"FUJI\",\n  \"MISHIMA\",\n  \"KAKEGAWA\",\n  \"IWATA\"\n];\n//! 名前（ファーストネーム）。\nconst L = [\n  \"JOHN\",\n  \"MIKE\",\n  \"TOM\",\n  \"DAVE\",\n  \"BOB\",\n  \"BILL\",\n  \"JIM\",\n  \"JACK\",\n  \"FRANK\",\n  \"PAUL\",\n  \"MARK\",\n  \"DAN\",\n  \"KEN\",\n  \"RON\",\n  \"RICK\",\n  \"STEVE\",\n  \"GEORGE\",\n  \"PETE\",\n  \"RAY\",\n  \"AL\",\n  \"FRED\",\n  \"JEFF\",\n  \"GARY\",\n  \"LARRY\",\n  \"DOUG\",\n  \"DENNIS\",\n  \"RANDY\",\n  \"SCOTT\",\n  \"BRIAN\",\n  \"BRUCE\",\n  \"ERIC\",\n  \"KEVIN\",\n  \"CRAIG\",\n  \"GLENN\",\n  \"GREG\",\n  \"WAYNE\",\n  \"CARL\",\n  \"TONY\",\n  \"KEITH\",\n  \"CHRIS\",\n  \"DONALD\",\n  \"EDWARD\",\n  \"JOSEPH\",\n  \"RICHARD\",\n  \"ROBERT\",\n  \"CHARLES\",\n  \"WILLIAM\",\n  \"THOMAS\",\n  \"JAMES\",\n  \"PATRICK\",\n  \"HENRY\",\n  \"HAROLD\",\n  \"HOWARD\",\n  \"WALTER\",\n  \"ARTHUR\",\n  \"ALBERT\",\n  \"EUGENE\",\n  \"RALPH\",\n  \"LAWRENCE\",\n  \"HERBERT\",\n  \"CLARENCE\",\n  \"ERNEST\",\n  \"WILLIE\",\n  \"ANDREW\",\n  \"SAMUEL\",\n  \"LOUIS\",\n  \"OSCAR\",\n  \"LEONARD\",\n  \"ROY\",\n  \"EARL\",\n  \"CHESTER\",\n  \"CLIFFORD\",\n  \"NORMAN\",\n  \"CLYDE\",\n  \"HOMER\",\n  \"STANLEY\",\n  \"LESTER\",\n  \"MORRIS\",\n  \"RAYMOND\",\n  \"LEWIS\",\n  \"LEON\",\n  \"EDDIE\",\n  \"CHARLIE\",\n  \"FLOYD\",\n  \"FRED\",\n  \"MARTIN\",\n  \"MELVIN\",\n  \"MARVIN\",\n  \"IRVING\",\n  \"HARVEY\",\n  \"SAM\",\n  \"MAX\",\n  \"MACK\",\n  \"JOE\",\n  \"ABE\",\n  \"HARRY\",\n  \"NED\",\n  \"GUS\",\n  \"BERT\",\n  \"EARL\"\n];\n//! CW用無線機のリスト。\nconst v = [\n  \"FT-991A\",\n  \"FT-891\",\n  \"FT-857D\",\n  \"FT-450D\",\n  \"FT-101ES\",\n  // Yaesu\n  \"IC-7300\",\n  \"IC-7610\",\n  \"IC-9700\",\n  \"IC-705\",\n  \"IC-718\",\n  // ICOM\n  \"TS-590SG\",\n  \"TS-590S\",\n  \"TS-480SAT\",\n  \"TS-850S\",\n  \"TS-2000\"\n  // Kenwood\n];\n//! RSTレポートのリスト。\nconst H = [\n  \"599\",\n  \"589\",\n  \"579\",\n  \"569\",\n  \"559\",\n  \"449\",\n  \"339\"\n];\n//! QSOのサンプルテンプレート。\nconst R = [\n  {\n    id: \"qso-rubberstamp-1\",\n    category: \"qso\",\n    title: \"ラバースタンプQSO例: 完全な交信\",\n    dialog: [\n      { side: \"A\", text: \"CQ CQ CQ DE JF2SDR JF2SDR PSE K\" },\n      { side: \"B\", text: \"JF2SDR DE JR2ZWA JR2ZWA K\" },\n      { side: \"A\", text: \"R JR2ZWA DE JF2SDR GM OM TNX FER UR CALL BT UR RST IS 599 599 BT MI QTH IS NAGOYA NAGOYA CITY ES MI NAME IS SHIN SHIN HW ? AR JF2SDR DE JF2SDR KN\" },\n      { side: \"B\", text: \"R JF2SDR DE JR2ZWA GM DR SHIN OM TKS FER FB RPT 599 FM NAGOYA BT UR RST ALSO 599 599 VY FB MI QTH IS GIFU GIFU CITY BT NAME IS HIRO HIRO HW? JF2SDR DE JR2ZWA KN\" },\n      { side: \"A\", text: \"R FB DE JF2SDR DR HIRO OM BT MI RIG IS TS-850S PWR 100W ES ANT IS 3ELE YAGI 12MH BT PSE UR QSL CRD VIA JARL ? MI CRD SURE HW? AR JR2ZWA DE JF2SDR KN\" },\n      { side: \"B\", text: \"R JF2SDR DE JR2ZWA OK SHIN OM BT UR RIG ES ANT VY FB BT MI RIG IS FT-101ES VY OLD RIG ES ANT IS DP 8MH BT QSL VIA JARL OK SURE BT TNX FB 1ST QSO ES 73 AR JF2SDR DE JR2ZWA VA\" },\n      { side: \"A\", text: \"OK HIRO SOLID CPI BT TKS FB QSO ES BEST 73 AR JR2ZWA DE JF2SDR VA TU E E\" }\n    ]\n  },\n  {\n    id: \"qso-short-1\",\n    category: \"qso\",\n    title: \"QSO例: 短い交信（CQ呼び出しと応答）\",\n    dialog: [\n      { side: \"A\", text: \"CQ CQ CQ DE JA1ABC JA1ABC PSE K\" },\n      { side: \"B\", text: \"JA1ABC DE JE1XYZ JE1XYZ K\" },\n      { side: \"A\", text: \"R JE1XYZ DE JA1ABC TKS UR RST 599 QTH TOKYO TKS QSO 73 AR JA1ABC DE JA1ABC VA\" },\n      { side: \"B\", text: \"R JA1ABC DE JE1XYZ TKS 599 QTH OSAKA 73 AR JE1XYZ VA\" }\n    ]\n  },\n  {\n    id: \"qso-short-2\",\n    category: \"qso\",\n    title: \"QSO例: 挨拶と信号報告のみ\",\n    dialog: [\n      { side: \"A\", text: \"CQ DX CQ DX DE JH8ZZZ JH8ZZZ K\" },\n      { side: \"B\", text: \"JH8ZZZ DE VK2AAA VK2AAA K\" },\n      { side: \"A\", text: \"R VK2AAA DE JH8ZZZ GM UR RST 579 NAME TARO QTH SAPPORO HW? AR JH8ZZZ KN\" },\n      { side: \"B\", text: \"R JH8ZZZ DE VK2AAA TKS TARO UR RST 589 NAME JOHN QTH SYDNEY 73 AR VK2AAA VA\" },\n      { side: \"A\", text: \"R VK2AAA TNX QSO 73 AR JH8ZZZ VA TU\" }\n    ]\n  }\n];\n//! 英文100字程度のサンプルテンプレート。\nconst y = [\n  {\n    id: \"text100-1\",\n    category: \"text100\",\n    title: \"英文例1: 自己紹介\",\n    content: \"MY NAME IS JOHN. I LIVE IN TOKYO JAPAN. I AM A STUDENT AT THE UNIVERSITY. I ENJOY LEARNING MORSE CODE IN MY FREE TIME.\"\n  },\n  {\n    id: \"text100-2\",\n    category: \"text100\",\n    title: \"英文例2: 天気\",\n    content: \"THE WEATHER TODAY IS VERY NICE. IT IS SUNNY AND WARM. I WENT FOR A WALK IN THE PARK. MANY PEOPLE WERE ENJOYING THE SUNSHINE.\"\n  },\n  {\n    id: \"text100-3\",\n    category: \"text100\",\n    title: \"英文例3: 趣味\",\n    content: \"I HAVE MANY HOBBIES. I LIKE READING BOOKS AND LISTENING TO MUSIC. ON WEEKENDS I PLAY TENNIS WITH MY FRIENDS. WE HAVE A LOT OF FUN.\"\n  }\n];\n//! 英文200字程度のサンプルテンプレート。\nconst O = [\n  {\n    id: \"text200-1\",\n    category: \"text200\",\n    title: \"英文例1: アマチュア無線の歴史\",\n    content: \"AMATEUR RADIO HAS A LONG AND RICH HISTORY. IT BEGAN IN THE EARLY TWENTIETH CENTURY WHEN ENTHUSIASTS STARTED EXPERIMENTING WITH RADIO WAVES. MORSE CODE WAS THE PRIMARY MODE OF COMMUNICATION. TODAY AMATEUR RADIO CONTINUES TO BE A POPULAR HOBBY AROUND THE WORLD. OPERATORS USE VARIOUS MODES INCLUDING CW SSB AND DIGITAL MODES. IT IS A GREAT WAY TO MAKE FRIENDS AND LEARN ABOUT TECHNOLOGY.\"\n  },\n  {\n    id: \"text200-2\",\n    category: \"text200\",\n    title: \"英文例2: 旅行の思い出\",\n    content: \"LAST SUMMER I WENT ON A TRIP TO KYOTO. IT WAS MY FIRST TIME VISITING THE ANCIENT CAPITAL OF JAPAN. I VISITED MANY FAMOUS TEMPLES AND SHRINES. THE ARCHITECTURE WAS BEAUTIFUL AND THE GARDENS WERE PEACEFUL. I ALSO ENJOYED TRYING LOCAL FOODS LIKE TOFU AND GREEN TEA. THE PEOPLE WERE VERY FRIENDLY AND HELPFUL. I TOOK MANY PHOTOS TO REMEMBER THIS WONDERFUL EXPERIENCE. I HOPE TO RETURN SOMEDAY.\"\n  }\n];\n//! 英文300字程度のサンプルテンプレート。\nconst C = [\n  {\n    id: \"text300-1\",\n    category: \"text300\",\n    title: \"英文例1: モールス符号の学習\",\n    content: \"LEARNING MORSE CODE IS A REWARDING EXPERIENCE. AT FIRST IT MAY SEEM DIFFICULT BUT WITH REGULAR PRACTICE IT BECOMES EASIER. THE KOCH METHOD IS ONE OF THE MOST EFFECTIVE WAYS TO LEARN. IT STARTS WITH JUST TWO CHARACTERS AND GRADUALLY ADDS MORE. THIS APPROACH HELPS YOU LEARN AT A STEADY PACE. LISTENING PRACTICE IS ALSO VERY IMPORTANT. YOU SHOULD TRY TO COPY REAL MORSE CODE TRANSMISSIONS. MANY ONLINE RESOURCES ARE AVAILABLE TO HELP YOU PRACTICE. JOINING AN AMATEUR RADIO CLUB CAN ALSO BE BENEFICIAL. YOU CAN MEET OTHER ENTHUSIASTS AND SHARE EXPERIENCES. WITH DEDICATION AND PATIENCE YOU WILL MASTER MORSE CODE AND ENJOY USING IT IN YOUR RADIO COMMUNICATIONS.\"\n  },\n  {\n    id: \"text300-2\",\n    category: \"text300\",\n    title: \"英文例2: 無線交信の楽しみ\",\n    content: \"AMATEUR RADIO OFFERS MANY EXCITING OPPORTUNITIES. ONE OF THE GREATEST JOYS IS MAKING CONTACT WITH STATIONS AROUND THE WORLD. YOU CAN TALK TO PEOPLE FROM DIFFERENT COUNTRIES AND CULTURES. EACH CONTACT IS UNIQUE AND SPECIAL. SOME OPERATORS ENJOY CONTESTS WHERE THEY TRY TO MAKE AS MANY CONTACTS AS POSSIBLE. OTHERS PREFER RELAXED CONVERSATIONS ABOUT HOBBIES AND DAILY LIFE. DX CONTACTS WITH DISTANT STATIONS ARE PARTICULARLY THRILLING. THE THRILL OF HEARING A WEAK SIGNAL FROM FAR AWAY IS UNFORGETTABLE. OPERATING PORTABLE FROM MOUNTAINTOPS OR PARKS IS ALSO FUN. YOU CAN COMBINE YOUR LOVE OF RADIO WITH OUTDOOR ACTIVITIES. AMATEUR RADIO IS MORE THAN A HOBBY IT IS A LIFELONG PASSION.\"\n  }\n];\nclass K {\n  /**\n   * ランダムなコールサインを生成する\n   * @returns JA/JE/JF等のプレフィックス + 0-9のエリア番号 + 3文字のサフィックス\n   */\n  static generateCallsign() {\n    const e = [\"JA\", \"JE\", \"JF\", \"JH\", \"JI\", \"JJ\", \"JK\", \"JL\", \"JM\", \"JN\", \"JO\", \"JP\", \"JQ\", \"JR\"], t = e[Math.floor(Math.random() * e.length)], s = Math.floor(Math.random() * 10), n = String.fromCharCode(65 + Math.floor(Math.random() * 26)) + String.fromCharCode(65 + Math.floor(Math.random() * 26)) + String.fromCharCode(65 + Math.floor(Math.random() * 26));\n    return `${t}${s}${n}`;\n  }\n  /**\n   * 配列からランダムな要素を選択する\n   * @param array - 選択元の配列\n   * @returns ランダムに選ばれた要素\n   */\n  static randomChoice(e) {\n    return e[Math.floor(Math.random() * e.length)];\n  }\n  /**\n   * ランダムなQSOを生成する\n   * @returns 完全なQSOテンプレート\n   */\n  static generateRandomQSO() {\n    const e = this.generateCallsign(), t = this.generateCallsign(), s = this.randomChoice(b), n = this.randomChoice(b), r = this.randomChoice(L), i = this.randomChoice(L), a = this.randomChoice(H), c = this.randomChoice(H), h = this.randomChoice(v), E = this.randomChoice(v), l = this.randomChoice([\"GM\", \"GA\", \"GE\", \"GN\"]);\n    return {\n      id: `qso-random-${Date.now()}`,\n      category: \"qso\",\n      title: \"ランダムQSO\",\n      dialog: [\n        { side: \"A\", text: `CQ CQ CQ DE ${e} ${e} PSE K` },\n        { side: \"B\", text: `${e} DE ${t} ${t} K` },\n        { side: \"A\", text: `R ${t} DE ${e} ${l} OM TNX FER UR CALL BT UR RST IS ${c} ${c} BT MI QTH IS ${s} ${s} ES MI NAME IS ${r} ${r} HW ? AR ${e} DE ${e} KN` },\n        { side: \"B\", text: `R ${e} DE ${t} ${l} DR ${r} OM TKS FER FB RPT ${c} FM ${s} BT UR RST ALSO ${a} ${a} VY FB MI QTH IS ${n} ${n} BT NAME IS ${i} ${i} HW? ${e} DE ${t} KN` },\n        { side: \"A\", text: `R FB DE ${e} DR ${i} OM BT MI RIG IS ${h} PWR 100W BT PSE UR QSL CRD VIA JARL ? MI CRD SURE HW? AR ${t} DE ${e} KN` },\n        { side: \"B\", text: `R ${e} DE ${t} OK ${r} OM BT UR RIG ${h} VY FB BT MI RIG IS ${E} BT QSL VIA JARL OK SURE BT TNX FB QSO ES 73 AR ${e} DE ${t} VA` },\n        { side: \"A\", text: `OK ${i} SOLID CPI BT TKS FB QSO ES BEST 73 AR ${t} DE ${e} VA TU E E` }\n      ]\n    };\n  }\n  /**\n   * カテゴリー別にビルトインテンプレートを取得する\n   * @param category - テンプレートカテゴリー（省略時は全カテゴリー）\n   * @returns テンプレートの配列\n   */\n  static getBuiltinTemplates(e) {\n    if (!e)\n      return [...R, ...y, ...O, ...C];\n    switch (e) {\n      case \"qso\":\n        return [...R];\n      case \"text100\":\n        return [...y];\n      case \"text200\":\n        return [...O];\n      case \"text300\":\n        return [...C];\n      default:\n        return [];\n    }\n  }\n  /**\n   * IDでテンプレートを検索する\n   * @param id - テンプレートID\n   * @returns 該当するテンプレート（見つからない場合はundefined）\n   */\n  static getTemplateById(e) {\n    return this.getBuiltinTemplates().find((s) => s.id === e);\n  }\n  /**\n   * 正答率を計算する\n   * @param correctAnswer - 正解の文字列\n   * @param userInput - ユーザー入力の文字列\n   * @returns 正答率（0-100）\n   */\n  static calculateAccuracy(e, t) {\n    if (!t) return 0;\n    //! 空白を除去して大文字化して比較。\n    const s = e.replace(/\\s/g, \"\").toUpperCase(), n = t.replace(/\\s/g, \"\").toUpperCase(), r = Math.max(s.length, n.length);\n    if (r === 0) return 0;\n    let i = 0;\n    for (let a = 0; a < r; a++)\n      s[a] === n[a] && i++;\n    return Math.round(i / r * 100);\n  }\n  /**\n   * 合格判定\n   * @param accuracy - 正答率（0-100）\n   * @param threshold - 合格ライン（デフォルト: 90）\n   * @returns 合格の場合true\n   */\n  static isPassed(e, t = 90) {\n    return e >= t;\n  }\n  /**\n   * 全カテゴリーのテンプレート数を取得する\n   * @returns カテゴリーごとのテンプレート数\n   */\n  static getTemplateCounts() {\n    return {\n      qso: R.length,\n      text100: y.length,\n      text200: O.length,\n      text300: C.length\n    };\n  }\n  /**\n   * 全ビルトインテンプレートの総数を取得する\n   * @returns 全テンプレート数\n   */\n  static getTotalTemplateCount() {\n    return R.length + y.length + O.length + C.length;\n  }\n}\nclass G {\n  /**\n   * カードをシャッフルする（Fisher-Yates shuffle）\n   * @param cards - シャッフルするカードの配列\n   * @returns シャッフルされたカードの配列\n   */\n  static shuffleCards(e) {\n    const t = [...e];\n    for (let s = t.length - 1; s > 0; s--) {\n      const n = Math.floor(Math.random() * (s + 1));\n      [t[s], t[n]] = [t[n], t[s]];\n    }\n    return t;\n  }\n  /**\n   * 試験問題を生成する\n   * @param entries - 問題の元となるエントリーの配列\n   * @param questionType - 出題形式\n   * @param count - 問題数（entriesの長さを超える場合はentriesの長さになる）\n   * @returns 試験問題の配列\n   */\n  static generateExamQuestions(e, t, s) {\n    if (e.length === 0) return [];\n    const n = Math.min(s, e.length);\n    return this.shuffleCards(e).slice(0, n).map((a) => this.createQuestion(a, e, t));\n  }\n  /**\n   * 1つの試験問題を作成する\n   * @param entry - 正解となるエントリー\n   * @param allEntries - 選択肢生成用の全エントリー\n   * @param questionType - 出題形式\n   * @returns 試験問題\n   */\n  static createQuestion(e, t, s) {\n    //! 正解以外のエントリーから3つ選ぶ。\n    const n = t.filter((a) => a.abbreviation !== e.abbreviation).sort(() => Math.random() - 0.5).slice(0, 3);\n    let r, i;\n    switch (s) {\n      case \"abbr-to-meaning\":\n      case \"morse-to-meaning\":\n        r = `${e.english} / ${e.japanese}`, i = [r, ...n.map((a) => `${a.english} / ${a.japanese}`)];\n        break;\n      case \"meaning-to-abbr\":\n      case \"morse-to-abbr\":\n        r = e.abbreviation, i = [r, ...n.map((a) => a.abbreviation)];\n        break;\n    }\n    //! 選択肢をシャッフル。\n    return i = i.sort(() => Math.random() - 0.5), {\n      type: s,\n      entry: e,\n      choices: i,\n      correctAnswer: r\n    };\n  }\n  /**\n   * ユーザーの回答が正解かどうかを判定する\n   * @param question - 試験問題\n   * @param userAnswer - ユーザーの回答\n   * @returns 正解の場合true\n   */\n  static checkAnswer(e, t) {\n    return t === e.correctAnswer;\n  }\n  /**\n   * 試験結果のスコアを計算する\n   * @param results - 試験結果の配列\n   * @returns スコア情報\n   */\n  static calculateScore(e) {\n    const t = e.length, s = e.filter((r) => r.isCorrect).length, n = t > 0 ? Math.round(s / t * 100) : 0;\n    return {\n      correct: s,\n      total: t,\n      percentage: n\n    };\n  }\n  /**\n   * 合格判定\n   * @param percentage - 正答率（0-100）\n   * @param threshold - 合格ライン（デフォルト: 80）\n   * @returns 合格の場合true\n   */\n  static isPassed(e, t = 80) {\n    return e >= t;\n  }\n  /**\n   * 間違えた問題のエントリーを抽出する\n   * @param results - 試験結果の配列\n   * @returns 間違えたエントリーの配列\n   */\n  static getWrongAnswers(e) {\n    return e.filter((t) => !t.isCorrect).map((t) => t.question.entry);\n  }\n  /**\n   * 正解した問題のエントリーを抽出する\n   * @param results - 試験結果の配列\n   * @returns 正解したエントリーの配列\n   */\n  static getCorrectAnswers(e) {\n    return e.filter((t) => t.isCorrect).map((t) => t.question.entry);\n  }\n  /**\n   * タグでフィルタリングする\n   * @param entries - フィルタリング対象のエントリー配列\n   * @param tags - フィルタリングに使用するタグのセット\n   * @returns フィルタリングされたエントリー配列\n   */\n  static filterByTags(e, t) {\n    return t.size === 0 ? e : e.filter((s) => {\n      const n = s.tags.split(\",\").map((r) => r.trim());\n      return Array.from(t).some((r) => n.includes(r));\n    });\n  }\n  /**\n   * 使用頻度でフィルタリングする\n   * @param entries - フィルタリング対象のエントリー配列\n   * @param frequencies - フィルタリングに使用する頻度のセット（1-5）\n   * @returns フィルタリングされたエントリー配列\n   */\n  static filterByFrequencies(e, t) {\n    return t.size === 0 ? e : e.filter((s) => t.has(s.frequency));\n  }\n  /**\n   * 検索クエリでフィルタリングする\n   * @param entries - フィルタリング対象のエントリー配列\n   * @param query - 検索クエリ（略語、英語、日本語、タグから検索）\n   * @returns フィルタリングされたエントリー配列\n   */\n  static filterByQuery(e, t) {\n    if (!t.trim()) return e;\n    const s = t.toLowerCase();\n    return e.filter(\n      (n) => n.abbreviation.toLowerCase().includes(s) || n.english.toLowerCase().includes(s) || n.japanese.includes(t) || n.tags.toLowerCase().includes(s)\n    );\n  }\n  /**\n   * 全てのタグを抽出する\n   * @param entries - エントリー配列\n   * @returns ユニークなタグの配列（ソート済み）\n   */\n  static getAllTags(e) {\n    const t = /* @__PURE__ */ new Set();\n    return e.forEach((s) => {\n      s.tags.split(\",\").forEach((n) => {\n        const r = n.trim();\n        r && t.add(r);\n      });\n    }), Array.from(t).sort();\n  }\n  /**\n   * エントリーを略語でソートする\n   * @param entries - ソート対象のエントリー配列\n   * @param ascending - 昇順の場合true（デフォルト: true）\n   * @returns ソートされたエントリー配列\n   */\n  static sortByAbbreviation(e, t = !0) {\n    const s = [...e];\n    return s.sort((n, r) => {\n      const i = n.abbreviation.localeCompare(r.abbreviation);\n      return t ? i : -i;\n    }), s;\n  }\n  /**\n   * エントリーを使用頻度でソートする\n   * @param entries - ソート対象のエントリー配列\n   * @param ascending - 昇順の場合true（デフォルト: false、頻度の高い順）\n   * @returns ソートされたエントリー配列\n   */\n  static sortByFrequency(e, t = !1) {\n    const s = [...e];\n    return s.sort((n, r) => {\n      const i = n.frequency - r.frequency;\n      return t ? i : -i;\n    }), s;\n  }\n  /**\n   * エントリーを英語でソートする\n   * @param entries - ソート対象のエントリー配列\n   * @param ascending - 昇順の場合true（デフォルト: true）\n   * @returns ソートされたエントリー配列\n   */\n  static sortByEnglish(e, t = !0) {\n    const s = [...e];\n    return s.sort((n, r) => {\n      const i = n.english.localeCompare(r.english);\n      return t ? i : -i;\n    }), s;\n  }\n  /**\n   * エントリーを日本語でソートする\n   * @param entries - ソート対象のエントリー配列\n   * @param ascending - 昇順の場合true（デフォルト: true）\n   * @returns ソートされたエントリー配列\n   */\n  static sortByJapanese(e, t = !0) {\n    const s = [...e];\n    return s.sort((n, r) => {\n      const i = n.japanese.localeCompare(r.japanese, \"ja\");\n      return t ? i : -i;\n    }), s;\n  }\n  /**\n   * エントリーをタグでソートする\n   * @param entries - ソート対象のエントリー配列\n   * @param ascending - 昇順の場合true（デフォルト: true）\n   * @returns ソートされたエントリー配列\n   */\n  static sortByTags(e, t = !0) {\n    const s = [...e];\n    return s.sort((n, r) => {\n      const i = n.tags.localeCompare(r.tags);\n      return t ? i : -i;\n    }), s;\n  }\n}\nconst D = class D {\n  /**\n   * 進捗を保存する\n   */\n  static saveProgress(e) {\n    try {\n      const t = {\n        known: Array.from(e.known),\n        unknown: Array.from(e.unknown)\n      };\n      localStorage.setItem(\n        `${this.STORAGE_PREFIX}progress`,\n        JSON.stringify(t)\n      );\n    } catch (t) {\n      console.error(\"進捗保存エラー:\", t);\n    }\n  }\n  /**\n   * 進捗を読み込む\n   */\n  static loadProgress() {\n    try {\n      const e = localStorage.getItem(`${this.STORAGE_PREFIX}progress`);\n      if (e) {\n        const t = JSON.parse(e);\n        return {\n          known: new Set(t.known || []),\n          unknown: new Set(t.unknown || [])\n        };\n      }\n    } catch (e) {\n      console.error(\"進捗読み込みエラー:\", e);\n    }\n    return { known: /* @__PURE__ */ new Set(), unknown: /* @__PURE__ */ new Set() };\n  }\n  /**\n   * 進捗をクリアする\n   */\n  static clearProgress() {\n    try {\n      localStorage.removeItem(`${this.STORAGE_PREFIX}progress`);\n    } catch (e) {\n      console.error(\"進捗クリアエラー:\", e);\n    }\n  }\n  /**\n   * フィルター状態を保存する\n   */\n  static saveFilters(e) {\n    try {\n      const t = {\n        selectedTags: Array.from(e.selectedTags),\n        selectedFrequencies: Array.from(e.selectedFrequencies),\n        searchQuery: e.searchQuery\n      };\n      localStorage.setItem(\n        `${this.STORAGE_PREFIX}filters`,\n        JSON.stringify(t)\n      );\n    } catch (t) {\n      console.error(\"フィルター保存エラー:\", t);\n    }\n  }\n  /**\n   * フィルター状態を読み込む\n   */\n  static loadFilters() {\n    try {\n      const e = localStorage.getItem(`${this.STORAGE_PREFIX}filters`);\n      if (e) {\n        const t = JSON.parse(e);\n        return {\n          selectedTags: new Set(t.selectedTags || []),\n          selectedFrequencies: new Set(t.selectedFrequencies || [5]),\n          searchQuery: t.searchQuery || \"\"\n        };\n      }\n    } catch (e) {\n      console.error(\"フィルター読み込みエラー:\", e);\n    }\n    return {\n      selectedTags: /* @__PURE__ */ new Set(),\n      selectedFrequencies: /* @__PURE__ */ new Set([5]),\n      searchQuery: \"\"\n    };\n  }\n  /**\n   * ビュー状態を保存する\n   */\n  static saveViewState(e) {\n    try {\n      localStorage.setItem(\n        `${this.STORAGE_PREFIX}viewState`,\n        JSON.stringify(e)\n      );\n    } catch (t) {\n      console.error(\"ビュー状態保存エラー:\", t);\n    }\n  }\n  /**\n   * ビュー状態を読み込む\n   */\n  static loadViewState() {\n    try {\n      const e = localStorage.getItem(`${this.STORAGE_PREFIX}viewState`);\n      if (e)\n        return JSON.parse(e);\n    } catch (e) {\n      console.error(\"ビュー状態読み込みエラー:\", e);\n    }\n    return {\n      viewMode: \"browse\",\n      displayMode: \"card\",\n      sortColumn: \"abbreviation\",\n      sortDirection: \"asc\",\n      learnQuestionType: \"abbr-to-meaning\",\n      examQuestionType: \"abbr-to-meaning\"\n    };\n  }\n  /**\n   * viewModeのみ保存する\n   */\n  static saveViewMode(e) {\n    const t = this.loadViewState();\n    t.viewMode = e, this.saveViewState(t);\n  }\n  /**\n   * displayModeのみ保存する\n   */\n  static saveDisplayMode(e) {\n    const t = this.loadViewState();\n    t.displayMode = e, this.saveViewState(t);\n  }\n  /**\n   * learnQuestionTypeのみ保存する\n   */\n  static saveLearnQuestionType(e) {\n    const t = this.loadViewState();\n    t.learnQuestionType = e, this.saveViewState(t);\n  }\n  /**\n   * examQuestionTypeのみ保存する\n   */\n  static saveExamQuestionType(e) {\n    const t = this.loadViewState();\n    t.examQuestionType = e, this.saveViewState(t);\n  }\n  /**\n   * sortColumnとsortDirectionを保存する\n   */\n  static saveSortState(e, t) {\n    const s = this.loadViewState();\n    s.sortColumn = e, s.sortDirection = t, this.saveViewState(s);\n  }\n};\nD.STORAGE_PREFIX = \"v10.flashcard.\";\nlet B = D;\n//! 画面の種類。\n//! 入力タイプ。\n//! 設定項目の定義。\n//! 設定値の型。\n//! モーダルのコールバック関数。\nclass F {\n  /**\n   * コンストラクタ\n   *\n   * @param modalId - モーダルのID（重複を避けるため）\n   * @param items - 設定項目の配列\n   * @param currentValues - 現在の設定値\n   * @param callbacks - コールバック関数\n   */\n  constructor(e, t, s, n) {\n    this.modalId = e, this.items = t, this.currentValues = { ...s }, this.initialValues = { ...s }, this.callbacks = n;\n  }\n  /**\n   * モーダルを表示する\n   *\n   * @param screenType - 表示する画面の種類\n   */\n  show(e) {\n    //! この画面用の設定項目をフィルタリングして優先度順にソート。\n    const t = this.items.filter((n) => n.screens.includes(e)).sort((n, r) => n.priority - r.priority);\n    //! モーダルのHTMLを生成。\n    const s = this.generateModalHTML(t);\n    //! DOMに追加。\n    document.body.insertAdjacentHTML(\"beforeend\", s);\n    //! イベントリスナーを設定。\n    this.attachEventListeners(t);\n  }\n  /**\n   * モーダルのHTMLを生成する\n   *\n   * @param items - 表示する設定項目\n   * @returns モーダルのHTML\n   */\n  generateModalHTML(e) {\n    //! FlashcardかListeningかで使い分ける。\n    if (this.modalId.includes(\"flashcard\")) {\n      //! Flashcard用のモーダル（.settings-modal）。\n      return `\n\t\t\t\t<div class=\"settings-modal active\" id=\"${this.modalId}\">\n\t\t\t\t\t<div class=\"settings-content\">\n\t\t\t\t\t\t<h2>設定</h2>\n\t\t\t\t\t\t<div class=\"settings-grid\">\n\t\t\t\t\t\t\t${e.map((s) => this.generateSettingItemHTML(s)).join(\"\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"settings-buttons\">\n\t\t\t\t\t\t\t<button id=\"${this.modalId}-cancel\" class=\"secondary-button\">キャンセル</button>\n\t\t\t\t\t\t\t<button id=\"${this.modalId}-save\" class=\"primary-button\">OK</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n    } else {\n      //! Listening用のモーダル（.modal）。\n      return `\n\t\t\t\t<div class=\"modal\" id=\"${this.modalId}\">\n\t\t\t\t\t<div class=\"modal-content\">\n\t\t\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t\t\t<h2>設定</h2>\n\t\t\t\t\t\t\t<button id=\"${this.modalId}-close\" class=\"close-btn\">×</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"modal-body\">\n\t\t\t\t\t\t\t${e.map((s) => this.generateSettingItemHTML(s)).join(\"\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t\t\t<button id=\"${this.modalId}-cancel\" class=\"btn\">キャンセル</button>\n\t\t\t\t\t\t\t<button id=\"${this.modalId}-save\" class=\"btn primary\">OK</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n    }\n  }\n  /**\n   * 設定項目のHTMLを生成する\n   *\n   * @param item - 設定項目\n   * @returns 設定項目のHTML\n   */\n  generateSettingItemHTML(e) {\n    const t = this.currentValues[e.key];\n    switch (e.inputType) {\n      case \"number\":\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<label for=\"${this.modalId}-${e.key}\">${e.label}</label>\n\t\t\t\t\t\t<input type=\"number\" id=\"${this.modalId}-${e.key}\"\n\t\t\t\t\t\t\tmin=\"${e.min}\" max=\"${e.max}\" step=\"${e.step || 1}\"\n\t\t\t\t\t\t\tvalue=\"${t}\" data-key=\"${e.key}\">\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      case \"range-with-number\":\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<label for=\"${this.modalId}-${e.key}-range\">${e.label}</label>\n\t\t\t\t\t\t<input type=\"range\" id=\"${this.modalId}-${e.key}-range\"\n\t\t\t\t\t\t\tmin=\"${e.min}\" max=\"${e.max}\" step=\"${e.step || 1}\"\n\t\t\t\t\t\t\tvalue=\"${t}\" data-key=\"${e.key}\">\n\t\t\t\t\t\t<input type=\"number\" id=\"${this.modalId}-${e.key}-number\"\n\t\t\t\t\t\t\tmin=\"${e.min}\" max=\"${e.max}\" step=\"${e.step || 1}\"\n\t\t\t\t\t\t\tvalue=\"${t}\" data-key=\"${e.key}\">\n\t\t\t\t\t\t${e.unit ? `<span>${e.unit}</span>` : \"\"}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      case \"button\":\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<span>${e.label}</span>\n\t\t\t\t\t\t<button id=\"${this.modalId}-${e.key}\" class=\"${e.buttonClass || \"test-button\"}\">${e.buttonText || \"再生\"}</button>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      case \"checkbox\":\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<input type=\"checkbox\" id=\"${this.modalId}-${e.key}\"\n\t\t\t\t\t\t\t\tdata-key=\"${e.key}\" ${t ? \"checked\" : \"\"}>\n\t\t\t\t\t\t\t${e.label}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      case \"select\":\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<label for=\"${this.modalId}-${e.key}\">${e.label}</label>\n\t\t\t\t\t\t<select id=\"${this.modalId}-${e.key}\" data-key=\"${e.key}\">\n\t\t\t\t\t\t\t${(e.options || []).map((n) => `\n\t\t\t\t\t\t\t\t<option value=\"${n.value}\" ${t === n.value ? \"selected\" : \"\"}>${n.label}</option>\n\t\t\t\t\t\t\t`).join(\"\")}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      case \"keybinding\":\n        const s = typeof t == \"string\" ? t.replace(/^Key/, \"\") : t;\n        return `\n\t\t\t\t\t<div class=\"setting-item\">\n\t\t\t\t\t\t<label for=\"${this.modalId}-${e.key}\">${e.label}</label>\n\t\t\t\t\t\t<input type=\"text\" id=\"${this.modalId}-${e.key}\" class=\"keybinding-input\"\n\t\t\t\t\t\t\tvalue=\"${s}\" readonly placeholder=\"キーを押してください\" data-key=\"${e.key}\">\n\t\t\t\t\t\t${e.hint ? `<span class=\"key-hint\">${e.hint}</span>` : \"\"}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n      default:\n        return \"\";\n    }\n  }\n  /**\n   * イベントリスナーを設定する\n   *\n   * @param items - 表示する設定項目\n   */\n  attachEventListeners(e) {\n    const t = document.getElementById(this.modalId);\n    if (!t) return;\n    //! 各設定項目のイベントリスナー。\n    e.forEach((i) => {\n      if (i.inputType === \"range-with-number\") {\n        //! レンジとナンバーの同期。\n        const a = document.getElementById(`${this.modalId}-${i.key}-range`), c = document.getElementById(`${this.modalId}-${i.key}-number`);\n        a?.addEventListener(\"input\", () => {\n          c.value = a.value, this.currentValues[i.key] = parseFloat(a.value);\n        }), c?.addEventListener(\"input\", () => {\n          a.value = c.value, this.currentValues[i.key] = parseFloat(c.value);\n        });\n      } else if (i.inputType === \"number\") {\n        const a = document.getElementById(`${this.modalId}-${i.key}`);\n        a?.addEventListener(\"input\", () => {\n          this.currentValues[i.key] = parseFloat(a.value);\n        });\n      } else if (i.inputType === \"button\" && i.key === \"testPlay\") {\n        //! テスト再生ボタン。\n        document.getElementById(`${this.modalId}-${i.key}`)?.addEventListener(\"click\", () => {\n          this.callbacks.onTestPlay?.();\n        });\n      } else if (i.inputType === \"checkbox\") {\n        const a = document.getElementById(`${this.modalId}-${i.key}`);\n        a?.addEventListener(\"change\", () => {\n          this.currentValues[i.key] = a.checked;\n        });\n      } else if (i.inputType === \"select\") {\n        const a = document.getElementById(`${this.modalId}-${i.key}`);\n        a?.addEventListener(\"change\", () => {\n          this.currentValues[i.key] = a.value;\n        });\n      } else if (i.inputType === \"keybinding\") {\n        const a = document.getElementById(`${this.modalId}-${i.key}`);\n        a?.addEventListener(\"click\", () => {\n          a.value = \"キーを押してください...\", a.classList.add(\"waiting-key\");\n        }), a?.addEventListener(\"keydown\", (c) => {\n          c.preventDefault(), c.stopPropagation(), this.currentValues[i.key] = c.code, a.value = c.code.replace(/^Key/, \"\"), a.classList.remove(\"waiting-key\");\n        });\n      }\n    });\n    //! 保存ボタン。\n    document.getElementById(`${this.modalId}-save`)?.addEventListener(\"click\", () => {\n      this.callbacks.onSave(this.currentValues), this.close();\n    });\n    //! キャンセルボタン。\n    document.getElementById(`${this.modalId}-cancel`)?.addEventListener(\"click\", () => {\n      this.currentValues = { ...this.initialValues }, this.callbacks.onCancel(), this.close();\n    });\n    //! 閉じるボタン（×）。\n    document.getElementById(`${this.modalId}-close`)?.addEventListener(\"click\", () => {\n      this.currentValues = { ...this.initialValues }, this.callbacks.onCancel(), this.close();\n    });\n    //! モーダル外クリックで閉じる。\n    t.addEventListener(\"click\", (i) => {\n      i.target === t && (this.currentValues = { ...this.initialValues }, this.callbacks.onCancel(), this.close());\n    });\n  }\n  /**\n   * モーダルを閉じる\n   */\n  close() {\n    document.getElementById(this.modalId)?.remove();\n  }\n}\nconst Y = [\n  //! Flashcard, Koch, 電鍵練習用の設定。\n  {\n    screens: [\"flashcard\", \"koch\", \"horizontal-key\", \"vertical-key\"],\n    priority: 10,\n    key: \"volume\",\n    label: \"音量\",\n    inputType: \"range-with-number\",\n    min: 0,\n    max: 100,\n    step: 1,\n    unit: \"%\"\n  },\n  {\n    screens: [\"flashcard\", \"koch\", \"horizontal-key\", \"vertical-key\"],\n    priority: 20,\n    key: \"frequency\",\n    label: \"周波数 (Hz)\",\n    inputType: \"number\",\n    min: 400,\n    max: 1200,\n    step: 50\n  },\n  {\n    screens: [\"flashcard\", \"koch\", \"horizontal-key\", \"vertical-key\"],\n    priority: 30,\n    key: \"wpm\",\n    label: \"WPM (速度: 5-40)\",\n    inputType: \"number\",\n    min: 5,\n    max: 40,\n    step: 1\n  },\n  //! Listening専用の設定。\n  {\n    screens: [\"listening\"],\n    priority: 5,\n    key: \"characterSpeed\",\n    label: \"文字速度 (WPM)\",\n    inputType: \"number\",\n    min: 5,\n    max: 40,\n    step: 1\n  },\n  {\n    screens: [\"listening\"],\n    priority: 6,\n    key: \"effectiveSpeed\",\n    label: \"実効速度 (WPM)\",\n    inputType: \"number\",\n    min: 5,\n    max: 40,\n    step: 1\n  },\n  {\n    screens: [\"listening\"],\n    priority: 20,\n    key: \"frequency\",\n    label: \"周波数 A側 (Hz)\",\n    inputType: \"number\",\n    min: 400,\n    max: 1e3,\n    step: 10\n  },\n  {\n    screens: [\"listening\"],\n    priority: 21,\n    key: \"bFrequency\",\n    label: \"周波数 B側 (Hz)\",\n    inputType: \"number\",\n    min: 400,\n    max: 1e3,\n    step: 10\n  },\n  {\n    screens: [\"listening\"],\n    priority: 10,\n    key: \"volume\",\n    label: \"音量\",\n    inputType: \"range-with-number\",\n    min: 0,\n    max: 100,\n    step: 5,\n    unit: \"%\"\n  },\n  //! テスト再生ボタン。\n  {\n    screens: [\"flashcard\", \"listening\"],\n    priority: 100,\n    key: \"testPlay\",\n    label: \"テスト再生\",\n    inputType: \"button\",\n    buttonText: \"再生\",\n    buttonClass: \"test-button\"\n  },\n  //! Koch専用の設定。\n  {\n    screens: [\"koch\"],\n    priority: 5,\n    key: \"characterSpeed\",\n    label: \"文字速度 (WPM: 5-40)\",\n    inputType: \"number\",\n    min: 5,\n    max: 40,\n    step: 1\n  },\n  {\n    screens: [\"koch\"],\n    priority: 6,\n    key: \"effectiveSpeed\",\n    label: \"実効速度 (WPM: 5-40)\",\n    inputType: \"number\",\n    min: 5,\n    max: 40,\n    step: 1\n  },\n  {\n    screens: [\"koch\"],\n    priority: 40,\n    key: \"practiceDuration\",\n    label: \"練習時間 (秒: 30-300)\",\n    inputType: \"number\",\n    min: 30,\n    max: 300,\n    step: 30\n  },\n  {\n    screens: [\"koch\"],\n    priority: 50,\n    key: \"groupSize\",\n    label: \"グループサイズ (文字: 3-10)\",\n    inputType: \"number\",\n    min: 3,\n    max: 10,\n    step: 1\n  },\n  {\n    screens: [\"koch\"],\n    priority: 60,\n    key: \"showInput\",\n    label: \"入力を表示\",\n    inputType: \"checkbox\"\n  },\n  //! HorizontalKey専用の設定。\n  {\n    screens: [\"horizontal-key\"],\n    priority: 40,\n    key: \"iambicMode\",\n    label: \"Iambicモード\",\n    inputType: \"select\",\n    options: [\n      { value: \"A\", label: \"Iambic A\" },\n      { value: \"B\", label: \"Iambic B\" }\n    ]\n  },\n  {\n    screens: [\"horizontal-key\"],\n    priority: 50,\n    key: \"paddleLayout\",\n    label: \"パドルレイアウト\",\n    inputType: \"select\",\n    options: [\n      { value: \"normal\", label: \"標準（左=dit / 右=dah）\" },\n      { value: \"reversed\", label: \"反転（左=dah / 右=dit）\" }\n    ]\n  },\n  {\n    screens: [\"horizontal-key\"],\n    priority: 60,\n    key: \"leftKeyCode\",\n    label: \"左パドルキー\",\n    inputType: \"keybinding\",\n    hint: \"クリックしてキーを押す\"\n  },\n  {\n    screens: [\"horizontal-key\"],\n    priority: 70,\n    key: \"rightKeyCode\",\n    label: \"右パドルキー\",\n    inputType: \"keybinding\",\n    hint: \"クリックしてキーを押す\"\n  },\n  //! VerticalKey専用の設定。\n  {\n    screens: [\"vertical-key\"],\n    priority: 40,\n    key: \"keyCode\",\n    label: \"キーバインド\",\n    inputType: \"keybinding\",\n    hint: \"クリックしてキーを押す\"\n  }\n];\nexport {\n  Y as ALL_SETTING_ITEMS,\n  W as AudioGenerator,\n  B as FlashcardState,\n  G as FlashcardTrainer,\n  $ as HorizontalKeyTrainer,\n  N as KOCH_SEQUENCE,\n  M as KochTrainer,\n  K as ListeningTrainer,\n  w as MorseBuffer,\n  g as MorseCodec,\n  F as SettingsModal,\n  k as TimerManager,\n  x as TimingCalculator,\n  T as TimingEvaluator,\n  P as VerticalKeyTrainer\n};\n//# sourceMappingURL=index.js.map\n"],"names":["f","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","Object","fromEntries","entries","map","m","e","g","textToMorse","t","toUpperCase","s","n","i","r","exec","index","h","substring","Array","from","l","push","join","c","lastIndex","length","a","filter","morseToText","getMorseMap","charToMorse","x","calculate","Error","shortenGaps","dot","dash","elementGap","charGap","wordGap","getCharGapDelay","getWordGapDelay","classifyElement","createRecord","Date","now","element","actualDuration","expectedDuration","timestamp","evaluate","Math","abs","record","absoluteError","relativeError","accuracy","max","calculateStatistics","count","averageAccuracy","averageAbsoluteError","averageRelativeError","maxAccuracy","minAccuracy","standardDeviation","o","reduce","u","min","pow","sqrt","classifyByElement","getRecent","sort","slice","getByTimeRange","createSpacingRecord","type","evaluateSpacing","calculateSpacingStatistics","classifyBySpacingType","character","word","w","constructor","this","buffer","sequence","getSequence","getBuffer","addElement","commitSequence","addWordSeparator","endsWith","clear","getBufferLength","getSequenceLength","isEmpty","k","timers","Map","set","window","setTimeout","get","clearTimeout","delete","clearAll","values","has","size","frequency","volume","wpm","audioContext","currentOscillator","currentGain","isPlaying","settings","ensureAudioContext","AudioContext","webkitAudioContext","state","resume","updateSettings","getSettings","scheduleTone","createOscillator","createGain","connect","destination","value","currentTime","gain","setValueAtTime","linearRampToValueAtTime","start","stop","startContinuousTone","stopContinuousTone","cancelScheduledValues","playMorseString","effectiveWpm","d","Promise","stopPlaying","isCurrentlyPlaying","getAudioContext","getVolume","setVolume","getFrequency","setFrequency","getWPM","setWPM","generateWav","OfflineAudioContext","ceil","scheduleOfflineTone","p","startRendering","audioBufferToWav","numberOfChannels","sampleRate","Float32Array","getChannelData","ArrayBuffer","DataView","setUint8","charCodeAt","setUint32","setUint16","setInt16","Blob","timer","timings","callbacks","keyDown","keyDownTime","evaluations","keyPress","onKeyPress","keyRelease","onKeyRelease","onSequenceUpdate","onTimingEvaluated","notifyBufferUpdate","setupCharWordTimers","onCharacter","onWordSeparator","trim","split","onBufferUpdate","getDecoded","isKeyDown","getTimerCount","getTimingStatistics","getRecentEvaluations","getAllEvaluations","getStatisticsByElement","$","leftDown","rightDown","sending","lastSent","forceNextElement","squeezeDetected","isSqueezing","spacingEvaluations","lastElementEndTime","currentWordElements","currentWordGaps","currentWordPaddleInputs","currentWordSqueezeIntervals","lastWordTimingData","currentElementStartTime","squeezeStartTime","iambicMode","paddleLayout","leftPaddlePress","paddle","updateSqueezeState","sendPaddleElement","rightPaddlePress","leftPaddleRelease","rightPaddleRelease","startTime","endTime","duration","onSpacingEvaluated","onElementStart","onElementEnd","scheduleNext","elements","gaps","paddleInputs","squeezeIntervals","decodedChar","morseCode","onSqueezeChange","isLeftPaddleDown","isRightPaddleDown","isSending","isSqueezingNow","setIambicMode","setPaddleLayout","getIambicMode","getPaddleLayout","getSpacingStatistics","getRecentSpacingEvaluations","getAllSpacingEvaluations","getStatisticsBySpacingType","getLastWordTimingData","currentLesson","getCharsForLesson","generateRandomGroups","groupSize","floor","random","generateCustomGroups","calculateAccuracy","replace","isPassed","getCurrentLesson","setCurrentLesson","getCurrentChars","generatePractice","advanceLesson","previousLesson","isLastLesson","isFirstLesson","getTotalLessons","getTotalChars","getAllChars","b","v","id","category","title","dialog","side","text","y","content","generateCallsign","String","fromCharCode","randomChoice","generateRandomQSO","getBuiltinTemplates","getTemplateById","find","round","getTemplateCounts","qso","text100","text200","text300","getTotalTemplateCount","shuffleCards","generateExamQuestions","createQuestion","abbreviation","english","japanese","entry","choices","correctAnswer","checkAnswer","calculateScore","isCorrect","correct","total","percentage","getWrongAnswers","question","getCorrectAnswers","filterByTags","tags","some","includes","filterByFrequencies","filterByQuery","toLowerCase","getAllTags","Set","forEach","add","sortByAbbreviation","localeCompare","sortByFrequency","sortByEnglish","sortByJapanese","sortByTags","saveProgress","known","unknown","localStorage","setItem","STORAGE_PREFIX","JSON","stringify","loadProgress","getItem","parse","clearProgress","removeItem","saveFilters","selectedTags","selectedFrequencies","searchQuery","loadFilters","saveViewState","loadViewState","viewMode","displayMode","sortColumn","sortDirection","learnQuestionType","examQuestionType","saveViewMode","saveDisplayMode","saveLearnQuestionType","saveExamQuestionType","saveSortState","modalId","items","currentValues","initialValues","show","screens","priority","generateModalHTML","document","body","insertAdjacentHTML","attachEventListeners","generateSettingItemHTML","key","inputType","label","step","unit","buttonClass","buttonText","options","hint","getElementById","addEventListener","parseFloat","onTestPlay","checked","classList","preventDefault","stopPropagation","code","remove","onSave","close","onCancel","target"],"mappings":"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,IAAI,GAAIhE,GAChD,CAKA,eAAAoQ,GACE,OAAOxR,EAAE6Q,kBAAkBxK,KAAKuK,cAClC,CAMA,gBAAAa,CAAiBrQ,EAAI,IACnB,MAAMG,EAAI8E,KAAKmL,kBACf,OAAOxR,EAAE8Q,qBAAqBvP,EAAGH,EACnC,CAKA,aAAAsQ,GACE,OAAOrL,KAAKuK,cAAgB,IAAMvK,KAAKuK,gBAAiBvK,KAAKuK,aAC/D,CAKA,cAAAe,GACE,OAAOtL,KAAKuK,cAAgB,GAAKvK,KAAKuK,gBAAiBvK,KAAKuK,aAC9D,CAKA,YAAAgB,GACE,OAA8B,KAAvBvL,KAAKuK,aACd,CAKA,aAAAiB,GACE,OAA8B,IAAvBxL,KAAKuK,aACd,CAKA,sBAAOkB,GACL,OAAO,EACT,CAKA,oBAAOC,GACL,OAAO9R,EAAEuC,MACX,CAKA,kBAAOwP,GACL,MAAO,IAAI/R,EACb;iBAGF;MAAMgS,EAAI,CACR,QACA,QACA,QACA,SACA,WACA,OACA,UACA,UACA,SACA,YACA,WACA,UACA,QACA,aACA,QACA,UACA,YACA,WACA,UACA,aACA,WACA,YACA,YACA,OACA,aACA,WACA,SACA,OACA,WACA,OACA,QACA,WACA,OACA,WACA,SACA,QACA,YACA,UACA,WACA,OACA,YACA,YACA,QACA,OACA,MACA,YACA,SACA,UACA,YACA,YACA,YACA,OACA,WACA,QACA,WACA,WACA,UACA,YACA,SACA,cACA,YACA,YACA,WACA,QACA,YACA,YACA,WACA,YACA,QACA,UACA,UACA,YACA,YACA,YACA,WACA,aACA,WACA,WACA,WACA,UACA,UACA,WACA,UACA,aACA,OACA,QACA,QACA,OACA,YACA,SACA,UACA,YACA,WACA,WACA,QACA,SACA,OACA,UACA,WACA,SAGIlS,EAAI,CACR,OACA,OACA,MACA,OACA,MACA,OACA,MACA,OACA,QACA,OACA,OACA,MACA,MACA,MACA,OACA,QACA,SACA,OACA,MACA,KACA,OACA,OACA,OACA,QACA,OACA,SACA,QACA,QACA,QACA,QACA,OACA,QACA,QACA,QACA,OACA,QACA,OACA,OACA,QACA,QACA,SACA,SACA,SACA,UACA,SACA,UACA,UACA,SACA,QACA,UACA,QACA,SACA,SACA,SACA,SACA,SACA,SACA,QACA,WACA,UACA,WACA,SACA,SACA,SACA,SACA,QACA,QACA,UACA,MACA,OACA,UACA,WACA,SACA,QACA,QACA,UACA,SACA,SACA,UACA,QACA,OACA,QACA,UACA,QACA,OACA,SACA,SACA,SACA,SACA,SACA,MACA,MACA,OACA,MACA,MACA,QACA,MACA,MACA,OACA,QAGImS,EAAI,CACR,UACA,SACA,UACA,UACA,WAEA,UACA,UACA,UACA,SACA,SAEA,WACA,UACA,YACA,UACA,WAIIvS,EAAI,CACR,MACA,MACA,MACA,MACA,MACA,MACA,OAGIU,EAAI,CACR,CACE8R,GAAI,oBACJC,SAAU,MACVC,MAAO,qBACPC,OAAQ,CACN,CAAEC,KAAM,IAAKC,KAAM,mCACnB,CAAED,KAAM,IAAKC,KAAM,6BACnB,CAAED,KAAM,IAAKC,KAAM,qJACnB,CAAED,KAAM,IAAKC,KAAM,oKACnB,CAAED,KAAM,IAAKC,KAAM,wJACnB,CAAED,KAAM,IAAKC,KAAM,iLACnB,CAAED,KAAM,IAAKC,KAAM,8EAGvB,CACEL,GAAI,cACJC,SAAU,MACVC,MAAO,wBACPC,OAAQ,CACN,CAAEC,KAAM,IAAKC,KAAM,mCACnB,CAAED,KAAM,IAAKC,KAAM,6BACnB,CAAED,KAAM,IAAKC,KAAM,iFACnB,CAAED,KAAM,IAAKC,KAAM,0DAGvB,CACEL,GAAI,cACJC,SAAU,MACVC,MAAO,kBACPC,OAAQ,CACN,CAAEC,KAAM,IAAKC,KAAM,kCACnB,CAAED,KAAM,IAAKC,KAAM,6BACnB,CAAED,KAAM,IAAKC,KAAM,2EACnB,CAAED,KAAM,IAAKC,KAAM,+EACnB,CAAED,KAAM,IAAKC,KAAM,0CAKnBC,EAAI,CACR,CACEN,GAAI,YACJC,SAAU,UACVC,MAAO,aACPK,QAAS,0HAEX,CACEP,GAAI,YACJC,SAAU,UACVC,MAAO,WACPK,QAAS,gIAEX,CACEP,GAAI,YACJC,SAAU,UACVC,MAAO,WACPK,QAAS,uIAIPxS,EAAI,CACR,CACEiS,GAAI,YACJC,SAAU,UACVC,MAAO,mBACPK,QAAS,qYAEX,CACEP,GAAI,YACJC,SAAU,UACVC,MAAO,eACPK,QAAS,0YAIPpT,EAAI,CACR,CACE6S,GAAI,YACJC,SAAU,UACVC,MAAO,kBACPK,QAAS,spBAEX,CACEP,GAAI,YACJC,SAAU,UACVC,MAAO,iBACPK,QAAS;iBAGb;MAAM5S,EAKJ,uBAAO6S,GACL,MAAMvR,EAAI,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACzF,MAAO,GAD6FA,EAAE8C,KAAK8M,MAAM9M,KAAK+M,SAAW7P,EAAEoB,WAAc0B,KAAK8M,MAAsB,GAAhB9M,KAAK+M,YAAoB2B,OAAOC,aAAa,GAAK3O,KAAK8M,MAAsB,GAAhB9M,KAAK+M,WAAkB2B,OAAOC,aAAa,GAAK3O,KAAK8M,MAAsB,GAAhB9M,KAAK+M,WAAkB2B,OAAOC,aAAa,GAAK3O,KAAK8M,MAAsB,GAAhB9M,KAAK+M,YAEtV,CAMA,mBAAO6B,CAAa1R,GAClB,OAAOA,EAAE8C,KAAK8M,MAAM9M,KAAK+M,SAAW7P,EAAEoB,QACxC,CAKA,wBAAOuQ,GACL,MAAM3R,EAAIiF,KAAKsM,mBAAoBpR,EAAI8E,KAAKsM,mBAAoBlR,EAAI4E,KAAKyM,aAAab,GAAIvQ,EAAI2E,KAAKyM,aAAab,GAAIrQ,EAAIyE,KAAKyM,aAAa/S,GAAI4B,EAAI0E,KAAKyM,aAAa/S,GAAI0C,EAAI4D,KAAKyM,aAAanT,GAAI2C,EAAI+D,KAAKyM,aAAanT,GAAIoC,EAAIsE,KAAKyM,aAAaZ,GAAI1S,EAAI6G,KAAKyM,aAAaZ,GAAI/P,EAAIkE,KAAKyM,aAAa,CAAC,KAAM,KAAM,KAAM,OACzT,MAAO,CACLX,GAAI,cAAcxO,KAAKC,QACvBwO,SAAU,MACVC,MAAO,UACPC,OAAQ,CACN,CAAEC,KAAM,IAAKC,KAAM,eAAepR,KAAKA,WACvC,CAAEmR,KAAM,IAAKC,KAAM,GAAGpR,QAAQG,KAAKA,OACnC,CAAEgR,KAAM,IAAKC,KAAM,KAAKjR,QAAQH,KAAKe,qCAAqCG,KAAKA,kBAAkBb,KAAKA,mBAAmBG,KAAKA,aAAaR,QAAQA,QACnJ,CAAEmR,KAAM,IAAKC,KAAM,KAAKpR,QAAQG,KAAKY,QAAQP,uBAAuBU,QAAQb,oBAAoBgB,KAAKA,qBAAqBf,KAAKA,gBAAgBC,KAAKA,SAASP,QAAQG,QACrK,CAAEgR,KAAM,IAAKC,KAAM,WAAWpR,QAAQO,qBAAqBI,8DAA8DR,QAAQH,QACjI,CAAEmR,KAAM,IAAKC,KAAM,KAAKpR,QAAQG,QAAQK,kBAAkBG,wBAAwBvC,oDAAoD4B,QAAQG,QAC9I,CAAEgR,KAAM,IAAKC,KAAM,MAAM7Q,2CAA2CJ,QAAQH,gBAGlF,CAMA,0BAAO4R,CAAoB5R,GACzB,IAAKA,EACH,MAAO,IAAIf,KAAMoS,KAAMvS,KAAMZ,GAC/B,OAAQ8B,GACN,IAAK,MACH,MAAO,IAAIf,GACb,IAAK,UACH,MAAO,IAAIoS,GACb,IAAK,UACH,MAAO,IAAIvS,GACb,IAAK,UACH,MAAO,IAAIZ,GACb,QACE,MAAO,GAEb,CAMA,sBAAO2T,CAAgB7R,GACrB,OAAOiF,KAAK2M,sBAAsBE,KAAMzR,GAAMA,EAAE0Q,KAAO/Q,EACzD,CAOA,wBAAO+P,CAAkB/P,EAAGG,GAC1B,IAAKA,EAAG,OAAO;oBAEf;MAAME,EAAIL,EAAEgQ,QAAQ,MAAO,IAAI5P,cAAeE,EAAIH,EAAE6P,QAAQ,MAAO,IAAI5P,cAAeI,EAAIsC,KAAKM,IAAI/C,EAAEe,OAAQd,EAAEc,QAC/G,GAAU,IAANZ,EAAS,OAAO,EACpB,IAAID,EAAI,EACR,IAAA,IAASc,EAAI,EAAGA,EAAIb,EAAGa,IACrBhB,EAAEgB,KAAOf,EAAEe,IAAMd,IACnB,OAAOuC,KAAKiP,MAAMxR,EAAIC,EAAI,IAC5B,CAOA,eAAOyP,CAASjQ,EAAGG,EAAI,IACrB,OAAOH,GAAKG,CACd,CAKA,wBAAO6R,GACL,MAAO,CACLC,IAAKhT,EAAEmC,OACP8Q,QAASb,EAAEjQ,OACX+Q,QAASrT,EAAEsC,OACXgR,QAASlU,EAAEkD,OAEf,CAKA,4BAAOiR,GACL,OAAOpT,EAAEmC,OAASiQ,EAAEjQ,OAAStC,EAAEsC,OAASlD,EAAEkD,MAC5C,EAEF,MAAM9C,EAMJ,mBAAOgU,CAAatS,GAClB,MAAMG,EAAI,IAAIH,GACd,IAAA,IAASK,EAAIF,EAAEiB,OAAS,EAAGf,EAAI,EAAGA,IAAK,CACrC,MAAMC,EAAIwC,KAAK8M,MAAM9M,KAAK+M,UAAYxP,EAAI,KACzCF,EAAEE,GAAIF,EAAEG,IAAM,CAACH,EAAEG,GAAIH,EAAEE,GAC1B,CACA,OAAOF,CACT,CAQA,4BAAOoS,CAAsBvS,EAAGG,EAAGE,GACjC,GAAiB,IAAbL,EAAEoB,OAAc,MAAO,GAC3B,MAAMd,EAAIwC,KAAKkB,IAAI3D,EAAGL,EAAEoB,QACxB,OAAO6D,KAAKqN,aAAatS,GAAGsE,MAAM,EAAGhE,GAAGR,IAAKuB,GAAM4D,KAAKuN,eAAenR,EAAGrB,EAAGG,GAC/E,CAQA,qBAAOqS,CAAexS,EAAGG,EAAGE;;AAE1B,MAAMC,EAAIH,EAAEmB,OAAQD,GAAMA,EAAEoR,eAAiBzS,EAAEyS,cAAcpO,KAAK,IAAMvB,KAAK+M,SAAW,IAAKvL,MAAM,EAAG,GACtG,IAAI9D,EAAGD,EACP,OAAQF,GACN,IAAK,kBACL,IAAK,mBACHG,EAAI,GAAGR,EAAE0S,aAAa1S,EAAE2S,WAAYpS,EAAI,CAACC,KAAMF,EAAER,IAAKuB,GAAM,GAAGA,EAAEqR,aAAarR,EAAEsR,aAChF,MACF,IAAK,kBACL,IAAK,gBACHnS,EAAIR,EAAEyS,aAAclS,EAAI,CAACC,KAAMF,EAAER,IAAKuB,GAAMA,EAAEoR;cAIlD;OAAOlS,EAAIA,EAAE8D,KAAK,IAAMvB,KAAK+M,SAAW,IAAM,CAC5CpL,KAAMpE,EACNuS,MAAO5S,EACP6S,QAAStS,EACTuS,cAAetS,EAEnB,CAOA,kBAAOuS,CAAY/S,EAAGG,GACpB,OAAOA,IAAMH,EAAE8S,aACjB,CAMA,qBAAOE,CAAehT,GACpB,MAAMG,EAAIH,EAAEoB,OAAQf,EAAIL,EAAEsB,OAAQd,GAAMA,EAAEyS,WAAW7R,OACrD,MAAO,CACL8R,QAAS7S,EACT8S,MAAOhT,EACPiT,WAJ+DjT,EAAI,EAAI2C,KAAKiP,MAAM1R,EAAIF,EAAI,KAAO,EAMrG,CAOA,eAAO8P,CAASjQ,EAAGG,EAAI,IACrB,OAAOH,GAAKG,CACd,CAMA,sBAAOkT,CAAgBrT,GACrB,OAAOA,EAAEsB,OAAQnB,IAAOA,EAAE8S,WAAWnT,IAAKK,GAAMA,EAAEmT,SAASV,MAC7D,CAMA,wBAAOW,CAAkBvT,GACvB,OAAOA,EAAEsB,OAAQnB,GAAMA,EAAE8S,WAAWnT,IAAKK,GAAMA,EAAEmT,SAASV,MAC5D,CAOA,mBAAOY,CAAaxT,EAAGG,GACrB,OAAkB,IAAXA,EAAEuG,KAAa1G,EAAIA,EAAEsB,OAAQjB,IAClC,MAAMC,EAAID,EAAEoT,KAAK/H,MAAM,KAAK5L,IAAKU,GAAMA,EAAEiL,QACzC,OAAO5K,MAAMC,KAAKX,GAAGuT,KAAMlT,GAAMF,EAAEqT,SAASnT,KAEhD,CAOA,0BAAOoT,CAAoB5T,EAAGG,GAC5B,OAAkB,IAAXA,EAAEuG,KAAa1G,EAAIA,EAAEsB,OAAQjB,GAAMF,EAAEsG,IAAIpG,EAAEsG,WACpD,CAOA,oBAAOkN,CAAc7T,EAAGG,GACtB,IAAKA,EAAEsL,OAAQ,OAAOzL,EACtB,MAAMK,EAAIF,EAAE2T,cACZ,OAAO9T,EAAEsB,OACNhB,GAAMA,EAAEmS,aAAaqB,cAAcH,SAAStT,IAAMC,EAAEoS,QAAQoB,cAAcH,SAAStT,IAAMC,EAAEqS,SAASgB,SAASxT,IAAMG,EAAEmT,KAAKK,cAAcH,SAAStT,GAEtJ,CAMA,iBAAO0T,CAAW/T,GAChB,MAAMG,MAAwB6T,IAC9B,OAAOhU,EAAEiU,QAAS5T,IAChBA,EAAEoT,KAAK/H,MAAM,KAAKuI,QAAS3T,IACzB,MAAME,EAAIF,EAAEmL,OACZjL,GAAKL,EAAE+T,IAAI1T,OAEXK,MAAMC,KAAKX,GAAGkE,MACpB,CAOA,yBAAO8P,CAAmBnU,EAAGG,GAAI,GAC/B,MAAME,EAAI,IAAIL,GACd,OAAOK,EAAEgE,KAAK,CAAC/D,EAAGE,KAChB,MAAMD,EAAID,EAAEmS,aAAa2B,cAAc5T,EAAEiS,cACzC,OAAOtS,EAAII,GAAKA,IACdF,CACN,CAOA,sBAAOgU,CAAgBrU,EAAGG,GAAI,GAC5B,MAAME,EAAI,IAAIL,GACd,OAAOK,EAAEgE,KAAK,CAAC/D,EAAGE,KAChB,MAAMD,EAAID,EAAEqG,UAAYnG,EAAEmG,UAC1B,OAAOxG,EAAII,GAAKA,IACdF,CACN,CAOA,oBAAOiU,CAActU,EAAGG,GAAI,GAC1B,MAAME,EAAI,IAAIL,GACd,OAAOK,EAAEgE,KAAK,CAAC/D,EAAGE,KAChB,MAAMD,EAAID,EAAEoS,QAAQ0B,cAAc5T,EAAEkS,SACpC,OAAOvS,EAAII,GAAKA,IACdF,CACN,CAOA,qBAAOkU,CAAevU,EAAGG,GAAI,GAC3B,MAAME,EAAI,IAAIL,GACd,OAAOK,EAAEgE,KAAK,CAAC/D,EAAGE,KAChB,MAAMD,EAAID,EAAEqS,SAASyB,cAAc5T,EAAEmS,SAAU,MAC/C,OAAOxS,EAAII,GAAKA,IACdF,CACN,CAOA,iBAAOmU,CAAWxU,EAAGG,GAAI,GACvB,MAAME,EAAI,IAAIL,GACd,OAAOK,EAAEgE,KAAK,CAAC/D,EAAGE,KAChB,MAAMD,EAAID,EAAEmT,KAAKW,cAAc5T,EAAEiT,MACjC,OAAOtT,EAAII,GAAKA,IACdF,CACN,EAEF,MAAMlC,EAAI,MAIR,mBAAOsW,CAAazU,GAClB,IACE,MAAMG,EAAI,CACRuU,MAAO7T,MAAMC,KAAKd,EAAE0U,OACpBC,QAAS9T,MAAMC,KAAKd,EAAE2U,UAExBC,aAAaC,QACX,GAAG5P,KAAK6P,yBACRC,KAAKC,UAAU7U,GAEnB,OAASA,GAET,CACF,CAIA,mBAAO8U,GACL,IACE,MAAMjV,EAAI4U,aAAaM,QAAQ,GAAGjQ,KAAK6P,0BACvC,GAAI9U,EAAG,CACL,MAAMG,EAAI4U,KAAKI,MAAMnV,GACrB,MAAO,CACL0U,MAAO,IAAIV,IAAI7T,EAAEuU,OAAS,IAC1BC,QAAS,IAAIX,IAAI7T,EAAEwU,SAAW,IAElC,CACF,OAAS3U,GAET,CACA,MAAO,CAAE0U,MAAuB,IAAIV,IAAOW,QAAyB,IAAIX,IAC1E,CAIA,oBAAOoB,GACL,IACER,aAAaS,WAAW,GAAGpQ,KAAK6P,yBAClC,OAAS9U,GAET,CACF,CAIA,kBAAOsV,CAAYtV,GACjB,IACE,MAAMG,EAAI,CACRoV,aAAc1U,MAAMC,KAAKd,EAAEuV,cAC3BC,oBAAqB3U,MAAMC,KAAKd,EAAEwV,qBAClCC,YAAazV,EAAEyV,aAEjBb,aAAaC,QACX,GAAG5P,KAAK6P,wBACRC,KAAKC,UAAU7U,GAEnB,OAASA,GAET,CACF,CAIA,kBAAOuV,GACL,IACE,MAAM1V,EAAI4U,aAAaM,QAAQ,GAAGjQ,KAAK6P,yBACvC,GAAI9U,EAAG,CACL,MAAMG,EAAI4U,KAAKI,MAAMnV,GACrB,MAAO,CACLuV,aAAc,IAAIvB,IAAI7T,EAAEoV,cAAgB,IACxCC,oBAAqB,IAAIxB,IAAI7T,EAAEqV,qBAAuB,CAAC,IACvDC,YAAatV,EAAEsV,aAAe,GAElC,CACF,OAASzV,GAET,CACA,MAAO,CACLuV,iBAAkCvB,IAClCwB,oBAAqC,IAAIxB,IAAI,CAAC,IAC9CyB,YAAa,GAEjB,CAIA,oBAAOE,CAAc3V,GACnB,IACE4U,aAAaC,QACX,GAAG5P,KAAK6P,0BACRC,KAAKC,UAAUhV,GAEnB,OAASG,GAET,CACF,CAIA,oBAAOyV,GACL,IACE,MAAM5V,EAAI4U,aAAaM,QAAQ,GAAGjQ,KAAK6P,2BACvC,GAAI9U,EACF,OAAO+U,KAAKI,MAAMnV,EACtB,OAASA,GAET,CACA,MAAO,CACL6V,SAAU,SACVC,YAAa,OACbC,WAAY,eACZC,cAAe,MACfC,kBAAmB,kBACnBC,iBAAkB,kBAEtB,CAIA,mBAAOC,CAAanW,GAClB,MAAMG,EAAI8E,KAAK2Q,gBACfzV,EAAE0V,SAAW7V,EAAGiF,KAAK0Q,cAAcxV,EACrC,CAIA,sBAAOiW,CAAgBpW,GACrB,MAAMG,EAAI8E,KAAK2Q,gBACfzV,EAAE2V,YAAc9V,EAAGiF,KAAK0Q,cAAcxV,EACxC,CAIA,4BAAOkW,CAAsBrW,GAC3B,MAAMG,EAAI8E,KAAK2Q,gBACfzV,EAAE8V,kBAAoBjW,EAAGiF,KAAK0Q,cAAcxV,EAC9C,CAIA,2BAAOmW,CAAqBtW,GAC1B,MAAMG,EAAI8E,KAAK2Q,gBACfzV,EAAE+V,iBAAmBlW,EAAGiF,KAAK0Q,cAAcxV,EAC7C,CAIA,oBAAOoW,CAAcvW,EAAGG,GACtB,MAAME,EAAI4E,KAAK2Q,gBACfvV,EAAE0V,WAAa/V,EAAGK,EAAE2V,cAAgB7V,EAAG8E,KAAK0Q,cAActV,EAC5D,GAEFlC,EAAE2W,eAAiB,iBAChB,IAAC7W,EAAIE;;;;;kBAMR;MAAME,EASJ,WAAA2G,CAAYhF,EAAGG,EAAGE,EAAGC,GACnB2E,KAAKuR,QAAUxW,EAAGiF,KAAKwR,MAAQtW,EAAG8E,KAAKyR,cAAgB,IAAKrW,GAAK4E,KAAK0R,cAAgB,IAAKtW,GAAK4E,KAAK0F,UAAYrK,CACnH,CAMA,IAAAsW,CAAK5W;;AAEH,MAAMG,EAAI8E,KAAKwR,MAAMnV,OAAQhB,GAAMA,EAAEuW,QAAQlD,SAAS3T,IAAIqE,KAAK,CAAC/D,EAAGE,IAAMF,EAAEwW,SAAWtW,EAAEsW,UAElFzW,EAAI4E,KAAK8R,kBAAkB5W;;;AAEjC6W,SAASC,KAAKC,mBAAmB,YAAa7W;;AAE9C4E,KAAKkS,qBAAqBhX,EAC5B,CAOA,iBAAA4W,CAAkB/W;;AAEhB,OAAIiF,KAAKuR,QAAQ7C,SAAS,aAEjB,oDACgC1O,KAAKuR,wIAIzCxW,EAAEF,IAAKO,GAAM4E,KAAKmS,wBAAwB/W,IAAIY,KAAK,kGAGvCgE,KAAKuR,sFACLvR,KAAKuR,iHAOb,oCACgBvR,KAAKuR,kJAIbvR,KAAKuR,wHAGjBxW,EAAEF,IAAKO,GAAM4E,KAAKmS,wBAAwB/W,IAAIY,KAAK,8FAGvCgE,KAAKuR,yEACLvR,KAAKuR,6GAMxB,CAOA,uBAAAY,CAAwBpX,GACtB,MAAMG,EAAI8E,KAAKyR,cAAc1W,EAAEqX,KAC/B,OAAQrX,EAAEsX,WACR,IAAK,SACH,MAAO,mEAEKrS,KAAKuR,WAAWxW,EAAEqX,QAAQrX,EAAEuX,uDACftS,KAAKuR,WAAWxW,EAAEqX,4BACrCrX,EAAEgE,aAAahE,EAAEoD,cAAcpD,EAAEwX,MAAQ,4BACvCrX,gBAAgBH,EAAEqX,oCAG5B,IAAK,oBACH,MAAO,mEAEKpS,KAAKuR,WAAWxW,EAAEqX,cAAcrX,EAAEuX,sDACtBtS,KAAKuR,WAAWxW,EAAEqX,kCACpCrX,EAAEgE,aAAahE,EAAEoD,cAAcpD,EAAEwX,MAAQ,4BACvCrX,gBAAgBH,EAAEqX,+CACDpS,KAAKuR,WAAWxW,EAAEqX,mCACrCrX,EAAEgE,aAAahE,EAAEoD,cAAcpD,EAAEwX,MAAQ,4BACvCrX,gBAAgBH,EAAEqX,sBAC1BrX,EAAEyX,KAAO,SAASzX,EAAEyX,cAAgB,iCAGtC,IAAK,SACH,MAAO,6DAEDzX,EAAEuX,yCACItS,KAAKuR,WAAWxW,EAAEqX,eAAerX,EAAE0X,aAAe,kBAAkB1X,EAAE2X,YAAc,4CAGlG,IAAK,WACH,MAAO,yGAGqB1S,KAAKuR,WAAWxW,EAAEqX,mCAClCrX,EAAEqX,QAAQlX,EAAI,UAAY,sBACrCH,EAAEuX,0DAIL,IAAK,SACH,MAAO,mEAEKtS,KAAKuR,WAAWxW,EAAEqX,QAAQrX,EAAEuX,0CAC5BtS,KAAKuR,WAAWxW,EAAEqX,kBAAkBrX,EAAEqX,yBAChDrX,EAAE4X,SAAW,IAAI9X,IAAKQ,GAAM,oCACbA,EAAEyH,UAAU5H,IAAMG,EAAEyH,MAAQ,WAAa,MAAMzH,EAAEiX,kCAChEtW,KAAK,yDAIT,IAAK,aACH,MAAMZ,EAAgB,iBAALF,EAAgBA,EAAE6P,QAAQ,OAAQ,IAAM7P,EACzD,MAAO,mEAEK8E,KAAKuR,WAAWxW,EAAEqX,QAAQrX,EAAEuX,qDACjBtS,KAAKuR,WAAWxW,EAAEqX,uDACjChX,kDAAkDL,EAAEqX,sBAC5DrX,EAAE6X,KAAO,0BAA0B7X,EAAE6X,cAAgB,iCAGvD,QACE,MAAO,GAEb,CAMA,oBAAAV,CAAqBnX,GACnB,MAAMG,EAAI6W,SAASc,eAAe7S,KAAKuR,SAClCrW;;AAELH,EAAEiU,QAAS1T,IACT,GAAoB,sBAAhBA,EAAE+W,UAAmC;;AAEvC,MAAMjW,EAAI2V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,aAAcnW,EAAI8V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,cACtHhW,GAAG0W,iBAAiB,QAAS,KAC3B7W,EAAE6G,MAAQ1G,EAAE0G,MAAO9C,KAAKyR,cAAcnW,EAAE8W,KAAOW,WAAW3W,EAAE0G,SAC1D7G,GAAG6W,iBAAiB,QAAS,KAC/B1W,EAAE0G,MAAQ7G,EAAE6G,MAAO9C,KAAKyR,cAAcnW,EAAE8W,KAAOW,WAAW9W,EAAE6G,QAEhE,MAAA,GAA2B,WAAhBxH,EAAE+W,UAAwB,CACnC,MAAMjW,EAAI2V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,OACvDhW,GAAG0W,iBAAiB,QAAS,KAC3B9S,KAAKyR,cAAcnW,EAAE8W,KAAOW,WAAW3W,EAAE0G,QAE7C,SAA2B,WAAhBxH,EAAE+W,WAAoC,aAAV/W,EAAE8W;;AAEvCL,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,QAAQU,iBAAiB,QAAS,KAC7E9S,KAAK0F,UAAUsN,sBAEnB,GAA2B,aAAhB1X,EAAE+W,UAA0B,CACrC,MAAMjW,EAAI2V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,OACvDhW,GAAG0W,iBAAiB,SAAU,KAC5B9S,KAAKyR,cAAcnW,EAAE8W,KAAOhW,EAAE6W,SAElC,MAAA,GAA2B,WAAhB3X,EAAE+W,UAAwB,CACnC,MAAMjW,EAAI2V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,OACvDhW,GAAG0W,iBAAiB,SAAU,KAC5B9S,KAAKyR,cAAcnW,EAAE8W,KAAOhW,EAAE0G,OAElC,MAAA,GAA2B,eAAhBxH,EAAE+W,UAA4B,CACvC,MAAMjW,EAAI2V,SAASc,eAAe,GAAG7S,KAAKuR,WAAWjW,EAAE8W,OACvDhW,GAAG0W,iBAAiB,QAAS,KAC3B1W,EAAE0G,MAAQ,gBAAiB1G,EAAE8W,UAAUjE,IAAI,iBACzC7S,GAAG0W,iBAAiB,UAAY7W,IAClCA,EAAEkX,iBAAkBlX,EAAEmX,kBAAmBpT,KAAKyR,cAAcnW,EAAE8W,KAAOnW,EAAEoX,KAAMjX,EAAE0G,MAAQ7G,EAAEoX,KAAKtI,QAAQ,OAAQ,IAAK3O,EAAE8W,UAAUI,OAAO,gBAE1I;;AAGFvB,SAASc,eAAe,GAAG7S,KAAKuR,iBAAiBuB,iBAAiB,QAAS,KACzE9S,KAAK0F,UAAU6N,OAAOvT,KAAKyR,eAAgBzR,KAAKwT;;AAGlDzB,SAASc,eAAe,GAAG7S,KAAKuR,mBAAmBuB,iBAAiB,QAAS,KAC3E9S,KAAKyR,cAAgB,IAAKzR,KAAK0R,eAAiB1R,KAAK0F,UAAU+N,WAAYzT,KAAKwT;;AAGlFzB,SAASc,eAAe,GAAG7S,KAAKuR,kBAAkBuB,iBAAiB,QAAS,KAC1E9S,KAAKyR,cAAgB,IAAKzR,KAAK0R,eAAiB1R,KAAK0F,UAAU+N,WAAYzT,KAAKwT;;AAGlFtY,EAAE4X,iBAAiB,QAAUxX,IAC3BA,EAAEoY,SAAWxY,IAAM8E,KAAKyR,cAAgB,IAAKzR,KAAK0R,eAAiB1R,KAAK0F,UAAU+N,WAAYzT,KAAKwT,WAEvG,CAIA,KAAAA,GACEzB,SAASc,eAAe7S,KAAKuR,UAAU+B,QACzC,EAEG,MAAC/Y,EAAI;;AAER,CACEqX,QAAS,CAAC,YAAa,OAAQ,iBAAkB,gBACjDC,SAAU,GACVO,IAAK,SACLE,MAAO,KACPD,UAAW,oBACXtT,IAAK,EACLZ,IAAK,IACLoU,KAAM,EACNC,KAAM,KAER,CACEZ,QAAS,CAAC,YAAa,OAAQ,iBAAkB,gBACjDC,SAAU,GACVO,IAAK,YACLE,MAAO,WACPD,UAAW,SACXtT,IAAK,IACLZ,IAAK,KACLoU,KAAM,IAER,CACEX,QAAS,CAAC,YAAa,OAAQ,iBAAkB,gBACjDC,SAAU,GACVO,IAAK,MACLE,MAAO,iBACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM;;AAGR,CACEX,QAAS,CAAC,aACVC,SAAU,EACVO,IAAK,iBACLE,MAAO,aACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM,GAER,CACEX,QAAS,CAAC,aACVC,SAAU,EACVO,IAAK,iBACLE,MAAO,aACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM,GAER,CACEX,QAAS,CAAC,aACVC,SAAU,GACVO,IAAK,YACLE,MAAO,cACPD,UAAW,SACXtT,IAAK,IACLZ,IAAK,IACLoU,KAAM,IAER,CACEX,QAAS,CAAC,aACVC,SAAU,GACVO,IAAK,aACLE,MAAO,cACPD,UAAW,SACXtT,IAAK,IACLZ,IAAK,IACLoU,KAAM,IAER,CACEX,QAAS,CAAC,aACVC,SAAU,GACVO,IAAK,SACLE,MAAO,KACPD,UAAW,oBACXtT,IAAK,EACLZ,IAAK,IACLoU,KAAM,EACNC,KAAM;;AAGR,CACEZ,QAAS,CAAC,YAAa,aACvBC,SAAU,IACVO,IAAK,WACLE,MAAO,QACPD,UAAW,SACXK,WAAY,KACZD,YAAa;;AAGf,CACEb,QAAS,CAAC,QACVC,SAAU,EACVO,IAAK,iBACLE,MAAO,mBACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM,GAER,CACEX,QAAS,CAAC,QACVC,SAAU,EACVO,IAAK,iBACLE,MAAO,mBACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM,GAER,CACEX,QAAS,CAAC,QACVC,SAAU,GACVO,IAAK,mBACLE,MAAO,mBACPD,UAAW,SACXtT,IAAK,GACLZ,IAAK,IACLoU,KAAM,IAER,CACEX,QAAS,CAAC,QACVC,SAAU,GACVO,IAAK,YACLE,MAAO,qBACPD,UAAW,SACXtT,IAAK,EACLZ,IAAK,GACLoU,KAAM,GAER,CACEX,QAAS,CAAC,QACVC,SAAU,GACVO,IAAK,YACLE,MAAO,QACPD,UAAW;;AAGb,CACET,QAAS,CAAC,kBACVC,SAAU,GACVO,IAAK,aACLE,MAAO,YACPD,UAAW,SACXM,QAAS,CACP,CAAE7P,MAAO,IAAKwP,MAAO,YACrB,CAAExP,MAAO,IAAKwP,MAAO,cAGzB,CACEV,QAAS,CAAC,kBACVC,SAAU,GACVO,IAAK,eACLE,MAAO,WACPD,UAAW,SACXM,QAAS,CACP,CAAE7P,MAAO,SAAUwP,MAAO,qBAC1B,CAAExP,MAAO,WAAYwP,MAAO,uBAGhC,CACEV,QAAS,CAAC,kBACVC,SAAU,GACVO,IAAK,cACLE,MAAO,SACPD,UAAW,aACXO,KAAM,eAER,CACEhB,QAAS,CAAC,kBACVC,SAAU,GACVO,IAAK,eACLE,MAAO,SACPD,UAAW,aACXO,KAAM;;AAGR,CACEhB,QAAS,CAAC,gBACVC,SAAU,GACVO,IAAK,UACLE,MAAO,SACPD,UAAW,aACXO,KAAM"}