<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CW略語・Q符号学習 - モールス練習アプリ v4</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class o{constructor(){this.entries=[],this.filteredEntries=[],this.selectedTags=new Set,this.displayMode="card",this.loadData()}async loadData(){try{const t=await(await fetch("./flashcard.tsv")).text();this.entries=t.trim().split(`
`).slice(1).map(i=>{const[s,r,n,d,l]=i.split("	");return{tags:s,frequency:parseInt(r),abbreviation:n,english:d,japanese:l}}),this.filteredEntries=[...this.entries],this.render()}catch(e){console.error("データ読み込みエラー:",e),this.renderError()}}getAllTags(){const e=new Set;return this.entries.forEach(t=>{t.tags.split(",").forEach(i=>e.add(i.trim()))}),Array.from(e).sort()}filterByTags(){this.selectedTags.size===0?this.filteredEntries=[...this.entries]:this.filteredEntries=this.entries.filter(e=>{const t=e.tags.split(",").map(i=>i.trim());return Array.from(this.selectedTags).some(i=>t.includes(i))}),this.renderEntries()}toggleTag(e){this.selectedTags.has(e)?this.selectedTags.delete(e):this.selectedTags.add(e),this.filterByTags(),this.renderTags()}toggleDisplayMode(){this.displayMode=this.displayMode==="card"?"list":"card",this.renderEntries(),this.renderModeToggle()}render(){const e=document.getElementById("app");if(!e)return;e.innerHTML=`
      <div class="container">
        <header class="header">
          <button id="backBtn" class="back-btn">← 戻る</button>
          <h1>CW略語・Q符号</h1>
          <div class="mode-toggle" id="modeToggle"></div>
        </header>

        <div class="tags-container" id="tagsContainer"></div>

        <div class="entries-container" id="entriesContainer"></div>
      </div>
    `;const t=document.getElementById("backBtn");t&&t.addEventListener("click",()=>{window.location.href="./index.html"}),this.renderModeToggle(),this.renderTags(),this.renderEntries()}renderModeToggle(){const e=document.getElementById("modeToggle");if(!e)return;e.innerHTML=`
      <button id="toggleModeBtn" class="toggle-mode-btn" title="表示モード切り替え">
        ${this.displayMode==="card"?"📋 リスト表示":"🃏 カード表示"}
      </button>
    `;const t=document.getElementById("toggleModeBtn");t&&t.addEventListener("click",()=>this.toggleDisplayMode())}renderTags(){const e=document.getElementById("tagsContainer");if(!e)return;const t=this.getAllTags();e.innerHTML=`
      <h2>タグでフィルター</h2>
      <div class="tags-list">
        ${t.map(i=>`
          <button class="tag-btn ${this.selectedTags.has(i)?"active":""}" data-tag="${i}">
            ${i}
          </button>
        `).join("")}
      </div>
    `,e.querySelectorAll(".tag-btn").forEach(i=>{i.addEventListener("click",()=>{const s=i.getAttribute("data-tag");s&&this.toggleTag(s)})})}getFrequencyStars(e){return"★".repeat(e)+"☆".repeat(5-e)}renderEntries(){const e=document.getElementById("entriesContainer");e&&(this.displayMode==="card"?this.renderCardView(e):this.renderListView(e))}renderCardView(e){e.innerHTML=`
      <h2>略語一覧（${this.filteredEntries.length}件）</h2>
      <div class="entries-list">
        ${this.filteredEntries.map(t=>`
          <div class="entry-card">
            <div class="entry-header">
              <div class="entry-abbr">${t.abbreviation}</div>
              <div class="entry-frequency" title="使用頻度: ${t.frequency}/5">${this.getFrequencyStars(t.frequency)}</div>
            </div>
            <div class="entry-english">${t.english}</div>
            <div class="entry-japanese">${t.japanese}</div>
            <div class="entry-tags">${t.tags}</div>
          </div>
        `).join("")}
      </div>
    `}renderListView(e){e.innerHTML=`
      <h2>略語一覧（${this.filteredEntries.length}件）</h2>
      <div class="list-table-container">
        <table class="list-table">
          <thead>
            <tr>
              <th>頻度</th>
              <th>略語</th>
              <th>英文</th>
              <th>和訳</th>
              <th>タグ</th>
            </tr>
          </thead>
          <tbody>
            ${this.filteredEntries.map(t=>`
              <tr>
                <td class="list-frequency" title="使用頻度: ${t.frequency}/5">${this.getFrequencyStars(t.frequency)}</td>
                <td class="list-abbr">${t.abbreviation}</td>
                <td class="list-english">${t.english}</td>
                <td class="list-japanese">${t.japanese}</td>
                <td class="list-tags">${t.tags}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </div>
    `}renderError(){const e=document.getElementById("app");e&&(e.innerHTML=`
      <div class="container">
        <header class="header">
          <button onclick="window.location.href='./index.html'" class="back-btn">← 戻る</button>
          <h1>CW略語・Q符号</h1>
        </header>
        <div class="error">
          データの読み込みに失敗しました。flashcard.tsvを確認してください。
        </div>
      </div>
    `)}}document.addEventListener("DOMContentLoaded",()=>{new o});</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px}.container{max-width:1200px;margin:0 auto}.header{display:flex;align-items:center;gap:20px;margin-bottom:30px;color:#fff}.back-btn{background:#fff3;border:none;color:#fff;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:1rem;transition:background .3s}.back-btn:hover{background:#ffffff4d}.header h1{font-size:2rem;flex:1}.mode-toggle{margin-left:auto}.toggle-mode-btn{background:#fff3;border:none;color:#fff;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:1rem;transition:background .3s}.toggle-mode-btn:hover{background:#ffffff4d}.tags-container{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px}.tags-container h2{font-size:1.2rem;color:#667eea;margin-bottom:15px}.tags-list{display:flex;flex-wrap:wrap;gap:10px}.tag-btn{background:#f0f0f0;border:2px solid transparent;color:#667eea;padding:8px 16px;border-radius:20px;cursor:pointer;font-size:.9rem;transition:all .3s}.tag-btn:hover{background:#e0e0e0}.tag-btn.active{background:#667eea;color:#fff;border-color:#667eea}.entries-container{background:#fff;border-radius:12px;padding:20px}.entries-container h2{font-size:1.2rem;color:#667eea;margin-bottom:15px}.entries-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px}.entry-card{background:#f9f9f9;border-radius:8px;padding:15px;transition:transform .2s,box-shadow .2s}.entry-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.entry-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.entry-abbr{font-size:1.3rem;font-weight:700;color:#667eea}.entry-frequency{font-size:1rem;color:orange;-webkit-user-select:none;user-select:none}.entry-english{font-size:.95rem;color:#666;margin-bottom:5px}.entry-japanese{font-size:1rem;color:#333;margin-bottom:10px}.entry-tags{font-size:.85rem;color:#999;font-style:italic}.error{background:#fff;border-radius:12px;padding:40px;text-align:center;color:#d32f2f;font-size:1.1rem}.list-table-container{overflow-x:auto}.list-table{width:100%;border-collapse:collapse;background:#fff}.list-table thead{background:#667eea;color:#fff}.list-table th{padding:12px;text-align:left;font-weight:600;white-space:nowrap}.list-table tbody tr{border-bottom:1px solid #e0e0e0;transition:background .2s}.list-table tbody tr:hover{background:#f5f5f5}.list-table td{padding:10px 12px}.list-frequency{color:orange;font-size:.9rem;white-space:nowrap;text-align:center;-webkit-user-select:none;user-select:none}.list-abbr{font-weight:700;color:#667eea;white-space:nowrap}.list-english{color:#666;min-width:150px}.list-japanese{color:#333;min-width:150px}.list-tags{color:#999;font-size:.85rem;font-style:italic}@media (max-width: 768px){.header h1{font-size:1.5rem}.entries-list{grid-template-columns:1fr}.toggle-mode-btn{font-size:.9rem;padding:8px 12px}.list-table{font-size:.9rem}.list-table th,.list-table td{padding:8px}}</style>
</head>
<body>
  <div id="app"></div>
</body>
</html>
