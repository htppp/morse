<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>横振り電鍵練習 - モールス練習アプリ v4</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();class v{constructor(e={frequency:750,volume:.7,wpm:20}){this.audioContext=null,this.currentOscillator=null,this.currentGain=null,this.isPlaying=!1,this.settings=e,this.loadSettings(),this.init()}ensureAudioContext(){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&this.audioContext.resume()}init(){const e=()=>{this.ensureAudioContext()};document.addEventListener("click",e,{once:!0}),document.addEventListener("keydown",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})}updateSettings(e){this.settings={...this.settings,...e}}scheduleTone(e,t){if(this.ensureAudioContext(),!!this.audioContext)try{const s=this.audioContext.createOscillator(),i=this.audioContext.createGain();s.connect(i),i.connect(this.audioContext.destination),s.frequency.value=this.settings.frequency,s.type="sine";const a=this.audioContext.currentTime,o=Math.max(a,e);i.gain.setValueAtTime(0,o),i.gain.linearRampToValueAtTime(this.settings.volume,o+.001),i.gain.setValueAtTime(this.settings.volume,o+(t-1)/1e3),i.gain.linearRampToValueAtTime(0,o+t/1e3),s.start(o),s.stop(o+t/1e3)}catch(s){console.error("音声エラー:",s)}}startContinuousTone(){if(this.ensureAudioContext(),!!this.audioContext)try{this.stopContinuousTone();const e=this.audioContext.createOscillator(),t=this.audioContext.createGain();e.connect(t),t.connect(this.audioContext.destination),e.frequency.value=this.settings.frequency,e.type="sine";const s=this.audioContext.currentTime;t.gain.setValueAtTime(0,s),t.gain.linearRampToValueAtTime(this.settings.volume,s+.001),e.start(s),this.currentOscillator=e,this.currentGain=t}catch(e){console.error("連続音開始エラー:",e)}}stopContinuousTone(){if(this.audioContext)try{if(this.currentOscillator&&this.currentGain){const e=this.audioContext.currentTime;this.currentGain.gain.cancelScheduledValues(e),this.currentGain.gain.setValueAtTime(this.currentGain.gain.value,e),this.currentGain.gain.linearRampToValueAtTime(0,e+.001),this.currentOscillator.stop(e+.002),this.currentOscillator=null,this.currentGain=null}}catch(e){console.error("連続音停止エラー:",e)}}async playMorseString(e){if(this.isPlaying||!e||(this.ensureAudioContext(),!this.audioContext))return!1;this.isPlaying=!0;const s=1200/(this.settings.wpm||20),i=s,a=3*s,o=s,l=3*s,c=7*s;let n=this.audioContext.currentTime+.02;for(let m=0;m<e.length&&this.isPlaying;m++){const p=e[m];p==="."?(this.scheduleTone(n,i),n+=(i+o)/1e3):p==="-"?(this.scheduleTone(n,a),n+=(a+o)/1e3):p===" "?n+=(l-o)/1e3:p==="/"&&(n+=(c-o)/1e3)}const r=(n-this.audioContext.currentTime)*1e3;await new Promise(m=>setTimeout(m,r));const f=this.isPlaying;return this.isPlaying=!1,f}stopPlaying(){this.isPlaying=!1}getAudioContext(){return this.audioContext}getVolume(){return this.settings.volume}setVolume(e){this.settings.volume=Math.max(0,Math.min(1,e))}getFrequency(){return this.settings.frequency}setFrequency(e){this.settings.frequency=Math.max(400,Math.min(1200,e))}getWPM(){return this.settings.wpm||20}setWPM(e){this.settings.wpm=Math.max(5,Math.min(40,e))}saveSettings(){try{localStorage.setItem("v4.audio.settings",JSON.stringify(this.settings))}catch(e){console.error("設定保存エラー:",e)}}loadSettings(){try{const e=localStorage.getItem("v4.audio.settings");e&&(this.settings={...this.settings,...JSON.parse(e)})}catch(e){console.error("設定読み込みエラー:",e)}}}const u={A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",I:"..",J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",Q:"--.-",R:".-.",S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",Y:"-.--",Z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----."," ":"/",".":".-.-.-",",":"--..--",":":"---...","?":"..--..",_:"..--.-","+":".-.-.","-":"-....-","×":"-..-","^":"......","/":"-..-.","@":".--.-.","(":"-.--.",")":"-.--.-",'"':".-..-.","'":".----.","=":"-...-"},y=Object.fromEntries(Object.entries(u).map(([h,e])=>[e,h]));class L{static textToMorse(e){const t=e.toUpperCase(),s=/\[([A-Z]+)\]/g,i=[];let a=0,o;for(;(o=s.exec(t))!==null;){if(o.index>a){const n=t.substring(a,o.index),r=Array.from(n).map(f=>u[f]||f);i.push(r.join(" "))}const c=Array.from(o[1]).map(n=>u[n]||n);i.push(c.join("")),a=s.lastIndex}if(a<t.length){const l=t.substring(a),c=Array.from(l).map(n=>u[n]||n);i.push(c.join(" "))}return i.filter(l=>l).join(" ")}static morseSequencesToText(e){let t="";for(const s of e)s==="/"?t+=" ":s&&s!==""&&(t+=y[s]||"?");return t}static getMorseMap(){return u}static charToMorse(e){return u[e.toUpperCase()]}}const g=class g{static get(e){return this.settings[e]}static set(e,t){this.settings[e]=t,this.save()}static load(){try{const e=localStorage.getItem("v4.settings");e&&(this.settings={...this.defaultSettings,...JSON.parse(e)})}catch(e){console.error("Failed to load settings:",e)}}static save(){try{localStorage.setItem("v4.settings",JSON.stringify(this.settings))}catch(e){console.error("Failed to save settings:",e)}}static getAll(){return{...this.settings}}};g.defaultSettings={volume:.7,frequency:750,wpm:20,iambicMode:"B",paddleLayout:"normal"},g.settings={...g.defaultSettings};let d=g;class w{constructor(){this.leftDown=!1,this.rightDown=!1,this.buffer="",this.sequence="",this.charTimer=null,this.wordTimer=null,this.sending=!1,this.lastSent=null,this.lastInputTime=0,this.dotReqCount=0,this.dashReqCount=0,this.forceNextElement=null,this.isSqueezing=!1,this.squeezeOccurred=!1,this.squeezeDetected=!1,this.savedSettings=null,d.load();const e=d.getAll();this.audioSystem=new v({frequency:e.frequency,volume:e.volume,wpm:e.wpm}),this.render(),this.setupEventListeners(),this.setupSettingsModal(),this.updatePaddleLayout()}getTimings(){const e=1200/d.get("wpm");return{dot:e,dash:e*3,charGap:e*4,wordGap:e*7}}clearTimers(){this.charTimer!==null&&(clearTimeout(this.charTimer),this.charTimer=null),this.wordTimer!==null&&(clearTimeout(this.wordTimer),this.wordTimer=null)}setTimers(){this.clearTimers();const e=this.getTimings();this.charTimer=window.setTimeout(()=>{this.sequence&&(this.buffer+=this.sequence+" ",this.sequence="",this.updateDisplay())},e.charGap),this.wordTimer=window.setTimeout(()=>{this.sequence&&(this.buffer+=this.sequence+" ",this.sequence=""),this.buffer.endsWith("/ ")||(this.buffer+="/ "),this.updateDisplay()},e.wordGap)}sendPaddleElement(e){if(this.sending)return;this.sending=!0,this.clearTimers(),this.leftDown&&this.rightDown&&(this.squeezeDetected=!1);const t=1200/d.get("wpm"),s=e==="."?t:t*3;this.audioSystem.scheduleTone(0,s),this.sequence+=e,this.lastInputTime=Date.now(),this.updateDisplay(),this.lastSent=e,setTimeout(()=>{const i=d.get("iambicMode"),a=this.leftDown&&this.rightDown;i==="B"&&this.squeezeDetected&&!this.forceNextElement&&(e==="."?this.forceNextElement="-":e==="-"&&(this.forceNextElement=".")),a&&!this.forceNextElement&&(e==="."?this.forceNextElement="-":e==="-"&&(this.forceNextElement="."))},s-5),setTimeout(()=>{if(this.sending=!1,!this.leftDown){const i=document.getElementById("paddleLeft");i&&i.classList.remove("active")}if(!this.rightDown){const i=document.getElementById("paddleRight");i&&i.classList.remove("active")}this.updateSqueezeIndicator(),this.forceNextElement?this.scheduleNext():this.leftDown||this.rightDown?this.scheduleNext():this.setTimers()},s+t)}scheduleNext(){const t=d.get("paddleLayout")==="reversed";if(this.forceNextElement){const s=this.forceNextElement;this.forceNextElement=null,this.sendPaddleElement(s)}else if(this.leftDown&&this.rightDown){const s=this.lastSent==="."?"-":".";this.sendPaddleElement(s)}else if(this.leftDown){const s=t?"-":".";this.sendPaddleElement(s)}else if(this.rightDown){const s=t?".":"-";this.sendPaddleElement(s)}}updateSqueezeIndicator(){const e=this.leftDown&&this.rightDown;this.isSqueezing=e;const t=document.getElementById("squeezeIndicator");t&&(e?(t.classList.add("active"),this.squeezeOccurred=!0):t.classList.remove("active"))}onLeftDown(){const e=d.get("iambicMode");this.leftDown=!0;const t=document.getElementById("paddleLeft");if(t&&t.classList.add("active"),this.updateSqueezeIndicator(),e==="B"&&this.sending&&this.rightDown){const s=d.get("paddleLayout");this.forceNextElement=s==="reversed"?"-":".",this.squeezeDetected=!0}if(!this.sending){const i=d.get("paddleLayout")==="reversed"?"-":".";this.sendPaddleElement(i)}}onRightDown(){const e=d.get("iambicMode");this.rightDown=!0;const t=document.getElementById("paddleRight");if(t&&t.classList.add("active"),this.updateSqueezeIndicator(),e==="B"&&this.sending&&this.leftDown){const s=d.get("paddleLayout");this.forceNextElement=s==="reversed"?".":"-",this.squeezeDetected=!0}if(!this.sending){const i=d.get("paddleLayout")==="reversed"?".":"-";this.sendPaddleElement(i)}}onLeftUp(){this.leftDown=!1,this.dashReqCount=0;const e=document.getElementById("paddleLeft");e&&e.classList.remove("active"),this.updateSqueezeIndicator(),d.get("iambicMode")==="B"&&this.isSqueezing&&this.rightDown&&!this.sending&&setTimeout(()=>{if(this.rightDown&&!this.sending){const i=d.get("paddleLayout")==="reversed"?".":"-";this.sendPaddleElement(i)}},10)}onRightUp(){this.rightDown=!1,this.dotReqCount=0;const e=document.getElementById("paddleRight");e&&e.classList.remove("active"),this.updateSqueezeIndicator();const t=d.get("iambicMode");if(t==="B"&&this.isSqueezing&&this.leftDown&&!this.sending&&setTimeout(()=>{if(this.leftDown&&!this.sending){const i=d.get("paddleLayout")==="reversed"?"-":".";this.sendPaddleElement(i)}},10),!this.leftDown&&!this.rightDown&&this.squeezeOccurred){if(t==="B"&&this.lastSent==="-")if(this.sending)this.dotReqCount++;else{const i=d.get("paddleLayout")==="reversed"?"-":".";this.sendPaddleElement(i)}this.squeezeOccurred=!1}}updateDisplay(){let e="";this.buffer&&(e=this.buffer.trim()),this.sequence&&(e&&(e+=" "),e+=`[${this.sequence}]`);const t=document.getElementById("paddleMorseDisplay");t&&(t.textContent=e||"入力されたモールス信号"),this.updateDecoded()}updateDecoded(){const e=this.buffer.trim().split(/\s+/),t=L.morseSequencesToText(e),s=document.getElementById("paddleDecoded");s&&(s.textContent=t||"解読された文字")}clear(){this.buffer="",this.sequence="",this.clearTimers(),this.updateDisplay()}updatePaddleLayout(){const e=d.get("paddleLayout"),t=document.getElementById("paddleLeft"),s=document.getElementById("paddleRight");!t||!s||(e==="reversed"?(t.innerHTML='<div class="paddle-label">左<br>（長点）</div>',s.innerHTML='<div class="paddle-label">右<br>（短点）</div>'):(t.innerHTML='<div class="paddle-label">左<br>（短点）</div>',s.innerHTML='<div class="paddle-label">右<br>（長点）</div>'))}setupEventListeners(){let e=!1,t=!1,s=!1,i=!1;const a=document.getElementById("paddleLeft");a&&(a.addEventListener("mousedown",n=>{n.preventDefault(),e||(e=!0,this.onLeftDown())}),a.addEventListener("mouseup",n=>{n.preventDefault(),e&&(e=!1,this.onLeftUp())}),a.addEventListener("touchstart",n=>{n.preventDefault(),s||(s=!0,this.onLeftDown())},{passive:!1}),a.addEventListener("touchend",n=>{n.preventDefault(),s&&(s=!1,this.onLeftUp())},{passive:!1}));const o=document.getElementById("paddleRight");o&&(o.addEventListener("mousedown",n=>{n.preventDefault(),t||(t=!0,this.onRightDown())}),o.addEventListener("mouseup",n=>{n.preventDefault(),t&&(t=!1,this.onRightUp())}),o.addEventListener("touchstart",n=>{n.preventDefault(),i||(i=!0,this.onRightDown())},{passive:!1}),o.addEventListener("touchend",n=>{n.preventDefault(),i&&(i=!1,this.onRightUp())},{passive:!1})),document.addEventListener("mouseup",()=>{e&&(e=!1,this.onLeftUp()),t&&(t=!1,this.onRightUp())}),document.addEventListener("touchend",()=>{s&&(s=!1,this.onLeftUp()),i&&(i=!1,this.onRightUp())},{passive:!1});const l=document.getElementById("paddleClear");l&&l.addEventListener("click",()=>this.clear());const c=document.getElementById("backBtn");c&&c.addEventListener("click",()=>{window.location.href="./index.html"}),document.addEventListener("keydown",n=>{n.target.tagName==="INPUT"||n.target.tagName==="TEXTAREA"||n.repeat||(n.key==="j"||n.key==="J"?(n.preventDefault(),this.onLeftDown()):(n.key==="k"||n.key==="K")&&(n.preventDefault(),this.onRightDown()))}),document.addEventListener("keyup",n=>{n.target.tagName==="INPUT"||n.target.tagName==="TEXTAREA"||(n.key==="j"||n.key==="J"?(n.preventDefault(),this.onLeftUp()):(n.key==="k"||n.key==="K")&&(n.preventDefault(),this.onRightUp()))})}setupSettingsModal(){const e=document.getElementById("settingsIcon"),t=document.getElementById("settingsModal"),s=document.getElementById("settingsCancel"),i=document.getElementById("settingsOK"),a=document.getElementById("closeSettings");e&&t&&e.addEventListener("click",()=>{this.openSettingsModal()}),s&&t&&s.addEventListener("click",()=>{this.restoreSettings(),t.classList.remove("active")}),i&&t&&i.addEventListener("click",()=>{this.applySettings(),t.classList.remove("active")}),a&&t&&a.addEventListener("click",()=>{this.restoreSettings(),t.classList.remove("active")}),t&&t.addEventListener("click",o=>{o.target===t&&(this.restoreSettings(),t.classList.remove("active"))})}openSettingsModal(){this.savedSettings=d.getAll();const e=d.getAll(),t=document.getElementById("volumeRange"),s=document.getElementById("volumeInput"),i=document.getElementById("frequencyInput"),a=document.getElementById("wpmInput"),o=document.getElementById("iambicMode"),l=document.getElementById("paddleLayout");t&&(t.value=String(e.volume*100)),s&&(s.value=String(Math.round(e.volume*100))),i&&(i.value=String(e.frequency)),a&&(a.value=String(e.wpm)),o&&(o.checked=e.iambicMode==="B"),l&&(l.checked=e.paddleLayout==="reversed");const c=document.getElementById("settingsModal");c&&c.classList.add("active"),t&&s&&(t.oninput=n=>{const r=n.target.value;s.value=r},s.oninput=n=>{const r=n.target.value;t.value=r}),o&&(o.onchange=()=>{this.updateIambicModeStatus()}),l&&(l.onchange=()=>{this.updatePaddleLayoutStatus()}),this.updateIambicModeStatus(),this.updatePaddleLayoutStatus()}restoreSettings(){this.savedSettings&&(d.set("volume",this.savedSettings.volume),d.set("frequency",this.savedSettings.frequency),d.set("wpm",this.savedSettings.wpm),d.set("iambicMode",this.savedSettings.iambicMode),d.set("paddleLayout",this.savedSettings.paddleLayout),this.audioSystem.updateSettings({volume:this.savedSettings.volume,frequency:this.savedSettings.frequency,wpm:this.savedSettings.wpm}),this.updatePaddleLayout(),this.savedSettings=null)}applySettings(){const e=document.getElementById("volumeInput"),t=document.getElementById("frequencyInput"),s=document.getElementById("wpmInput"),i=document.getElementById("iambicMode"),a=document.getElementById("paddleLayout");e&&d.set("volume",parseInt(e.value)/100),t&&d.set("frequency",parseInt(t.value)),s&&d.set("wpm",parseInt(s.value)),i&&d.set("iambicMode",i.checked?"B":"A"),a&&d.set("paddleLayout",a.checked?"reversed":"normal");const o=d.getAll();this.audioSystem.updateSettings({volume:o.volume,frequency:o.frequency,wpm:o.wpm}),this.updatePaddleLayout(),this.savedSettings=null}updateIambicModeStatus(){const e=document.getElementById("iambicMode"),t=document.getElementById("iambicModeStatus");t&&e&&(t.textContent=e.checked?"(現在: Iambic B)":"(現在: Iambic A)")}updatePaddleLayoutStatus(){const e=document.getElementById("paddleLayout"),t=document.getElementById("paddleLayoutStatus");t&&e&&(t.textContent=e.checked?"(現在: 左:長点 / 右:短点)":"(現在: 左:短点 / 右:長点)")}render(){const e=document.getElementById("app");if(!e)return;const t=d.getAll();e.innerHTML=`
      <div class="settings-icon" id="settingsIcon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
        </svg>
      </div>

      <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
          <div class="settings-header">
            <h2>設定</h2>
            <button class="close-btn" id="closeSettings">×</button>
          </div>
          <div class="settings-grid">
            <div class="setting-item">
              <label>音量</label>
              <div class="setting-row">
                <input type="range" id="volumeRange" min="0" max="100" value="${t.volume*100}">
                <input type="number" id="volumeInput" min="0" max="100" value="${Math.round(t.volume*100)}">
                <span>%</span>
              </div>
            </div>
            <div class="setting-item">
              <label>周波数 (Hz)</label>
              <div class="setting-row">
                <input type="number" id="frequencyInput" min="100" max="2000" value="${t.frequency}" step="50">
              </div>
            </div>
            <div class="setting-item">
              <label>WPM (速度)</label>
              <div class="setting-row">
                <input type="number" id="wpmInput" min="1" max="999" value="${t.wpm}">
              </div>
            </div>
            <div class="setting-item">
              <label>Iambic A/B モード <span id="iambicModeStatus">(現在: Iambic ${t.iambicMode})</span></label>
              <div class="setting-row">
                <div class="toggle-switch">
                  <input type="checkbox" id="iambicMode" class="toggle-input" ${t.iambicMode==="B"?"checked":""}>
                  <label for="iambicMode" class="toggle-label">
                    <span class="toggle-switch-handle"></span>
                  </label>
                </div>
              </div>
            </div>
            <div class="setting-item">
              <label>横振りパドル配置 <span id="paddleLayoutStatus">(現在: ${t.paddleLayout==="reversed"?"左:長点 / 右:短点":"左:短点 / 右:長点"})</span></label>
              <div class="setting-row">
                <div class="toggle-switch">
                  <input type="checkbox" id="paddleLayout" class="toggle-input" ${t.paddleLayout==="reversed"?"checked":""}>
                  <label for="paddleLayout" class="toggle-label">
                    <span class="toggle-switch-handle"></span>
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="settings-buttons">
            <button id="settingsCancel" class="btn btn-secondary">キャンセル</button>
            <button id="settingsOK" class="btn">OK</button>
          </div>
        </div>
      </div>

      <div class="container">
        <header class="header">
          <button id="backBtn" class="back-btn">← 戻る</button>
          <h1>横振り電鍵練習</h1>
        </header>

        <div class="paddle-container">
          <button class="paddle-key paddle-left" id="paddleLeft">
            <div class="paddle-label">左<br>（短点）</div>
          </button>
          <button class="paddle-key paddle-right" id="paddleRight">
            <div class="paddle-label">右<br>（長点）</div>
          </button>
        </div>

        <div class="keyboard-hint">
          キーボード: J / K
        </div>

        <div class="squeeze-indicator" id="squeezeIndicator">
          ⚡squeeze⚡
        </div>

        <div class="morse-display" id="paddleMorseDisplay">入力されたモールス信号</div>
        <div class="decoded-output" id="paddleDecoded">解読された文字</div>

        <div style="text-align: center; margin-top: 20px;">
          <button id="paddleClear" class="btn">クリア</button>
        </div>
      </div>
    `}}document.addEventListener("DOMContentLoaded",()=>{new w});</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px}.container{max-width:800px;margin:0 auto}.header{display:flex;align-items:center;gap:20px;margin-bottom:30px;color:#fff}.back-btn{background:#fff3;border:none;color:#fff;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:1rem;transition:background .3s}.back-btn:hover{background:#ffffff4d}.header h1{font-size:2rem}.settings-icon{position:fixed;top:20px;right:20px;width:48px;height:48px;background:#fff3;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s;z-index:100}.settings-icon:hover{background:#ffffff4d;transform:rotate(45deg)}.settings-icon svg{width:28px;height:28px;fill:#fff}.settings-modal{display:none;position:fixed;inset:0;background:#00000080;z-index:200;align-items:center;justify-content:center;padding:20px}.settings-modal.active{display:flex}.settings-content{background:#fff;border-radius:20px;padding:30px;max-width:600px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px #0000004d;scrollbar-width:none;-ms-overflow-style:none}.settings-content::-webkit-scrollbar{display:none}.settings-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:15px;border-bottom:2px solid #e0e0e0}.settings-header h2{font-size:24px;color:#333}.close-btn{background:none;border:none;font-size:32px;cursor:pointer;color:#999;padding:0;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .2s ease}.close-btn:hover{background:#f0f0f0;color:#333}.settings-grid{display:grid;gap:20px}.setting-item{display:flex;flex-direction:column;gap:8px}.setting-item label{font-weight:600;color:#555;font-size:15px}.setting-row{display:flex;align-items:center;gap:10px}.setting-row input[type=range]{flex:1}.setting-row input[type=number]{width:80px;padding:8px;border:2px solid #ddd;border-radius:6px;font-size:1rem;text-align:center}.setting-row input[type=number]:focus{outline:none;border-color:#667eea}.toggle-switch{position:relative;display:inline-block;width:60px;height:30px}.toggle-input{opacity:0;width:0;height:0;position:absolute}.toggle-label{position:absolute;cursor:pointer;inset:0;background:linear-gradient(135deg,#e0e0e0,#f5f5f5);border:2px solid #ddd;border-radius:30px;transition:all .3s ease;box-shadow:inset 0 2px 4px #0000001a,0 2px 8px #0000001a}.toggle-label:hover{border-color:#667eea;box-shadow:inset 0 2px 4px #0000001a,0 2px 12px #667eea33}.toggle-switch-handle{position:absolute;content:"";height:22px;width:22px;left:2px;top:2px;background:linear-gradient(135deg,#fff,#f8f8f8);border-radius:50%;transition:all .3s ease;box-shadow:0 2px 6px #0003,0 1px 3px #0000001a}.toggle-input:checked+.toggle-label{background:linear-gradient(135deg,#667eea,#764ba2);border-color:#667eea;box-shadow:inset 0 2px 4px #0000001a,0 2px 12px #667eea66}.toggle-input:checked+.toggle-label .toggle-switch-handle{transform:translate(30px);background:linear-gradient(135deg,#fff,#f0f8ff);box-shadow:0 2px 8px #0000004d,0 1px 4px #0003}.toggle-input:focus+.toggle-label{outline:2px solid #667eea;outline-offset:2px}.toggle-label:active .toggle-switch-handle{width:26px}.toggle-input:checked+.toggle-label:active .toggle-switch-handle{transform:translate(26px)}.settings-buttons{display:flex;justify-content:center;gap:15px;margin-top:25px}.btn{background:linear-gradient(135deg,#667eea,#764ba2);border:none;color:#fff;padding:12px 30px;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:600;transition:background .3s,transform .1s;box-shadow:0 4px 15px #667eea66;min-width:120px}.btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px #667eea99}.btn:active{transform:scale(.98)}.btn-secondary{background:linear-gradient(135deg,#888,#666);color:#fff;box-shadow:0 4px 15px #8886}.btn-secondary:hover{box-shadow:0 6px 20px #8889}.paddle-container{display:flex;justify-content:center;gap:30px;margin:30px auto}.paddle-key{font-size:22px;font-weight:700;padding:40px 50px;color:#fff;border:none;border-radius:15px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-touch-callout:none;min-width:140px;min-height:170px;box-shadow:0 8px 25px #0000004d;transition:all .2s ease;cursor:pointer}.paddle-left{background:linear-gradient(135deg,#4facfe,#00f2fe)}.paddle-left:hover{transform:translateY(-5px)}.paddle-left:active,.paddle-left.active{transform:scale(.95)}.paddle-right{background:linear-gradient(135deg,#fa709a,#fee140)}.paddle-right:hover{transform:translateY(-5px)}.paddle-right:active,.paddle-right.active{transform:scale(.95)}.paddle-label{text-align:center;font-size:1.2rem;font-weight:700;color:#fff}.keyboard-hint{text-align:center;font-size:14px;color:#fff;margin-top:15px;font-style:italic;background:#fff3;padding:10px;border-radius:6px;margin-bottom:15px}.squeeze-indicator{text-align:center;margin-top:15px;margin-bottom:15px;font-size:16px;font-weight:700;color:#ff6b00;opacity:0;transition:opacity .2s;background:#fff3cde6;padding:10px;border-radius:6px}.squeeze-indicator.active{opacity:1}.morse-display{font-family:Courier New,monospace;font-size:18px;background:#fff;padding:20px;border-radius:8px;min-height:60px;word-wrap:break-word;letter-spacing:2px;border:2px solid #e0e0e0;margin-bottom:15px}.decoded-output{background:#fff;padding:20px;border-radius:8px;min-height:50px;font-weight:700;font-size:18px;border:2px solid #e0e0e0;color:#333;margin-bottom:15px}@media (max-width: 768px){.header h1{font-size:1.5rem}.paddle-key{min-width:120px;min-height:150px;padding:30px 40px}.paddle-label{font-size:1rem}}</style>
</head>
<body>
  <div id="app"></div>
</body>
</html>
