import{x as t,W as e,k as n,w as s,P as a,F as i,Y as r,$ as o,B as c,K as l,I as d,M as u,N as h,G as p}from"./morse-engine-BvEruZ3O.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const m=["ja","en"],g="morse-app-language",v={ja:{common:{appName:"„É¢„Éº„É´„ÇπÁ∑¥Áøí„Ç¢„Éó„É™",version:"v12 - Â§öË®ÄË™ûÂØæÂøúÁâà",backToMenu:"„É°„Éã„É•„Éº„Å´Êàª„Çã",settings:"Ë®≠ÂÆö",start:"ÈñãÂßã",stop:"ÂÅúÊ≠¢",reset:"„É™„Çª„ÉÉ„Éà",download:"„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ",language:"Ë®ÄË™û",close:"Èñâ„Åò„Çã",save:"‰øùÂ≠ò",cancel:"„Ç≠„É£„É≥„Çª„É´",copyright:"¬© 2025 „É¢„Éº„É´„ÇπÁ∑¥Áøí„Ç¢„Éó„É™"},menu:{title:"„É¢„Éº„É´„ÇπÁ∑¥Áøí„Ç¢„Éó„É™",subtitle:"„É°„Éã„É•„Éº",items:{vertical:{title:"Á∏¶ÊåØ„ÇäÈõªÈçµÁ∑¥Áøí",description:"‰∏ä‰∏ã„Å´Âãï„Åã„ÅôÈõªÈçµÔºà„Çπ„Éà„É¨„Éº„Éà„Ç≠„ÉºÔºâ„ÅÆÁ∑¥Áøí"},horizontal:{title:"Ê®™ÊåØ„ÇäÈõªÈçµÁ∑¥Áøí",description:"Â∑¶Âè≥„Å´Âãï„Åã„ÅôÈõªÈçµÔºà„Éë„Éâ„É´Ôºâ„ÅÆÁ∑¥ÁøíÔºàIambic A/BÂØæÂøúÔºâ"},flashcard:{title:"CWÁï•Ë™û„ÉªQÁ¨¶Âè∑",description:"CWÈÄö‰ø°„Åß‰ΩøÁî®„Åï„Çå„ÇãÁï•Ë™û„Å®QÁ¨¶Âè∑„ÇíÂ≠¶Áøí"},koch:{title:"„Ç≥„ÉÉ„ÉõÊ≥ï„Éà„É¨„Éº„Éã„É≥„Ç∞",description:"ÊÆµÈöéÁöÑ„Å´ÊñáÂ≠ó„ÇíÂ¢ó„ÇÑ„Åó„Å¶Â≠¶Áøí„Åô„ÇãÊñπÂºè"},listening:{title:"„É¢„Éº„É´„Çπ‰ø°Âè∑ËÅû„ÅçÂèñ„ÇäÁ∑¥Áøí",description:"„É©„É≥„ÉÄ„É†QSO„ÇÑËã±Êñá„ÇíËÅû„ÅÑ„Å¶Á∑¥Áøí"}}},verticalKey:{title:"Á∏¶ÊåØ„ÇäÈõªÈçµÁ∑¥Áøí",instructions:"„Çπ„Éö„Éº„Çπ„Ç≠„Éº„Åæ„Åü„ÅØÁîªÈù¢„Çø„ÉÉ„Éó„ÅßÁ∑¥Áøí",keyLabel:"(„ÇØ„É™„ÉÉ„ÇØ/„Çø„ÉÉ„Éó„ÅßÈÄÅ‰ø°)",morseSignal:"„É¢„Éº„É´„Çπ‰ø°Âè∑",morseBufferPlaceholder:"Ôºà„Åì„Åì„Å´„É¢„Éº„É´„ÇπÁ¨¶Âè∑„ÅåË°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ",decodedResult:"„Éá„Ç≥„Éº„ÉâÁµêÊûú",decodedTextPlaceholder:"Ôºà„Åì„Åì„Å´„Éá„Ç≥„Éº„Éâ„Åï„Çå„ÅüÊñáÂ≠ó„ÅåË°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ",currentSpeed:"ÁèæÂú®„ÅÆÈÄüÂ∫¶",keyState:"„Ç≠„ÉºÁä∂ÊÖã",released:"Ëß£Êîæ",pressed:"Êäº‰∏ã‰∏≠",charCount:"ÂÖ•ÂäõÊñáÂ≠óÊï∞",timingEvaluation:"„Çø„Ç§„Éü„É≥„Ç∞Ë©ï‰æ°",latestInput:"ÊúÄÊñ∞„ÅÆÂÖ•Âäõ",waitingForInput:"ÔºàÂÖ•ÂäõÂæÖ„Å°Ôºâ",overallStats:"ÂÖ®‰ΩìÁµ±Ë®à",noStatsData:"ÔºàÁµ±Ë®à„Éá„Éº„Çø„Å™„ÅóÔºâ",ditStats:"Áü≠ÁÇπ („Éª) Áµ±Ë®à",dahStats:"Èï∑ÁÇπ („Éº) Áµ±Ë®à",dit:"Áü≠ÁÇπ („Éª)",dah:"Èï∑ÁÇπ („Éº)",noData:"Ôºà„Éá„Éº„Çø„Å™„ÅóÔºâ",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"„Çπ„Éö„Éº„Çπ„Ç≠„Éº„Åæ„Åü„ÅØÁîªÈù¢„ÅÆ„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„ÅÑ„ÇãÈñì„ÄÅ„É¢„Éº„É´„Çπ‰ø°Âè∑„ÅåÈÄÅ‰ø°„Åï„Çå„Åæ„Åô",instruction2:"Áü≠„ÅèÊäº„Åô„Å®„Äå„Éª„Äç(dit)„ÄÅÈï∑„ÅèÊäº„Åô„Å®„Äå„Éº„Äç(dah)„Å´„Å™„Çä„Åæ„Åô",instruction3:"ÊñáÂ≠óÈñì„ÅØËá™ÂãïÁöÑ„Å´Âà§ÂÆö„Åï„Çå„Åæ„Åô",instruction4:"WPMÔºàWords Per MinuteÔºâ„ÅßÈÄüÂ∫¶„ÇíË™øÊï¥„Åß„Åç„Åæ„Åô",instruction5:"ÁîªÈù¢Âè≥‰∏ä„ÅÆ‚öô„Ç¢„Ç§„Ç≥„É≥„Åã„ÇâÈü≥Èáè„ÉªÂë®Ê≥¢Êï∞„ÉªÈÄüÂ∫¶„ÇíË™øÊï¥„Åß„Åç„Åæ„Åô",instruction6:"Èü≥Â£∞„ÅåÈ≥¥„Çâ„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ‰∏ÄÂ∫¶„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà„Éñ„É©„Ç¶„Ç∂„ÅÆ„Ç™„Éº„Éá„Ç£„Ç™„Éù„É™„Ç∑„ÉºÔºâ",element:"Ë¶ÅÁ¥†:",expected:"ÁêÜË´ñÂÄ§:",actual:"ÂÆüÊ∏¨ÂÄ§:",accuracy:"Á≤æÂ∫¶:",error:"Ë™§Â∑Æ:",longer:"Èï∑„ÅÑ",shorter:"Áü≠„ÅÑ",perfect:"ÂÆåÁíß",avgAccuracy:"Âπ≥ÂùáÁ≤æÂ∫¶:",maxAccuracy:"ÊúÄÈ´òÁ≤æÂ∫¶:",minAccuracy:"ÊúÄ‰ΩéÁ≤æÂ∫¶:",avgError:"Âπ≥ÂùáË™§Â∑Æ:",count:"ÂõûÊï∞",avgDuration:"Âπ≥ÂùáÈï∑„Åï",inputCount:"ÂÖ•ÂäõÊï∞:",times:"Âõû"},horizontalKey:{title:"Ê®™ÊåØ„ÇäÈõªÈçµÁ∑¥Áøí",instructions:"Â∑¶Âè≥„ÅÆ„Éë„Éâ„É´„ÇíÊìç‰Ωú„Åó„Å¶Á∑¥Áøí",leftPaddle:"Â∑¶„Éë„Éâ„É´ (Áü≠ÁÇπ)",rightPaddle:"Âè≥„Éë„Éâ„É´ (Èï∑ÁÇπ)",dit:"DIT",dah:"DAH",ditLabel:"(Áü≠ÁÇπ)",dahLabel:"(Èï∑ÁÇπ)",jKey:"J „Ç≠„Éº",kKey:"K „Ç≠„Éº",morseSignal:"„É¢„Éº„É´„Çπ‰ø°Âè∑",morseBufferPlaceholder:"Ôºà„Åì„Åì„Å´„É¢„Éº„É´„ÇπÁ¨¶Âè∑„ÅåË°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ",decodedResult:"„Éá„Ç≥„Éº„ÉâÁµêÊûú",decodedTextPlaceholder:"Ôºà„Åì„Åì„Å´„Éá„Ç≥„Éº„Éâ„Åï„Çå„ÅüÊñáÂ≠ó„ÅåË°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ",clear:"„ÇØ„É™„Ç¢",currentSpeed:"ÁèæÂú®„ÅÆÈÄüÂ∫¶",iambicMode:"Iambic„É¢„Éº„Éâ",charCount:"ÂÖ•ÂäõÊñáÂ≠óÊï∞",timingDiagramTitle:"„Çø„Ç§„Éü„É≥„Ç∞Âõ≥ÔºàÁõ¥Ââç„ÅÆ1ÊñáÂ≠óÔºâ",timingDiagramPlaceholder:"ÔºàÊñáÂ≠ó„ÅåÁ¢∫ÂÆö„Åô„Çã„Å®Ë°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ",mode:"„É¢„Éº„Éâ",modeA:"Iambic A",modeB:"Iambic B",spacingEvaluation:"„Çπ„Éö„Éº„Ç∑„É≥„Ç∞Ë©ï‰æ°",avgAccuracy:"Âπ≥ÂùáÁ≤æÂ∫¶",avgError:"Âπ≥ÂùáË™§Â∑Æ",evaluationCount:"Ë©ï‰æ°Êï∞",charSpacing:"ÊñáÂ≠óÈñì",wordSpacing:"ÂçòË™ûÈñì",expected:"ÊúüÂæÖÂÄ§:",accuracy:"Á≤æÂ∫¶:",error:"Ë™§Â∑Æ:",count:"ÂõûÊï∞:",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"Â∑¶„Éë„Éâ„É´ÔºàJÔºâ: Áü≠ÁÇπÔºà„ÉªÔºâ/ Âè≥„Éë„Éâ„É´ÔºàKÔºâ: Èï∑ÁÇπÔºà„ÉºÔºâ",instruction2:"‰∏°ÊñπÂêåÊôÇÊäº„Åó„ÅßËá™Âãï‰∫§‰∫íÈÄÅ‰ø°ÔºàIambicÔºâ",instruction3:"Iambic B„É¢„Éº„Éâ: „Çπ„ÇØ„Ç§„Éº„Ç∫Âæå1Ë¶ÅÁ¥†ËøΩÂä†ÈÄÅ‰ø°",instruction4:"ÁîªÈù¢Âè≥‰∏ä„ÅÆ‚öô„Ç¢„Ç§„Ç≥„É≥„Åã„ÇâË®≠ÂÆöÔºàWPM„ÄÅIambic„É¢„Éº„Éâ„ÄÅ„Éë„Éâ„É´„É¨„Ç§„Ç¢„Ç¶„Éà„ÄÅÈü≥Èáè„ÉªÂë®Ê≥¢Êï∞Ôºâ„ÇíÂ§âÊõ¥„Åß„Åç„Åæ„Åô",timingDiagram:"„Çø„Ç§„Éü„É≥„Ç∞Âõ≥",debugInfo:"„Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±",paddleInput:"„Éë„Éâ„É´ÂÖ•Âäõ",ditInput:"DitÂÖ•Âäõ",dahInput:"DahÂÖ•Âäõ",output:"Âá∫Âäõ",squeezeZone:"„Çπ„ÇØ„Ç§„Éº„Ç∫Âå∫Èñì",gapZone:"ÁÑ°ÂÖ•ÂäõÊúüÈñì",press:"Êäº‰∏ã",release:"Ëß£Êîæ",squeezeOn:"Squeeze ON",squeezeOff:"Squeeze OFF",gapOn:"Gap ON",gapOff:"Gap OFF"},flashcard:{title:"CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí",loading:"„Éï„É©„ÉÉ„Ç∑„É•„Ç´„Éº„Éâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...",loadError:"„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ",error:"„Ç®„É©„Éº:",tabs:{browse:"‰∏ÄË¶ß",learn:"Â≠¶Áøí„É¢„Éº„Éâ",exam:"Ë©¶È®ì„É¢„Éº„Éâ"},filter:{title:"„Éï„Ç£„É´„Çø„ÉºË®≠ÂÆö",tagLabel:"„Çø„Ç∞„ÅßÁµû„ÇäËæº„Åø",frequencyLabel:"‰ΩøÁî®È†ªÂ∫¶„ÅßÁµû„ÇäËæº„ÅøÔºà1=‰ΩéÈ†ªÂ∫¶„ÄÅ5=È´òÈ†ªÂ∫¶Ôºâ",searchLabel:"Ê§úÁ¥¢ÔºàÁï•Ë™û„ÉªÊÑèÂë≥„Éª„Çø„Ç∞Ôºâ",searchPlaceholder:"‰æã: QTH, location, QÁ¨¶Âè∑",filteredCount:"Ë©≤ÂΩì:",totalCount:"ÂÖ®‰Ωì:",items:"‰ª∂"},browse:{entriesHeader:"Áï•Ë™û‰∏ÄË¶ß",entriesCount:"‰ª∂",toggleList:"üìã „É™„Çπ„ÉàË°®Á§∫",toggleCard:"üÉè „Ç´„Éº„ÉâË°®Á§∫",examplePrefix:"‰æã: ",tableHeaders:{abbreviation:"Áï•Ë™û",english:"Ëã±Êñá",japanese:"ÂíåË®≥",frequency:"È†ªÂ∫¶",tags:"„Çø„Ç∞",description:"Ë™¨Êòé",example:"ÂÖ∑‰Ωì‰æã"},howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"„Çø„Ç∞„ÄÅ‰ΩøÁî®È†ªÂ∫¶„ÄÅÊ§úÁ¥¢„ÅßÁï•Ë™û„ÇíÁµû„ÇäËæº„ÇÅ„Åæ„Åô",instruction2:"Áï•Ë™û„Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®„É¢„Éº„É´„Çπ‰ø°Âè∑„ÇíÂÜçÁîü„Åß„Åç„Åæ„Åô",instruction3:"„Ç´„Éº„ÉâË°®Á§∫„Å®„É™„Çπ„ÉàË°®Á§∫„ÇíÂàá„ÇäÊõø„Åà„Çâ„Çå„Åæ„Åô",instruction4:"„ÄåÂ≠¶Áøí„É¢„Éº„Éâ„Äç„Çø„Éñ„Åß„Éï„É©„ÉÉ„Ç∑„É•„Ç´„Éº„ÉâÂ≠¶Áøí„Åå„Åß„Åç„Åæ„Åô",instruction5:"„ÄåË©¶È®ì„É¢„Éº„Éâ„Äç„Çø„Éñ„ÅßÁêÜËß£Â∫¶„ÉÜ„Çπ„Éà„Åå„Åß„Åç„Åæ„Åô",instruction6:"ÁîªÈù¢Âè≥‰∏ä„ÅÆ‚öô„Ç¢„Ç§„Ç≥„É≥„Åã„ÇâÈü≥Èáè„ÉªÂë®Ê≥¢Êï∞„ÉªÈÄüÂ∫¶„ÇíË™øÊï¥„Åß„Åç„Åæ„Åô"},learn:{setupTitle:"Â≠¶ÁøíË®≠ÂÆö",modeLabel:"„É¢„Éº„Éâ",reviewMode:"Âæ©Áøí„É¢„Éº„ÉâÔºà„Çè„Åã„Çâ„Å™„ÅÑ„Ç´„Éº„Éâ„ÅÆ„Åø:",reviewModeCount:"‰ª∂Ôºâ",questionTypeLabel:"Âá∫È°åÂΩ¢Âºè",questionTypes:{abbrToMeaning:"Áï•Ë™û‚ÜíÊÑèÂë≥ÔºàÂü∫Êú¨Ôºâ",meaningToAbbr:"ÊÑèÂë≥‚ÜíÁï•Ë™ûÔºàÂøúÁî®Ôºâ",morseToAbbr:"„É¢„Éº„É´„ÇπÈü≥‚ÜíÁï•Ë™ûÔºàÂÆüË∑µÔºâ",morseToMeaning:"„É¢„Éº„É´„ÇπÈü≥‚ÜíÊÑèÂë≥ÔºàÂÆüË∑µÔºâ"},availableCards:"Â≠¶ÁøíÂèØËÉΩ:",cardsUnit:"Êûö",startButton:"Â≠¶ÁøíÈñãÂßã",clearProgressButton:"ÈÄ≤Êçó„Çí„É™„Çª„ÉÉ„Éà",backToSetup:"‚Üê Ë®≠ÂÆö„Å´Êàª„Çã",progressIndicator:" / ",cardLabels:{abbreviation:"Áï•Ë™û",meaning:"ÊÑèÂë≥",morseToAbbrPrompt:"„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶Áï•Ë™û„ÇíÁ≠î„Åà„Å¶„Åè„Å†„Åï„ÅÑ",morseToMeaningPrompt:"„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶ÊÑèÂë≥„ÇíÁ≠î„Åà„Å¶„Åè„Å†„Åï„ÅÑ"},playMorseButton:"üîä „É¢„Éº„É´„ÇπÂÜçÁîü",flipToAnswer:"Ê≠£Ëß£„ÇíÁ¢∫Ë™ç„Åô„Çã",flipToQuestion:"ÂïèÈ°å„Å´Êàª„Çã",spaceHint:"(Space)",judgmentButtons:{unknown:"√ó „Çè„Åã„Çâ„Å™„ÅÑ",known:"‚óã „Çè„Åã„Çã"},navigation:{prev:"‚Üê Ââç„ÅÆ„Ç´„Éº„Éâ",next:"Ê¨°„ÅÆ„Ç´„Éº„Éâ ‚Üí"},confirmReset:"Â≠¶ÁøíÈÄ≤Êçó„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü",noCards:"Â≠¶ÁøíÂèØËÉΩ„Å™„Ç´„Éº„Éâ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ",completed:"Â≠¶ÁøíÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"„Éï„Ç£„É´„Çø„Éº„ÅßÂ≠¶Áøí„Åô„ÇãÁï•Ë™û„ÇíÁµû„ÇäËæº„Åø„Åæ„Åô",instruction2:"Âá∫È°åÂΩ¢Âºè„ÇíÈÅ∏Êäû„Åó„Åæ„ÅôÔºàÁï•Ë™û‚ÜíÊÑèÂë≥„ÄÅÊÑèÂë≥‚ÜíÁï•Ë™û„ÄÅ„É¢„Éº„É´„ÇπÈü≥„Åã„Çâ„ÅÆËß£Ë™≠Ôºâ",instruction3:"„Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„ÅßË£èËøî„Åó„ÄÅ„Äå„Çè„Åã„Çã„Äç„Äå„Çè„Åã„Çâ„Å™„ÅÑ„Äç„ÅßÈÄ≤Êçó„ÇíË®òÈå≤",instruction4:"Âæ©Áøí„É¢„Éº„Éâ„Åß„Äå„Çè„Åã„Çâ„Å™„ÅÑ„Äç„Ç´„Éº„Éâ„ÅÆ„Åø„ÇíÂ≠¶Áøí„Åß„Åç„Åæ„Åô",instruction5:"Â≠¶ÁøíÈÄ≤Êçó„ÅØ„Éñ„É©„Ç¶„Ç∂„Å´Ëá™Âãï‰øùÂ≠ò„Åï„Çå„Åæ„Åô"},exam:{setupTitle:"Âá∫È°åÂΩ¢Âºè",questionTypeLabel:"Âá∫È°åÂΩ¢Âºè",questionTypes:{abbrToMeaning:"Áï•Ë™û‚ÜíÊÑèÂë≥ÔºàÂü∫Á§éÔºâ",meaningToAbbr:"ÊÑèÂë≥‚ÜíÁï•Ë™ûÔºàÂøúÁî®Ôºâ",morseToAbbr:"„É¢„Éº„É´„ÇπÈü≥‚ÜíÁï•Ë™ûÔºàÂÆüË∑µÔºâ",morseToMeaning:"„É¢„Éº„É´„ÇπÈü≥‚ÜíÊÑèÂë≥ÔºàÂÆüË∑µÔºâ"},questionCountLabel:"ÂïèÈ°åÊï∞",questionCounts:{five:"5Âïè",ten:"10Âïè",twenty:"20Âïè",fifty:"50Âïè",all:"ÂÖ®Âïè"},startButton:"Ë©¶È®ìÈñãÂßã",titleInProgress:"CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí - Ë©¶È®ì‰∏≠",interruptButton:"‰∏≠Êñ≠",questionProgress:"ÂïèÈ°å",questionTemplates:{abbrToMeaning:"Ê¨°„ÅÆÁï•Ë™û„ÅÆÊÑèÂë≥„ÅØÔºü",meaningToAbbr:"Ê¨°„ÅÆÊÑèÂë≥„ÇíË°®„ÅôÁï•Ë™û„ÅØÔºü",morseToAbbr:"„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶„ÄÅÂØæÂøú„Åô„ÇãÁï•Ë™û„ÅØÔºü",morseToMeaning:"„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶„ÄÅÂØæÂøú„Åô„ÇãÊÑèÂë≥„ÅØÔºü"},replayButton:"üîä „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÂÜçÁîü",confirmInterrupt:"Ë©¶È®ì„Çí‰∏≠Êñ≠„Åó„Å¶„É°„Éã„É•„Éº„Å´Êàª„Çä„Åæ„Åô„ÅãÔºü",noEntries:"Ë©≤ÂΩì„Åô„Çã„Ç®„É≥„Éà„É™„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Éï„Ç£„É´„Çø„Éº„ÇíË™øÊï¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",invalidCount:"ÂïèÈ°åÊï∞„Çí1‰ª•‰∏ä„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"„Éï„Ç£„É´„Çø„Éº„ÅßÂá∫È°åÁØÑÂõ≤„ÇíÁµû„ÇäËæº„Åø„Åæ„Åô",instruction2:"Âá∫È°åÂΩ¢Âºè„ÇíÈÅ∏Êäû„Åó„Åæ„ÅôÔºàÁï•Ë™û‚ÜíÊÑèÂë≥„ÄÅÊÑèÂë≥‚ÜíÁï•Ë™û„ÄÅ„É¢„Éº„É´„ÇπÈü≥„Åã„ÇâÔºâ",instruction3:"ÂïèÈ°åÊï∞„ÇíÈÅ∏Êäû„Åó„Åæ„ÅôÔºà5Âïè„ÄúÂÖ®ÂïèÔºâ",instruction4:"4„Å§„ÅÆÈÅ∏ÊäûËÇ¢„Åã„ÇâÊ≠£Ëß£„ÇíÈÅ∏„Å≥„Åæ„Åô",instruction5:"80%‰ª•‰∏ä„ÅßÂêàÊ†º„Åß„Åô"},result:{title:"CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí - ÁµêÊûú",passed:"ÂêàÊ†ºÔºÅ",failed:"‰∏çÂêàÊ†º",scoreDetail:" / ",scoreUnit:"ÂïèÊ≠£Ëß£",wrongAnswersTitle:"ÈñìÈÅï„Åà„ÅüÂïèÈ°åÔºà",wrongAnswersCount:"‰ª∂Ôºâ",yourAnswer:"„ÅÇ„Å™„Åü„ÅÆÂõûÁ≠î:",correctAnswer:"Ê≠£Ëß£:",perfectScore:"„Åô„Åπ„Å¶Ê≠£Ëß£„Åó„Åæ„Åó„ÅüÔºÅ",retryButton:"„ÇÇ„ÅÜ‰∏ÄÂ∫¶",backToSetupButton:"Ë®≠ÂÆö„Å´Êàª„Çã"}},koch:{title:"„Ç≥„ÉÉ„ÉõÊ≥ï„Éà„É¨„Éº„Éã„É≥„Ç∞",tabs:{learning:"Âü∫Êú¨Â≠¶Áøí",custom:"‰ªªÊÑèÊñáÂ≠óÂàóÁ∑¥Áøí"},learning:{lessonTitle:"„É¨„ÉÉ„Çπ„É≥",lessonProgress:" / 40",learnedChars:"Â≠¶ÁøíÊñáÂ≠ó:",startPractice:"Á∑¥ÁøíÈñãÂßã",lessonListTitle:"„É¨„ÉÉ„Çπ„É≥‰∏ÄË¶ß",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"„ÄåÁ∑¥ÁøíÈñãÂßã„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„É¢„Éº„É´„Çπ‰ø°Âè∑„ÇíËÅû„Åè",instruction2:"ËÅû„Åì„Åà„ÅüÊñáÂ≠ó„ÇíÂÖ•Âäõ",instruction3:"90%‰ª•‰∏ä„ÅÆÊ≠£Á≠îÁéá„ÅßÊ¨°„ÅÆ„É¨„ÉÉ„Çπ„É≥„Å∏"},custom:{title:"‰ªªÊÑèÊñáÂ≠óÂàóÁ∑¥Áøí„É¢„Éº„Éâ",selectPrompt:"Á∑¥Áøí„Åó„Åü„ÅÑÊñáÂ≠ó„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºàÊúÄ‰Ωé2ÊñáÂ≠óÔºâ",startPractice:"Á∑¥ÁøíÈñãÂßã",howToUse:"‰Ωø„ÅÑÊñπ",instruction1:"Á∑¥Áøí„Åó„Åü„ÅÑÊñáÂ≠ó„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈÅ∏Êäû",instruction2:"2ÊñáÂ≠ó‰ª•‰∏äÈÅ∏Êäû„Åô„Çã„Å®Á∑¥ÁøíÈñãÂßãÂèØËÉΩ",instruction3:"ÈÅ∏Êäû„Åó„ÅüÊñáÂ≠ó„ÅÆ„Åø„Åß„É©„É≥„ÉÄ„É†„Å™Á∑¥ÁøíÂïèÈ°å„ÅåÁîüÊàê„Åï„Çå„Åæ„Åô"},practice:{ready:"Ê∫ñÂÇôÂÆå‰∫Ü - ÂÜçÁîü„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ",progress:"ÈÄ≤Ë°å:",inputPlaceholder:"ËÅû„Åì„Åà„ÅüÊñáÂ≠ó„ÇíÂÖ•Âäõ...",customInputPlaceholder:"ËÅû„Åì„Åà„ÅüÊñáÂ≠ó„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ...",showResult:"ÁµêÊûú„ÇíË¶ã„Çã",playButton:"ÂÜçÁîü",pauseButton:"‰∏ÄÊôÇÂÅúÊ≠¢",stopButton:"ÂÅúÊ≠¢"},keyboard:{header:"„Ç∞„É´„Éº„Éó„Éô„Éº„Çπ„Ç≠„Éº„Éú„Éº„ÉâÔºàÂ≠¶ÁøíÊ∏à„ÅøÊñáÂ≠ó„ÅÆ„ÅøÊúâÂäπÔºâ",space:"„Çπ„Éö„Éº„Çπ",backspace:"1Â≠óÂâäÈô§",groupLabel:"G"},result:{passed:"ÂêàÊ†ºÔºÅ",failed:"‰∏çÂêàÊ†º",accuracy:"Ê≠£Á≠îÁéá:",sent:"ÈÄÅ‰ø°:",input:"ÂÖ•Âäõ:",noInput:"ÔºàÊú™ÂÖ•ÂäõÔºâ",nextLesson:"Ê¨°„ÅÆ„É¨„ÉÉ„Çπ„É≥„Å∏",retry:"„ÇÇ„ÅÜ‰∏ÄÂ∫¶",customTitle:"Á∑¥ÁøíÁµêÊûú",yourInput:"„ÅÇ„Å™„Åü„ÅÆÂÖ•Âäõ:",back:"Êàª„Çã"}},listening:{title:"„É¢„Éº„É´„Çπ‰ø°Âè∑ËÅû„ÅçÂèñ„ÇäÁ∑¥Áøí",types:{qso:"QSOÁ∑¥Áøí",text:"Ëã±ÊñáÁ∑¥Áøí",random:"„É©„É≥„ÉÄ„É†ÊñáÂ≠óÂàó"},generate:"ÁîüÊàê",play:"ÂÜçÁîü",pause:"‰∏ÄÊôÇÂÅúÊ≠¢",stop:"ÂÅúÊ≠¢",showText:"„ÉÜ„Ç≠„Çπ„ÉàË°®Á§∫",hideText:"„ÉÜ„Ç≠„Çπ„ÉàÈùûË°®Á§∫",downloadAudio:"Èü≥Â£∞„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ",qsoType:{rubberStamp:"„É©„Éê„Éº„Çπ„Çø„É≥„ÉóQSO",random:"„É©„É≥„ÉÄ„É†QSO"},textType:{news:"„Éã„É•„Éº„ÇπÊñá",literature:"ÊñáÂ≠¶",technical:"ÊäÄË°ìÊñá"}},settings:{title:"Ë®≠ÂÆö",audio:{title:"Èü≥Â£∞Ë®≠ÂÆö",frequency:"Âë®Ê≥¢Êï∞",frequencyValue:"{value} Hz",volume:"Èü≥Èáè",volumeValue:"{value}%",wpm:"ÈÄüÂ∫¶ÔºàWPMÔºâ",wpmValue:"{value} WPM"},keybindings:{title:"„Ç≠„Éº„Éê„Ç§„É≥„Éâ",leftPaddle:"Â∑¶„Éë„Éâ„É´",rightPaddle:"Âè≥„Éë„Éâ„É´",straightKey:"Á∏¶ÊåØ„ÇäÈõªÈçµ",pressKey:"„Ç≠„Éº„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ"},display:{title:"Ë°®Á§∫Ë®≠ÂÆö",theme:"„ÉÜ„Éº„Éû",fontSize:"„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫",light:"„É©„Ç§„Éà",dark:"„ÉÄ„Éº„ÇØ"},saveSuccess:"Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü",resetToDefault:"„Éá„Éï„Ç©„É´„Éà„Å´Êàª„Åô"},errors:{audioContextFailed:"Èü≥Â£∞„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„ÅÆÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü",fileLoadFailed:"„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü",invalidInput:"ÁÑ°Âäπ„Å™ÂÖ•Âäõ„Åß„Åô",networkError:"„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü",unknownError:"‰∏çÊòé„Å™„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü"}},en:{common:{appName:"Morse Code Training App",version:"v12 - Multilingual Edition",backToMenu:"Back to Menu",settings:"Settings",start:"Start",stop:"Stop",reset:"Reset",download:"Download",language:"Language",close:"Close",save:"Save",cancel:"Cancel",copyright:"¬© 2025 Morse Code Training App"},menu:{title:"Morse Code Training App",subtitle:"Menu",items:{vertical:{title:"Straight Key Practice",description:"Practice with vertical key (straight key)"},horizontal:{title:"Paddle Practice",description:"Practice with horizontal key (paddle) - Iambic A/B supported"},flashcard:{title:"CW Abbreviations & Q Codes",description:"Learn abbreviations and Q codes used in CW communication"},koch:{title:"Koch Method Training",description:"Learn by gradually adding characters"},listening:{title:"Morse Code Listening Practice",description:"Practice listening to random QSOs and English text"}}},verticalKey:{title:"Straight Key Practice",instructions:"Practice with spacebar or screen tap",keyLabel:"(Click/Tap to send)",morseSignal:"Morse Signal",morseBufferPlaceholder:"(Morse code will be displayed here)",decodedResult:"Decoded Text",decodedTextPlaceholder:"(Decoded characters will be displayed here)",currentSpeed:"Current Speed",keyState:"Key State",released:"Released",pressed:"Pressed",charCount:"Character Count",timingEvaluation:"Timing Evaluation",latestInput:"Latest Input",waitingForInput:"(Waiting for input)",overallStats:"Overall Statistics",noStatsData:"(No statistics data)",ditStats:"Dit („Éª) Statistics",dahStats:"Dah („Éº) Statistics",dit:"Dit („Éª)",dah:"Dah („Éº)",noData:"(No data)",howToUse:"How to Use",instruction1:"Morse signal is transmitted while pressing the space key or screen button",instruction2:'Short press for "„Éª" (dit), long press for "„Éº" (dah)',instruction3:"Character spacing is automatically detected",instruction4:"Speed can be adjusted in WPM (Words Per Minute)",instruction5:"Click the ‚öô icon in the top right to adjust volume, frequency, and speed",instruction6:"If no sound, click the button once (browser audio policy)",element:"Element:",expected:"Expected:",actual:"Actual:",accuracy:"Accuracy:",error:"Error:",longer:"longer",shorter:"shorter",perfect:"Perfect",avgAccuracy:"Avg Accuracy:",maxAccuracy:"Max Accuracy:",minAccuracy:"Min Accuracy:",avgError:"Avg Error:",count:"Count",avgDuration:"Avg Duration",inputCount:"Input Count:",times:""},horizontalKey:{title:"Paddle Practice",instructions:"Practice with left and right paddles",leftPaddle:"Left Paddle (Dit)",rightPaddle:"Right Paddle (Dah)",dit:"DIT",dah:"DAH",ditLabel:"(Dit)",dahLabel:"(Dah)",jKey:"J Key",kKey:"K Key",morseSignal:"Morse Signal",morseBufferPlaceholder:"(Morse code will be displayed here)",decodedResult:"Decoded Text",decodedTextPlaceholder:"(Decoded characters will be displayed here)",clear:"Clear",currentSpeed:"Current Speed",iambicMode:"Iambic Mode",charCount:"Character Count",timingDiagramTitle:"Timing Diagram (Last Character)",timingDiagramPlaceholder:"(Will be displayed when a character is completed)",mode:"Mode",modeA:"Iambic A",modeB:"Iambic B",spacingEvaluation:"Spacing Evaluation",avgAccuracy:"Avg Accuracy",avgError:"Avg Error",evaluationCount:"Evaluation Count",charSpacing:"Character Spacing",wordSpacing:"Word Spacing",expected:"Expected:",accuracy:"Accuracy:",error:"Error:",count:"Count:",howToUse:"How to Use",instruction1:"Left paddle (J): Dit („Éª) / Right paddle (K): Dah („Éº)",instruction2:"Press both simultaneously for automatic alternating transmission (Iambic)",instruction3:"Iambic B mode: Adds one element after squeeze",instruction4:"Click the ‚öô icon in the top right to change settings (WPM, Iambic mode, paddle layout, volume & frequency)",timingDiagram:"Timing Diagram",debugInfo:"Debug Info",paddleInput:"Paddle Input",ditInput:"Dit Input",dahInput:"Dah Input",output:"Output",squeezeZone:"Squeeze Zone",gapZone:"Gap Zone",press:"Press",release:"Release",squeezeOn:"Squeeze ON",squeezeOff:"Squeeze OFF",gapOn:"Gap ON",gapOff:"Gap OFF"},flashcard:{title:"CW Abbreviations & Q Codes",loading:"Loading flashcard data...",loadError:"Failed to load data.",error:"Error:",tabs:{browse:"Browse",learn:"Learn Mode",exam:"Exam Mode"},filter:{title:"Filter Settings",tagLabel:"Filter by Tag",frequencyLabel:"Filter by Frequency (1=Low, 5=High)",searchLabel:"Search (abbreviation, meaning, tags)",searchPlaceholder:"e.g., QTH, location, Q code",filteredCount:"Filtered:",totalCount:"Total:",items:"items"},browse:{entriesHeader:"Abbreviations List",entriesCount:"items",toggleList:"üìã List View",toggleCard:"üÉè Card View",examplePrefix:"e.g., ",tableHeaders:{abbreviation:"Abbr.",english:"English",japanese:"Japanese",frequency:"Freq.",tags:"Tags",description:"Description",example:"Example"},howToUse:"How to Use",instruction1:"Filter abbreviations by tags, frequency, and search",instruction2:"Click abbreviation cards to play Morse code",instruction3:"Switch between card and list view",instruction4:"Use 'Learn Mode' tab for flashcard learning",instruction5:"Use 'Exam Mode' tab for comprehension testing",instruction6:"Click ‚öô icon in top right to adjust volume, frequency, and speed"},learn:{setupTitle:"Learning Settings",modeLabel:"Mode",reviewMode:"Review Mode (unknown cards only:",reviewModeCount:"items)",questionTypeLabel:"Question Type",questionTypes:{abbrToMeaning:"Abbr. ‚Üí Meaning (Basic)",meaningToAbbr:"Meaning ‚Üí Abbr. (Applied)",morseToAbbr:"Morse Sound ‚Üí Abbr. (Practical)",morseToMeaning:"Morse Sound ‚Üí Meaning (Practical)"},availableCards:"Available:",cardsUnit:"cards",startButton:"Start Learning",clearProgressButton:"Reset Progress",backToSetup:"‚Üê Back to Setup",progressIndicator:" / ",cardLabels:{abbreviation:"Abbreviation",meaning:"Meaning",morseToAbbrPrompt:"Listen to Morse sound and answer the abbreviation",morseToMeaningPrompt:"Listen to Morse sound and answer the meaning"},playMorseButton:"üîä Play Morse",flipToAnswer:"Show Answer",flipToQuestion:"Back to Question",spaceHint:"(Space)",judgmentButtons:{unknown:"√ó Don't Know",known:"‚óã Know"},navigation:{prev:"‚Üê Previous Card",next:"Next Card ‚Üí"},confirmReset:"Reset learning progress?",noCards:"No cards available for learning.",completed:"Learning completed!",howToUse:"How to Use",instruction1:"Filter abbreviations to study using filters",instruction2:"Select question type (abbr. ‚Üí meaning, meaning ‚Üí abbr., Morse sound decoding)",instruction3:"Click card to flip, mark 'Know' or 'Don't Know' to record progress",instruction4:"Use review mode to study only 'Don't Know' cards",instruction5:"Learning progress is automatically saved in browser"},exam:{setupTitle:"Question Format",questionTypeLabel:"Question Format",questionTypes:{abbrToMeaning:"Abbr. ‚Üí Meaning (Basic)",meaningToAbbr:"Meaning ‚Üí Abbr. (Applied)",morseToAbbr:"Morse Sound ‚Üí Abbr. (Practical)",morseToMeaning:"Morse Sound ‚Üí Meaning (Practical)"},questionCountLabel:"Number of Questions",questionCounts:{five:"5 questions",ten:"10 questions",twenty:"20 questions",fifty:"50 questions",all:"All"},startButton:"Start Exam",titleInProgress:"CW Abbreviations & Q Codes - Exam",interruptButton:"Interrupt",questionProgress:"Question",questionTemplates:{abbrToMeaning:"What does this abbreviation mean?",meaningToAbbr:"What abbreviation represents this meaning?",morseToAbbr:"Listen to Morse sound, which abbreviation is it?",morseToMeaning:"Listen to Morse sound, what does it mean?"},replayButton:"üîä Replay",confirmInterrupt:"Interrupt exam and return to menu?",noEntries:"No matching entries. Adjust filters.",invalidCount:"Set question count to 1 or more.",howToUse:"How to Use",instruction1:"Filter to narrow exam scope",instruction2:"Select question format (abbr. ‚Üí meaning, meaning ‚Üí abbr., from Morse sound)",instruction3:"Select number of questions (5 ~ all)",instruction4:"Choose correct answer from 4 choices",instruction5:"80% or higher to pass"},result:{title:"CW Abbreviations & Q Codes - Result",passed:"Passed!",failed:"Failed",scoreDetail:" / ",scoreUnit:" correct",wrongAnswersTitle:"Incorrect Answers (",wrongAnswersCount:"items)",yourAnswer:"Your Answer:",correctAnswer:"Correct Answer:",perfectScore:"Perfect score!",retryButton:"Try Again",backToSetupButton:"Back to Setup"}},koch:{title:"Koch Method Training",tabs:{learning:"Basic Learning",custom:"Custom Practice"},learning:{lessonTitle:"Lesson",lessonProgress:" / 40",learnedChars:"Learned Characters:",startPractice:"Start Practice",lessonListTitle:"Lesson List",howToUse:"How to Use",instruction1:"Click 'Start Practice' to listen to Morse code",instruction2:"Type the characters you hear",instruction3:"Achieve 90% or higher accuracy to advance to the next lesson"},custom:{title:"Custom Character Practice Mode",selectPrompt:"Select characters you want to practice (at least 2 characters)",startPractice:"Start Practice",howToUse:"How to Use",instruction1:"Click on characters to select them",instruction2:"Practice starts when 2 or more characters are selected",instruction3:"Random practice problems will be generated using only the selected characters"},practice:{ready:"Ready - Press the play button",progress:"Progress:",inputPlaceholder:"Type what you hear...",customInputPlaceholder:"Type what you hear...",showResult:"Show Result",playButton:"Play",pauseButton:"Pause",stopButton:"Stop"},keyboard:{header:"Group-Based Keyboard (Only learned characters enabled)",space:"Space",backspace:"Delete",groupLabel:"G"},result:{passed:"Passed!",failed:"Failed",accuracy:"Accuracy:",sent:"Sent:",input:"Input:",noInput:"(No input)",nextLesson:"Next Lesson",retry:"Try Again",customTitle:"Practice Result",yourInput:"Your Input:",back:"Back"}},listening:{title:"Morse Code Listening Practice",types:{qso:"QSO Practice",text:"Text Practice",random:"Random Characters"},generate:"Generate",play:"Play",pause:"Pause",stop:"Stop",showText:"Show Text",hideText:"Hide Text",downloadAudio:"Download Audio",qsoType:{rubberStamp:"Rubber Stamp QSO",random:"Random QSO"},textType:{news:"News",literature:"Literature",technical:"Technical"}},settings:{title:"Settings",audio:{title:"Audio Settings",frequency:"Frequency",frequencyValue:"{value} Hz",volume:"Volume",volumeValue:"{value}%",wpm:"Speed (WPM)",wpmValue:"{value} WPM"},keybindings:{title:"Key Bindings",leftPaddle:"Left Paddle",rightPaddle:"Right Paddle",straightKey:"Straight Key",pressKey:"Press a key"},display:{title:"Display Settings",theme:"Theme",fontSize:"Font Size",light:"Light",dark:"Dark"},saveSuccess:"Settings saved successfully",resetToDefault:"Reset to Default"},errors:{audioContextFailed:"Failed to initialize audio context",fileLoadFailed:"Failed to load file",invalidInput:"Invalid input",networkError:"Network error occurred",unknownError:"An unknown error occurred"}}};let b="ja";const y=[];function f(){try{const t=localStorage.getItem(g);if(t&&m.includes(t))return t}catch(t){}return function(){const t=navigator.language.toLowerCase();if(m.includes(t))return t;const e=t.split("-")[0];return m.includes(e)?e:"ja"}()}function w(t){m.includes(t)&&(b=t,function(t){try{localStorage.setItem(g,t)}catch(e){}}(t),y.forEach(e=>e(t)))}function $(t,e){const n=t.split(".");let s=v[b];for(const a of n){if(!s||"object"!=typeof s||!(a in s))return t;s=s[a]}return"string"!=typeof s?t:s}function S(t){return{ja:"Êó•Êú¨Ë™û",en:"English"}[t]||t}class L{isOpen=!1;boundCloseDropdown=null;render(){const t=b;return`\n\t\t\t<div class="language-switcher">\n\t\t\t\t<button class="language-switcher-button" id="languageSwitcherButton">\n\t\t\t\t\t<svg class="language-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n\t\t\t\t\t\t<circle cx="12" cy="12" r="10"></circle>\n\t\t\t\t\t\t<line x1="2" y1="12" x2="22" y2="12"></line>\n\t\t\t\t\t\t<path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class="language-name">${S(t)}</span>\n\t\t\t\t\t<svg class="chevron-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n\t\t\t\t\t\t<polyline points="6 9 12 15 18 9"></polyline>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<div class="language-dropdown" id="languageDropdown">\n\t\t\t\t\t${m.map(e=>`\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass="language-option ${e===t?"active":""}"\n\t\t\t\t\t\t\tdata-lang="${e}"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t${S(e)}\n\t\t\t\t\t\t\t${e===t?'<span class="checkmark">‚úì</span>':""}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t`).join("")}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}attachEventListeners(t){const e=t.querySelector("#languageSwitcherButton"),n=t.querySelector("#languageDropdown");if(!e||!n)return;
//! „Éú„Çø„É≥„ÇØ„É™„ÉÉ„ÇØ„Åß„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÇíÈñãÈñâ„ÄÇ
e.addEventListener("click",t=>{t.stopPropagation(),this.toggleDropdown(n)});var s;t.querySelectorAll(".language-option").forEach(t=>{t.addEventListener("click",e=>{e.stopPropagation();const n=t.dataset.lang;n&&m.includes(n)&&this.selectLanguage(n)})}),
//! „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥Â§ñ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„ÇâÈñâ„Åò„Çã„ÄÇ
this.boundCloseDropdown=e=>{const s=e.target;t.contains(s)||this.closeDropdown(n)},
//! Ë®ÄË™ûÂ§âÊõ¥ÊôÇ„ÅÆ„Ç≥„Éº„É´„Éê„ÉÉ„ÇØÁôªÈå≤„ÄÇ
s=()=>{
//! Ë®ÄË™û„ÅåÂ§âÊõ¥„Åï„Çå„Åü„Çâ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„ÄÇ
window.location.reload()},y.push(s)}toggleDropdown(t){this.isOpen=!this.isOpen,this.isOpen?(t.classList.add("open"),
//! „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÅåÈñã„ÅÑ„Å¶„ÅÑ„Çã„Å®„Åç„ÅØÂ§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã„ÄÇ
setTimeout(()=>{document.addEventListener("click",this.boundCloseDropdown)},0)):this.closeDropdown(t)}closeDropdown(t){t.classList.remove("open"),this.isOpen=!1,this.boundCloseDropdown&&document.removeEventListener("click",this.boundCloseDropdown)}selectLanguage(t){w(t);
//! setLanguage„Åå„Ç≥„Éº„É´„Éê„ÉÉ„ÇØ„ÇíÂÆüË°å„Åó„ÄÅ„Éö„Éº„Ç∏„Åå„É™„É≠„Éº„Éâ„Åï„Çå„Çã„ÄÇ
}destroy(){this.boundCloseDropdown&&(document.removeEventListener("click",this.boundCloseDropdown),this.boundCloseDropdown=null),this.isOpen=!1}}class C{languageSwitcher=new L;getMenuItems(){return[{id:"vertical",title:$("menu.items.vertical.title"),description:$("menu.items.vertical.description"),route:"vertical"},{id:"horizontal",title:$("menu.items.horizontal.title"),description:$("menu.items.horizontal.description"),route:"horizontal"},{id:"flashcard",title:$("menu.items.flashcard.title"),description:$("menu.items.flashcard.description"),route:"flashcard"},{id:"koch",title:$("menu.items.koch.title"),description:$("menu.items.koch.description"),route:"koch"},{id:"listening",title:$("menu.items.listening.title"),description:$("menu.items.listening.description"),route:"listening"}]}render(){const t=document.getElementById("app");if(!t)return;const e=this.getMenuItems();t.innerHTML=`\n\t\t\t<div class="container">\n\t\t\t\t<header class="menu-header">\n\t\t\t\t\t<div class="menu-header-top">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h1>${$("menu.title")}</h1>\n\t\t\t\t\t\t\t<p class="version">${$("common.version")}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\n\t\t\t\t<main class="menu-main">\n\t\t\t\t\t<div class="menu-grid">\n\t\t\t\t\t\t${e.map(t=>this.renderMenuItem(t)).join("")}\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\n\t\t\t\t<footer class="menu-footer">\n\t\t\t\t\t<p>${$("common.copyright")}</p>\n\t\t\t\t</footer>\n\t\t\t</div>\n\t\t`,
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
this.attachEventListeners();
//! LanguageSwitcher„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
const n=document.getElementById("languageSwitcherContainer");n&&this.languageSwitcher.attachEventListeners(n)}renderMenuItem(t){return`\n\t\t\t<div class="menu-item" data-route="${t.route}">\n\t\t\t\t<h2 class="menu-item-title">${t.title}</h2>\n\t\t\t\t<p class="menu-item-description">${t.description}</p>\n\t\t\t</div>\n\t\t`}attachEventListeners(){document.querySelectorAll(".menu-item").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-route");e&&(window.location.hash=`#${e}`)})})}destroy(){
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅØÊñ∞„Åó„ÅÑHTML„Åß‰∏äÊõ∏„Åç„Åï„Çå„Çã„Åü„ÇÅ„ÄÅÁâπ„Å´Âá¶ÁêÜ‰∏çË¶Å„ÄÇ
}}class E{trainer;buffer;timer;audio;isKeyPressed=!1;keyPressHandler=null;keyReleaseHandler=null;updateIntervalId=null;currentWPM=20;keyCode="Space";latestEvaluation=null;overallStats=null;dotStats=null;dashStats=null;languageSwitcher=new L;constructor(){
//! Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„ÇÄ„ÄÇ
const i=localStorage.getItem("verticalKeyWPM");i&&(this.currentWPM=parseInt(i,10));const r=localStorage.getItem("verticalKeyCode");r&&(this.keyCode=r),
//! „Ç≥„Ç¢„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÇíÂàùÊúüÂåñ„ÄÇ
this.buffer=new t,this.timer=new e,this.audio=new n({frequency:700,volume:.5,wpm:this.currentWPM});
//! „Çø„Ç§„Éü„É≥„Ç∞Ë®àÁÆó„ÄÇ
const o=s.calculate(this.currentWPM);
//! „Éà„É¨„Éº„Éä„Éº„ÇíÂàùÊúüÂåñÔºà„Ç≥„Éº„É´„Éê„ÉÉ„ÇØ„ÅßÈü≥Â£∞Âà∂Âæ°„Å®„Çø„Ç§„Éü„É≥„Ç∞Ë©ï‰æ°Ôºâ„ÄÇ
this.trainer=new a(this.buffer,this.timer,o,{onKeyPress:()=>{
//! „Ç≠„ÉºÊäº‰∏ãÊôÇ„Å´Èü≥„ÇíÈ≥¥„Çâ„Åô„ÄÇ
this.audio.startContinuousTone()},onKeyRelease:()=>{
//! „Ç≠„ÉºËß£ÊîæÊôÇ„Å´Èü≥„ÇíÊ≠¢„ÇÅ„Çã„ÄÇ
this.audio.stopContinuousTone()},onTimingEvaluated:t=>{
//! „Çø„Ç§„Éü„É≥„Ç∞Ë©ï‰æ°ÁµêÊûú„Çí‰øùÂ≠ò„ÄÇ
this.latestEvaluation=t,this.updateTimingStatistics()}})}render(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t<h1>${$("verticalKey.title")}</h1>\n\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="key-button-container">\n\t\t\t\t\t<button class="key-button" id="morse-key">\n\t\t\t\t\t\tKEY\n\t\t\t\t\t\t<span class="key-label">${$("verticalKey.keyLabel")}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="practice-container">\n\t\t\t\t\t<div class="display-area">\n\t\t\t\t\t\t<div class="display-section">\n\t\t\t\t\t\t\t<h3>${$("verticalKey.morseSignal")}</h3>\n\t\t\t\t\t\t\t<div class="display-output morse-buffer" id="morse-buffer">${$("verticalKey.morseBufferPlaceholder")}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="display-section">\n\t\t\t\t\t\t\t<h3>${$("verticalKey.decodedResult")}</h3>\n\t\t\t\t\t\t\t<div class="display-output" id="decoded-text">${$("verticalKey.decodedTextPlaceholder")}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="action-area">\n\t\t\t\t\t\t<button class="btn btn-large btn-danger" id="clear-btn">${$("common.reset")}</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="status-area">\n\t\t\t\t\t\t<div class="status-item">\n\t\t\t\t\t\t\t<span class="label">${$("verticalKey.currentSpeed")}</span>\n\t\t\t\t\t\t\t<span class="value" id="current-wpm">${this.currentWPM}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="status-item" id="key-status">\n\t\t\t\t\t\t\t<span class="label">${$("verticalKey.keyState")}</span>\n\t\t\t\t\t\t\t<span class="value">${$("verticalKey.released")}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="status-item">\n\t\t\t\t\t\t\t<span class="label">${$("verticalKey.charCount")}</span>\n\t\t\t\t\t\t\t<span class="value" id="char-count">0</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="timing-evaluation-area">\n\t\t\t\t\t\t<h3>${$("verticalKey.timingEvaluation")}</h3>\n\t\t\t\t\t\t<div class="evaluation-panel">\n\t\t\t\t\t\t\t<div class="latest-evaluation">\n\t\t\t\t\t\t\t\t<h4>${$("verticalKey.latestInput")}</h4>\n\t\t\t\t\t\t\t\t<div id="latest-evaluation-content" class="evaluation-content">\n\t\t\t\t\t\t\t\t\t${$("verticalKey.waitingForInput")}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="statistics-panel">\n\t\t\t\t\t\t\t\t<h4>${$("verticalKey.overallStats")}</h4>\n\t\t\t\t\t\t\t\t<div id="overall-stats-content" class="stats-content">\n\t\t\t\t\t\t\t\t\t${$("verticalKey.noStatsData")}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="element-stats-panel">\n\t\t\t\t\t\t\t\t<div class="dot-stats">\n\t\t\t\t\t\t\t\t\t<h4>${$("verticalKey.ditStats")}</h4>\n\t\t\t\t\t\t\t\t\t<div id="dot-stats-content" class="stats-content">\n\t\t\t\t\t\t\t\t\t\t${$("verticalKey.noData")}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="dash-stats">\n\t\t\t\t\t\t\t\t\t<h4>${$("verticalKey.dahStats")}</h4>\n\t\t\t\t\t\t\t\t\t<div id="dash-stats-content" class="stats-content">\n\t\t\t\t\t\t\t\t\t\t${$("verticalKey.noData")}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>${$("verticalKey.howToUse")}</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction1")}</li>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction2")}</li>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction3")}</li>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction4")}</li>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction5")}</li>\n\t\t\t\t\t\t\t<li>${$("verticalKey.instruction6")}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
this.attachEventListeners(),
//! ÂÆöÊúüÊõ¥Êñ∞„ÇíÈñãÂßã„ÄÇ
this.startUpdate())}attachEventListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
const t=document.querySelector(".back-btn");t?.addEventListener("click",()=>{window.location.hash="#menu"}),
//! Ë®≠ÂÆö„Ç¢„Ç§„Ç≥„É≥„ÄÇ
document.getElementById("settingsIcon")?.addEventListener("click",()=>{this.openSettingsModal()});
//! „ÇØ„É™„Ç¢„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("clear-btn");e?.addEventListener("click",()=>{this.trainer.clear(),this.updateDisplay()}),
//! „Ç≠„Éº„Éú„Éº„Éâ„Ç§„Éô„É≥„ÉàÔºàË®≠ÂÆö„Åï„Çå„Åü„Ç≠„ÉºÔºâ„ÄÇ
this.keyPressHandler=t=>{t.code!==this.keyCode||t.repeat||(t.preventDefault(),this.isKeyPressed||this.handleKeyDown())},this.keyReleaseHandler=t=>{t.code===this.keyCode&&(t.preventDefault(),this.isKeyPressed&&this.handleKeyUp())},window.addEventListener("keydown",this.keyPressHandler),window.addEventListener("keyup",this.keyReleaseHandler);
//! „Éú„Çø„É≥„Ç§„Éô„É≥„ÉàÔºà„Éû„Ç¶„Çπ/„Çø„ÉÉ„ÉÅÔºâ„ÄÇ
const n=document.getElementById("morse-key");n&&(
//! „Éû„Ç¶„Çπ„Ç§„Éô„É≥„Éà„ÄÇ
n.addEventListener("mousedown",t=>{t.preventDefault(),this.isKeyPressed||this.handleKeyDown()}),n.addEventListener("mouseup",t=>{t.preventDefault(),this.isKeyPressed&&this.handleKeyUp()}),n.addEventListener("mouseleave",()=>{this.isKeyPressed&&this.handleKeyUp()}),
//! „Çø„ÉÉ„ÉÅ„Ç§„Éô„É≥„Éà„ÄÇ
n.addEventListener("touchstart",t=>{t.preventDefault(),this.isKeyPressed||this.handleKeyDown()}),n.addEventListener("touchend",t=>{t.preventDefault(),this.isKeyPressed&&this.handleKeyUp()}),n.addEventListener("touchcancel",()=>{this.isKeyPressed&&this.handleKeyUp()}));
//! LanguageSwitcher„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
const s=document.getElementById("languageSwitcherContainer");s&&this.languageSwitcher.attachEventListeners(s)}handleKeyDown(){this.isKeyPressed=!0,this.trainer.keyPress(),this.updateKeyStatus(!0);
//! „Éú„Çø„É≥„ÅÆË¶ã„ÅüÁõÆ„ÇíÊõ¥Êñ∞„ÄÇ
const t=document.getElementById("morse-key");t&&t.classList.add("pressed")}handleKeyUp(){this.isKeyPressed=!1,this.trainer.keyRelease(),this.updateKeyStatus(!1);
//! „Éú„Çø„É≥„ÅÆË¶ã„ÅüÁõÆ„ÇíÊõ¥Êñ∞„ÄÇ
const t=document.getElementById("morse-key");t&&t.classList.remove("pressed")}startUpdate(){
//! 100ms„Åî„Å®„Å´ÁîªÈù¢„ÇíÊõ¥Êñ∞„ÄÇ
this.updateIntervalId=window.setInterval(()=>{this.updateDisplay()},100)}updateDisplay(){const t=document.getElementById("morse-buffer"),e=document.getElementById("decoded-text"),n=document.getElementById("char-count");if(t){const e=this.trainer.getBuffer(),n=this.trainer.getSequence(),s=n?`${e} ${n}`:e;t.textContent=s||$("verticalKey.morseBufferPlaceholder")}if(e){const t=this.trainer.getDecoded();e.textContent=t||$("verticalKey.decodedTextPlaceholder")}if(n){const t=this.trainer.getDecoded();n.textContent=t.length.toString()}
//! „Çø„Ç§„Éü„É≥„Ç∞Ë©ï‰æ°Ë°®Á§∫„ÇíÊõ¥Êñ∞„ÄÇ
this.updateTimingDisplay()}updateTimingStatistics(){this.overallStats=this.trainer.getTimingStatistics();const t=this.trainer.getStatisticsByElement();this.dotStats=t.dot,this.dashStats=t.dash}updateTimingDisplay(){
//! ÊúÄÊñ∞Ë©ï‰æ°„ÇíË°®Á§∫„ÄÇ
const t=document.getElementById("latest-evaluation-content");if(t&&this.latestEvaluation){const e=this.latestEvaluation,n="."===e.record.element?$("verticalKey.dit"):$("verticalKey.dah"),a=e.accuracy.toFixed(1),i=this.getAccuracyClass(e.accuracy),r=s.calculate(this.currentWPM).dot,o=8*r,c=e.record.expectedDuration,l=e.record.actualDuration,d=c/o*100,u=l/o*100,h=l-c,p=h>0?"longer":h<0?"shorter":"perfect",m=h>0?`+${h}ms (${$("verticalKey.longer")})`:h<0?`${h}ms (${$("verticalKey.shorter")})`:$("verticalKey.perfect");t.innerHTML=`\n\t\t\t\t<div class="eval-item">\n\t\t\t\t\t<span class="eval-label">${$("verticalKey.element")}</span>\n\t\t\t\t\t<span class="eval-value">${n}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="timing-chart">\n\t\t\t\t\t<div class="chart-row">\n\t\t\t\t\t\t<div class="chart-label">${$("verticalKey.expected")}</div>\n\t\t\t\t\t\t<div class="chart-bar-container">\n\t\t\t\t\t\t\t<div class="chart-bar expected" style="width: ${d}%">\n\t\t\t\t\t\t\t\t<span class="chart-value">${c}ms</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="chart-row">\n\t\t\t\t\t\t<div class="chart-label">${$("verticalKey.actual")}</div>\n\t\t\t\t\t\t<div class="chart-bar-container">\n\t\t\t\t\t\t\t<div class="chart-bar actual ${i}" style="width: ${u}%">\n\t\t\t\t\t\t\t\t<span class="chart-value">${l}ms</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="chart-scale">\n\t\t\t\t\t\t<span>0ms</span>\n\t\t\t\t\t\t<span>${Math.round(4*r)}ms</span>\n\t\t\t\t\t\t<span>${Math.round(o)}ms</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="eval-item">\n\t\t\t\t\t<span class="eval-label">${$("verticalKey.accuracy")}</span>\n\t\t\t\t\t<span class="eval-value accuracy-${i}">${a}%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="eval-item">\n\t\t\t\t\t<span class="eval-label">${$("verticalKey.error")}</span>\n\t\t\t\t\t<span class="eval-value timing-diff-${p}">${m}</span>\n\t\t\t\t</div>\n\t\t\t`}
//! ÂÖ®‰ΩìÁµ±Ë®à„ÇíË°®Á§∫„ÄÇ
const e=document.getElementById("overall-stats-content");if(e&&this.overallStats&&this.overallStats.count>0){const t=this.overallStats,n=this.getAccuracyClass(t.averageAccuracy);e.innerHTML=`\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.inputCount")}</span>\n\t\t\t\t\t<span class="stat-value">${t.count}${$("verticalKey.times")}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.avgAccuracy")}</span>\n\t\t\t\t\t<span class="stat-value accuracy-${n}">${t.averageAccuracy.toFixed(1)} ¬± ${t.standardDeviation.toFixed(1)}%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.maxAccuracy")}</span>\n\t\t\t\t\t<span class="stat-value">${t.maxAccuracy.toFixed(1)}%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.minAccuracy")}</span>\n\t\t\t\t\t<span class="stat-value">${t.minAccuracy.toFixed(1)}%</span>\n\t\t\t\t</div>\n\t\t\t`}
//! Áü≠ÁÇπÁµ±Ë®à„ÇíË°®Á§∫„ÄÇ
const n=document.getElementById("dot-stats-content");if(n&&this.dotStats&&this.dotStats.count>0){const t=this.dotStats,e=this.getAccuracyClass(t.averageAccuracy);n.innerHTML=`\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.inputCount")}</span>\n\t\t\t\t\t<span class="stat-value">${t.count}${$("verticalKey.times")}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.avgAccuracy")}</span>\n\t\t\t\t\t<span class="stat-value accuracy-${e}">${t.averageAccuracy.toFixed(1)} ¬± ${t.standardDeviation.toFixed(1)}%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.avgError")}</span>\n\t\t\t\t\t<span class="stat-value">${t.averageAbsoluteError.toFixed(1)}ms</span>\n\t\t\t\t</div>\n\t\t\t`}
//! Èï∑ÁÇπÁµ±Ë®à„ÇíË°®Á§∫„ÄÇ
const a=document.getElementById("dash-stats-content");if(a&&this.dashStats&&this.dashStats.count>0){const t=this.dashStats,e=this.getAccuracyClass(t.averageAccuracy);a.innerHTML=`\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.inputCount")}</span>\n\t\t\t\t\t<span class="stat-value">${t.count}${$("verticalKey.times")}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.avgAccuracy")}</span>\n\t\t\t\t\t<span class="stat-value accuracy-${e}">${t.averageAccuracy.toFixed(1)} ¬± ${t.standardDeviation.toFixed(1)}%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="stat-item">\n\t\t\t\t\t<span class="stat-label">${$("verticalKey.avgError")}</span>\n\t\t\t\t\t<span class="stat-value">${t.averageAbsoluteError.toFixed(1)}ms</span>\n\t\t\t\t</div>\n\t\t\t`}}getAccuracyClass(t){return t>=90?"excellent":t>=70?"good":t>=50?"fair":"poor"}updateKeyStatus(t){const e=document.getElementById("key-status");if(e){const n=e.querySelector(".value");n&&(n.textContent=$(t?"verticalKey.pressed":"verticalKey.released")),t?e.classList.add("active"):e.classList.remove("active")}}openSettingsModal(){
//! ÁèæÂú®„ÅÆË®≠ÂÆöÂÄ§„ÇíÂèñÂæó„ÄÇ
const t={volume:Math.round(100*this.audio.getVolume()),frequency:this.audio.getFrequency(),wpm:this.currentWPM,keyCode:this.keyCode},e={volume:this.audio.getVolume(),frequency:this.audio.getFrequency(),wpm:this.currentWPM,keyCode:this.keyCode};
//! Ë®≠ÂÆöÂ§âÊõ¥Ââç„ÅÆÂÄ§„Çí‰øùÂ≠òÔºà„Ç≠„É£„É≥„Çª„É´ÊôÇ„ÅÆÂæ©ÂÖÉÁî®Ôºâ„ÄÇ
//! „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫„ÄÇ
new i("vertical-key-settings-modal",r,t,{onSave:t=>{
//! Ë®≠ÂÆö„Çí‰øùÂ≠ò„ÄÇ
this.audio.setVolume(t.volume/100),this.audio.setFrequency(t.frequency),this.audio.setWPM(t.wpm),this.currentWPM=t.wpm,this.keyCode=t.keyCode,
//! localStorage„Å´‰øùÂ≠ò„ÄÇ
localStorage.setItem("verticalKeyWPM",this.currentWPM.toString()),localStorage.setItem("verticalKeyCode",this.keyCode);
//! „Çø„Ç§„Éü„É≥„Ç∞„ÇíÂÜçË®àÁÆó„Åó„Å¶„Éà„É¨„Éº„Éä„Éº„ÇíÂÜçÂàùÊúüÂåñ„ÄÇ
const e=s.calculate(this.currentWPM);this.trainer=new a(this.buffer,this.timer,e,{onKeyPress:()=>{this.audio.startContinuousTone()},onKeyRelease:()=>{this.audio.stopContinuousTone()},onTimingEvaluated:t=>{this.latestEvaluation=t,this.updateTimingStatistics()}});
//! ÁèæÂú®„ÅÆWPMË°®Á§∫„ÇíÊõ¥Êñ∞„ÄÇ
const n=document.getElementById("current-wpm");n&&(n.textContent=this.currentWPM.toString())},onCancel:()=>{
//! Ë®≠ÂÆö„ÇíÂÖÉ„Å´Êàª„Åô„ÄÇ
this.audio.setVolume(e.volume),this.audio.setFrequency(e.frequency),this.audio.setWPM(e.wpm),this.currentWPM=e.wpm,this.keyCode=e.keyCode}}).show("vertical-key")}destroy(){
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíÂâäÈô§„ÄÇ
this.keyPressHandler&&(window.removeEventListener("keydown",this.keyPressHandler),this.keyPressHandler=null),this.keyReleaseHandler&&(window.removeEventListener("keyup",this.keyReleaseHandler),this.keyReleaseHandler=null),
//! ÂÆöÊúüÊõ¥Êñ∞„ÇíÂÅúÊ≠¢„ÄÇ
null!==this.updateIntervalId&&(clearInterval(this.updateIntervalId),this.updateIntervalId=null),
//! Èü≥Â£∞„ÇíÂÅúÊ≠¢„ÄÇ
this.audio.stopContinuousTone(),
//! „Éà„É¨„Éº„Éä„Éº„Çí„ÇØ„É™„Ç¢„ÄÇ
this.trainer.clear()}}class k{trainer;buffer;timer;audio;timings;leftPressed=!1;rightPressed=!1;updateIntervalId=null;currentWPM=20;iambicMode="B";paddleLayout="normal";leftKeyCode="KeyJ";rightKeyCode="KeyK";keyPressHandler=null;keyReleaseHandler=null;languageSwitcher=new L;constructor(){
//! Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„ÇÄ„ÄÇ
const s=localStorage.getItem("horizontalKeyWPM");s&&(this.currentWPM=parseInt(s,10));const a=localStorage.getItem("horizontalKeyIambicMode");"A"!==a&&"B"!==a||(this.iambicMode=a);const i=localStorage.getItem("horizontalKeyPaddleLayout");"normal"!==i&&"reversed"!==i||(this.paddleLayout=i);const r=localStorage.getItem("horizontalKeyLeftCode");r&&(this.leftKeyCode=r);const o=localStorage.getItem("horizontalKeyRightCode");o&&(this.rightKeyCode=o),
//! „Ç≥„Ç¢„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÇíÂàùÊúüÂåñ„ÄÇ
this.buffer=new t,this.timer=new e,this.audio=new n({frequency:700,volume:.5,wpm:this.currentWPM}),
//! „Éà„É¨„Éº„Éä„Éº„ÇíÂàùÊúüÂåñ„ÄÇ
this.initializeTrainer()}initializeTrainer(){this.timings=s.calculate(this.currentWPM),this.trainer=new o(this.buffer,this.timer,this.timings,{onElementStart:(t,e)=>{
//! Ë¶ÅÁ¥†ÈÄÅ‰ø°ÈñãÂßãÊôÇ„Å´ÊåáÂÆöÊôÇÈñì„Å†„ÅëÈü≥„ÇíÈ≥¥„Çâ„Åô„ÄÇ
this.audio.scheduleTone(0,e)},onSpacingEvaluated:()=>{
//! „Çπ„Éö„Éº„Ç∑„É≥„Ç∞Ë©ï‰æ°„ÅåÂÆå‰∫Ü„Åó„Åü„ÇâÁîªÈù¢„ÇíÊõ¥Êñ∞„ÄÇ
this.updateDisplay()}},{iambicMode:this.iambicMode,paddleLayout:this.paddleLayout})}render(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t<h1>${$("horizontalKey.title")}</h1>\n\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="paddle-container">\n\t\t\t\t\t<button class="paddle-button dit" id="left-paddle">\n\t\t\t\t\t\t${$("horizontalKey.dit")}\n\t\t\t\t\t\t<span class="paddle-label">${$("horizontalKey.ditLabel")}</span>\n\t\t\t\t\t\t<span class="paddle-key">${$("horizontalKey.jKey")}</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="paddle-button dah" id="right-paddle">\n\t\t\t\t\t\t${$("horizontalKey.dah")}\n\t\t\t\t\t\t<span class="paddle-label">${$("horizontalKey.dahLabel")}</span>\n\t\t\t\t\t\t<span class="paddle-key">${$("horizontalKey.kKey")}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="practice-container">\n\t\t\t\t\t<div class="display-area">\n\t\t\t\t\t\t<div class="display-section">\n\t\t\t\t\t\t\t<h3>${$("horizontalKey.morseSignal")}</h3>\n\t\t\t\t\t\t\t<div class="display-output morse-buffer" id="morse-buffer">${$("horizontalKey.morseBufferPlaceholder")}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="display-section">\n\t\t\t\t\t\t\t<h3>${$("horizontalKey.decodedResult")}</h3>\n\t\t\t\t\t\t\t<div class="display-output" id="decoded-text">${$("horizontalKey.decodedTextPlaceholder")}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="action-area">\n\t\t\t\t\t\t<button class="btn btn-large btn-danger" id="clear-btn">${$("horizontalKey.clear")}</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="status-area">\n\t\t\t\t\t\t<div class="status-item">\n\t\t\t\t\t\t\t<span class="label">${$("horizontalKey.currentSpeed")}</span>\n\t\t\t\t\t\t\t<span class="value" id="current-wpm">${this.currentWPM}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="status-item">\n\t\t\t\t\t\t\t<span class="label">${$("horizontalKey.iambicMode")}</span>\n\t\t\t\t\t\t\t<span class="value" id="current-iambic-mode">${this.iambicMode}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="status-item">\n\t\t\t\t\t\t\t<span class="label">${$("horizontalKey.charCount")}</span>\n\t\t\t\t\t\t\t<span class="value" id="char-count">0</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="timing-diagram-section">\n\t\t\t\t\t\t<h3>${$("horizontalKey.timingDiagramTitle")}</h3>\n\t\t\t\t\t\t<div id="timing-diagram-content" class="timing-diagram-content">\n\t\t\t\t\t\t\t${$("horizontalKey.timingDiagramPlaceholder")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="timing-diagram-section timing-evaluation-section">\n\t\t\t\t\t\t<h3>${$("horizontalKey.spacingEvaluation")}</h3>\n\t\t\t\t\t\t<div class="timing-stats-grid">\n\t\t\t\t\t\t\t<div class="timing-stat-card">\n\t\t\t\t\t\t\t\t<div class="timing-stat-label">${$("horizontalKey.avgAccuracy")}</div>\n\t\t\t\t\t\t\t\t<div class="timing-stat-value" id="timing-avg-accuracy">--%</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="timing-stat-card">\n\t\t\t\t\t\t\t\t<div class="timing-stat-label">${$("horizontalKey.avgError")}</div>\n\t\t\t\t\t\t\t\t<div class="timing-stat-value" id="timing-avg-error">--ms</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="timing-stat-card">\n\t\t\t\t\t\t\t\t<div class="timing-stat-label">${$("horizontalKey.evaluationCount")}</div>\n\t\t\t\t\t\t\t\t<div class="timing-stat-value" id="timing-count">0</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="timing-element-stats">\n\t\t\t\t\t\t\t<div class="timing-element-stat">\n\t\t\t\t\t\t\t\t<h4>${$("horizontalKey.charSpacing")}</h4>\n\t\t\t\t\t\t\t\t<div class="timing-element-detail">\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.expected")} <span id="timing-char-expected">--ms</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.accuracy")} <span id="timing-char-accuracy">--%</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.error")} <span id="timing-char-error">--ms</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.count")} <span id="timing-char-count">0</span></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="timing-element-stat">\n\t\t\t\t\t\t\t\t<h4>${$("horizontalKey.wordSpacing")}</h4>\n\t\t\t\t\t\t\t\t<div class="timing-element-detail">\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.expected")} <span id="timing-word-expected">--ms</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.accuracy")} <span id="timing-word-accuracy">--%</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.error")} <span id="timing-word-error">--ms</span></span>\n\t\t\t\t\t\t\t\t\t<span>${$("horizontalKey.count")} <span id="timing-word-count">0</span></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>${$("horizontalKey.howToUse")}</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>${$("horizontalKey.instruction1")}</li>\n\t\t\t\t\t\t\t<li>${$("horizontalKey.instruction2")}</li>\n\t\t\t\t\t\t\t<li>${$("horizontalKey.instruction3")}</li>\n\t\t\t\t\t\t\t<li>${$("horizontalKey.instruction4")}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
this.attachEventListeners(),
//! ÂÆöÊúüÊõ¥Êñ∞„ÇíÈñãÂßã„ÄÇ
this.startUpdate())}attachEventListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
const t=document.querySelector(".back-btn");t?.addEventListener("click",()=>{window.location.hash="#menu"}),
//! Ë®≠ÂÆö„Ç¢„Ç§„Ç≥„É≥„ÄÇ
document.getElementById("settingsIcon")?.addEventListener("click",()=>{this.openSettingsModal()});
//! „ÇØ„É™„Ç¢„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("clear-btn");e?.addEventListener("click",()=>{this.trainer.clear(),this.updateDisplay()}),
//! „Ç≠„Éº„Éú„Éº„Éâ„Ç§„Éô„É≥„ÉàÔºàË®≠ÂÆö„Åï„Çå„Åü„Ç≠„ÉºÔºâ„ÄÇ
this.keyPressHandler=t=>{t.repeat||(t.code===this.leftKeyCode?(t.preventDefault(),this.handleLeftPaddlePress()):t.code===this.rightKeyCode&&(t.preventDefault(),this.handleRightPaddlePress()))},this.keyReleaseHandler=t=>{t.code===this.leftKeyCode?(t.preventDefault(),this.handleLeftPaddleRelease()):t.code===this.rightKeyCode&&(t.preventDefault(),this.handleRightPaddleRelease())},window.addEventListener("keydown",this.keyPressHandler),window.addEventListener("keyup",this.keyReleaseHandler);
//! „Éú„Çø„É≥„Ç§„Éô„É≥„ÉàÔºàÂ∑¶„Éë„Éâ„É´Ôºâ„ÄÇ
const n=document.getElementById("left-paddle");n&&(n.addEventListener("mousedown",t=>{t.preventDefault(),this.handleLeftPaddlePress()}),n.addEventListener("mouseup",t=>{t.preventDefault(),this.handleLeftPaddleRelease()}),n.addEventListener("mouseleave",()=>{this.leftPressed&&this.handleLeftPaddleRelease()}),n.addEventListener("touchstart",t=>{t.preventDefault(),this.handleLeftPaddlePress()}),n.addEventListener("touchend",t=>{t.preventDefault(),this.handleLeftPaddleRelease()}),n.addEventListener("touchcancel",()=>{this.leftPressed&&this.handleLeftPaddleRelease()}));
//! „Éú„Çø„É≥„Ç§„Éô„É≥„ÉàÔºàÂè≥„Éë„Éâ„É´Ôºâ„ÄÇ
const s=document.getElementById("right-paddle");s&&(s.addEventListener("mousedown",t=>{t.preventDefault(),this.handleRightPaddlePress()}),s.addEventListener("mouseup",t=>{t.preventDefault(),this.handleRightPaddleRelease()}),s.addEventListener("mouseleave",()=>{this.rightPressed&&this.handleRightPaddleRelease()}),s.addEventListener("touchstart",t=>{t.preventDefault(),this.handleRightPaddlePress()}),s.addEventListener("touchend",t=>{t.preventDefault(),this.handleRightPaddleRelease()}),s.addEventListener("touchcancel",()=>{this.rightPressed&&this.handleRightPaddleRelease()}));
//! LanguageSwitcher„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
const a=document.getElementById("languageSwitcherContainer");a&&this.languageSwitcher.attachEventListeners(a)}handleLeftPaddlePress(){if(this.leftPressed)return;this.leftPressed=!0,this.trainer.leftPaddlePress();const t=document.getElementById("left-paddle");t&&t.classList.add("pressed")}handleLeftPaddleRelease(){if(!this.leftPressed)return;this.leftPressed=!1,this.trainer.leftPaddleRelease();const t=document.getElementById("left-paddle");t&&t.classList.remove("pressed")}handleRightPaddlePress(){if(this.rightPressed)return;this.rightPressed=!0,this.trainer.rightPaddlePress();const t=document.getElementById("right-paddle");t&&t.classList.add("pressed")}handleRightPaddleRelease(){if(!this.rightPressed)return;this.rightPressed=!1,this.trainer.rightPaddleRelease();const t=document.getElementById("right-paddle");t&&t.classList.remove("pressed")}updatePaddleLabels(){const t=document.getElementById("left-paddle"),e=document.getElementById("right-paddle");"normal"===this.paddleLayout?(t&&(t.className="paddle-button dit",t.innerHTML='\n\t\t\t\t\tDIT\n\t\t\t\t\t<span class="paddle-label">(Áü≠ÁÇπ)</span>\n\t\t\t\t\t<span class="paddle-key">J „Ç≠„Éº</span>\n\t\t\t\t'),e&&(e.className="paddle-button dah",e.innerHTML='\n\t\t\t\t\tDAH\n\t\t\t\t\t<span class="paddle-label">(Èï∑ÁÇπ)</span>\n\t\t\t\t\t<span class="paddle-key">K „Ç≠„Éº</span>\n\t\t\t\t')):(t&&(t.className="paddle-button dah",t.innerHTML='\n\t\t\t\t\tDAH\n\t\t\t\t\t<span class="paddle-label">(Èï∑ÁÇπ)</span>\n\t\t\t\t\t<span class="paddle-key">J „Ç≠„Éº</span>\n\t\t\t\t'),e&&(e.className="paddle-button dit",e.innerHTML='\n\t\t\t\t\tDIT\n\t\t\t\t\t<span class="paddle-label">(Áü≠ÁÇπ)</span>\n\t\t\t\t\t<span class="paddle-key">K „Ç≠„Éº</span>\n\t\t\t\t')),
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíÂÜçË®≠ÂÆö„ÄÇ
this.attachEventListeners()}startUpdate(){
//! 100ms„Åî„Å®„Å´ÁîªÈù¢„ÇíÊõ¥Êñ∞„ÄÇ
this.updateIntervalId=window.setInterval(()=>{this.updateDisplay()},100)}updateDisplay(){const t=document.getElementById("morse-buffer"),e=document.getElementById("decoded-text"),n=document.getElementById("char-count");if(t){const e=this.trainer.getBuffer(),n=this.trainer.getSequence(),s=n?`${e} ${n}`:e;t.textContent=s||$("horizontalKey.morseBufferPlaceholder")}if(e){const t=this.trainer.getDecoded();e.textContent=t||$("horizontalKey.decodedTextPlaceholder")}if(n){const t=this.trainer.getDecoded();n.textContent=t.length.toString()}
//! „Çπ„Éö„Éº„Ç∑„É≥„Ç∞Ë©ï‰æ°Áµ±Ë®à„ÇíÊõ¥Êñ∞„ÄÇ
const s=this.trainer.getSpacingStatistics(),a=this.trainer.getStatisticsBySpacingType(),i=document.getElementById("timing-avg-accuracy"),r=document.getElementById("timing-avg-error"),o=document.getElementById("timing-count");i&&(i.textContent=s.count>0?`${s.averageAccuracy.toFixed(1)} ¬± ${s.standardDeviation.toFixed(1)}%`:"--%"),r&&(r.textContent=s.count>0?`${Math.round(s.averageAbsoluteError)}ms`:"--ms"),o&&(o.textContent=s.count.toString());
//! ÊñáÂ≠óÈñì„Çπ„Éö„Éº„ÇπÁµ±Ë®à„ÄÇ
const c=document.getElementById("timing-char-expected"),l=document.getElementById("timing-char-accuracy"),d=document.getElementById("timing-char-error"),u=document.getElementById("timing-char-count");c&&(c.textContent=`${Math.round(this.timings.charGap)}ms`),l&&(l.textContent=a.character.count>0?`${a.character.averageAccuracy.toFixed(1)} ¬± ${a.character.standardDeviation.toFixed(1)}%`:"--%"),d&&(d.textContent=a.character.count>0?`${Math.round(a.character.averageAbsoluteError)}ms`:"--ms"),u&&(u.textContent=a.character.count.toString());
//! ÂçòË™ûÈñì„Çπ„Éö„Éº„ÇπÁµ±Ë®à„ÄÇ
const h=document.getElementById("timing-word-expected"),p=document.getElementById("timing-word-accuracy"),m=document.getElementById("timing-word-error"),g=document.getElementById("timing-word-count");h&&(h.textContent=`${Math.round(this.timings.wordGap)}ms`),p&&(p.textContent=a.word.count>0?`${a.word.averageAccuracy.toFixed(1)} ¬± ${a.word.standardDeviation.toFixed(1)}%`:"--%"),m&&(m.textContent=a.word.count>0?`${Math.round(a.word.averageAbsoluteError)}ms`:"--ms"),g&&(g.textContent=a.word.count.toString()),
//! „Çø„Ç§„Éü„É≥„Ç∞Âõ≥„ÇíÊõ¥Êñ∞„ÄÇ
this.updateTimingDiagram()}updateTimingDiagram(){const t=this.trainer.getLastWordTimingData(),e=document.getElementById("timing-diagram-content");if(!e)return;if(!t)return void(e.innerHTML="ÔºàÊñáÂ≠ó„ÅåÁ¢∫ÂÆö„Åô„Çã„Å®Ë°®Á§∫„Åï„Çå„Åæ„ÅôÔºâ");
//! „Çø„Ç§„Éü„É≥„Ç∞Âõ≥HTML„ÇíÁîüÊàê„ÄÇ
const n=this.generateTimingDiagramHTML(t);e.innerHTML=n}generateTimingDiagramHTML(t){
//! „Çø„Ç§„Éü„É≥„Ç∞„ÉÅ„É£„Éº„ÉàÔºàPlantUMLÈ¢®Ôºâ„ÇíÁîüÊàê„ÄÇ
const e=this.generateTimingChart(t);return`\n\t\t\t<div class="timing-diagram-header">\n\t\t\t\t<span class="timing-diagram-char">${t.decodedChar}</span>\n\t\t\t\t<span class="timing-diagram-morse">${t.morseCode}</span>\n\t\t\t</div>\n\t\t\t${e}\n\t\t`}generateTimingChart(t){if(0===t.paddleInputs.length)return'<div class="timing-chart-empty">Ôºà„Éë„Éâ„É´ÂÖ•Âäõ„Éá„Éº„Çø„Å™„ÅóÔºâ</div>';
//! „Éë„Éâ„É´ÂÖ•Âäõ„Ç§„Éô„É≥„Éà„ÇíÊôÇÂàªÈ†Ü„Å´„ÇΩ„Éº„Éà„ÄÇ
const e=[...t.paddleInputs].sort((t,e)=>t.timestamp-e.timestamp),n=[...e.map(t=>t.timestamp),...t.elements.map(t=>t.startTime),...t.elements.map(t=>t.endTime),...t.squeezeIntervals.flatMap(t=>[t.startTime,t.endTime])],s=Math.min(...n),a=Math.max(...n)-s,i=this.generatePaddleSignalLine("left",t,s,a),r=this.generatePaddleSignalLine("right",t,s,a),o=this.generateOutputSignalLine(t,s,a),c=t.squeezeIntervals.map(t=>`<div class="squeeze-highlight" style="left: ${(t.startTime-s)/a*100}%; width: ${(t.endTime-t.startTime)/a*100}%"></div>`).join(""),l=[];
//! ÊôÇÈñìÁØÑÂõ≤„ÇíÊ±∫ÂÆöÔºàÊúÄÂàù„ÅÆ„Ç§„Éô„É≥„Éà„Åã„ÇâÊúÄÂæå„ÅÆ„Ç§„Éô„É≥„Éà„Åæ„ÅßÔºâ„ÄÇ
let d=!1,u=!1,h=null;for(const p of e){const t=!d&&!u;"left"===p.paddle?d="press"===p.state:u="press"===p.state;const e=!d&&!u;t&&!e?
//! „ÇÆ„É£„ÉÉ„ÉóÁµÇ‰∫ÜÔºà„Å©„Å°„Çâ„Åã„ÅÆ„Éë„Éâ„É´„ÅåÊäº„Åï„Çå„ÅüÔºâ„ÄÇ
null!==h&&(l.push({startTime:h,endTime:p.timestamp}),h=null):!t&&e&&(
//! „ÇÆ„É£„ÉÉ„ÉóÈñãÂßãÔºà‰∏°Êñπ„ÅÆ„Éë„Éâ„É´„ÅåËß£Êîæ„Åï„Çå„ÅüÔºâ„ÄÇ
h=p.timestamp)}
//! „ÇÆ„É£„ÉÉ„Éó„ÅÆ„Éè„Ç§„É©„Ç§„Éà„ÇíÁîüÊàê„ÄÇ
return`\n\t\t\t<div class="timing-chart-section">\n\t\t\t\t<h4>„Çø„Ç§„Éü„É≥„Ç∞„ÉÅ„É£„Éº„Éà</h4>\n\t\t\t\t<div class="timing-chart-container">\n\t\t\t\t\t<div class="timing-chart-signals">\n\t\t\t\t\t\t<div class="squeeze-highlights-layer">\n\t\t\t\t\t\t\t${c}\n\t\t\t\t\t\t\t${l.map(t=>`<div class="gap-highlight" style="left: ${(t.startTime-s)/a*100}%; width: ${(t.endTime-t.startTime)/a*100}%"></div>`).join("")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${i}\n\t\t\t\t\t\t${r}\n\t\t\t\t\t\t${o}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="timing-chart-axis">${this.generateTimeAxis(a)}</div>\n\t\t\t\t</div>\n\t\t\t\t${this.generateDebugInfo(t,s,l)}\n\t\t\t</div>\n\t\t`}generatePaddleSignalLine(t,e,n,s){const a="left"===t?"DitÂÖ•Âäõ":"DashÂÖ•Âäõ",i=e.paddleInputs.filter(e=>e.paddle===t).sort((t,e)=>t.timestamp-e.timestamp);
//! Ë©≤ÂΩì„Éë„Éâ„É´„ÅÆ„Ç§„Éô„É≥„Éà„ÇíÊäΩÂá∫„Åó„Å¶ÊôÇÂàªÈ†Ü„Å´„ÇΩ„Éº„Éà„ÄÇ
//! ‰ø°Âè∑„ÅÆÁä∂ÊÖãÂ§âÂåñ„ÇíÊôÇÁ≥ªÂàó„ÅßËøΩË∑°„ÄÇ
let r=!1;const o=[];let c=n;for(const l of i)l.timestamp>c&&o.push({start:c,end:l.timestamp,high:r}),r="press"===l.state,c=l.timestamp;o.push({start:c,end:n+s,high:r});return`\n\t\t\t<div class="timing-chart-signal">\n\t\t\t\t<div class="signal-label">${a}</div>\n\t\t\t\t<div class="signal-timeline">${o.map(t=>{const e=(t.start-n)/s*100,a=(t.end-t.start)/s*100;return`<div class="signal-segment ${t.high?"signal-high":"signal-low"}" style="left: ${e}%; width: ${a}%"></div>`}).join("")}</div>\n\t\t\t</div>\n\t\t`}generateOutputSignalLine(t,e,n){
//! Ë¶ÅÁ¥†„ÅÆÈÄÅ‰ø°ÊúüÈñì„Çí„Çª„Ç∞„É°„É≥„Éà„Å®„Åó„Å¶ÁîüÊàêÔºàÊôÇÂàªÈ†Ü„Å´„ÇΩ„Éº„ÉàÔºâ„ÄÇ
const s=[];for(const r of t.elements)s.push({start:r.startTime,end:r.endTime,element:r.element});
//! ÈñãÂßãÊôÇÂàªÈ†Ü„Å´„ÇΩ„Éº„Éà„ÄÇ
s.sort((t,e)=>t.start-e.start);
//! „Çª„Ç∞„É°„É≥„Éà„ÇíHTML„Å´Â§âÊèõ„ÄÇ
let a=e;const i=[];for(const r of s){if(r.start>a){const t=(a-e)/n*100,s=(r.start-a)/n*100;i.push(`<div class="signal-segment signal-low" style="left: ${t}%; width: ${s}%"></div>`)}const t=(r.start-e)/n*100,s=(r.end-r.start)/n*100,o="."===r.element?"output-dit":"output-dah";i.push(`<div class="signal-segment signal-high ${o}" style="left: ${t}%; width: ${s}%">\n\t\t\t\t\t<span class="element-label">${r.element}</span>\n\t\t\t\t</div>`),a=r.end}if(a<e+n){const t=(a-e)/n*100,s=(e+n-a)/n*100;i.push(`<div class="signal-segment signal-low" style="left: ${t}%; width: ${s}%"></div>`)}return`\n\t\t\t<div class="timing-chart-signal">\n\t\t\t\t<div class="signal-label">Âá∫Âäõ</div>\n\t\t\t\t<div class="signal-timeline">${i.join("")}</div>\n\t\t\t</div>\n\t\t`}generateTimeAxis(t){const e=t/4;return`\n\t\t\t<span class="axis-tick" style="left: 0%">0ms</span>\n\t\t\t<span class="axis-tick" style="left: 25%">${Math.round(e)}ms</span>\n\t\t\t<span class="axis-tick" style="left: 50%">${Math.round(2*e)}ms</span>\n\t\t\t<span class="axis-tick" style="left: 75%">${Math.round(3*e)}ms</span>\n\t\t\t<span class="axis-tick" style="left: 100%">${Math.round(t)}ms</span>\n\t\t`}generateDebugInfo(t,e,n){
//! „Éë„Éâ„É´ÂÖ•Âäõ„Ç§„Éô„É≥„Éà„Çí„ÇΩ„Éº„Éà„Åó„Å¶Êï¥ÁêÜ„ÄÇ
const s=[...t.paddleInputs].sort((t,e)=>t.timestamp-e.timestamp).map(t=>{const n=t.timestamp-e,s="left"===t.paddle?"Dit":"Dash",a="press"===t.state?"Êäº‰∏ã":"Ëß£Êîæ";return`${n.toFixed(0)}ms: ${s}${a}`}),a=t.squeezeIntervals.map(t=>{const n=t.startTime-e,s=t.endTime-e,a=t.endTime-t.startTime;return`Squeeze ON: ${n.toFixed(0)}ms, OFF: ${s.toFixed(0)}ms (${a.toFixed(0)}ms)`}),i=n.map(t=>{const n=t.startTime-e,s=t.endTime-e,a=t.endTime-t.startTime;return`Gap ON: ${n.toFixed(0)}ms, OFF: ${s.toFixed(0)}ms (${a.toFixed(0)}ms)`});
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éà„ÇíÁîüÊàê„ÄÇ
return`\n\t\t\t<div class="timing-debug-info">\n\t\t\t\t<div class="debug-section">\n\t\t\t\t\t<h5>„Éë„Éâ„É´ÂÖ•Âäõ„Ç§„Éô„É≥„ÉàÔºàÁõ∏ÂØæÊôÇÂàªÔºâ</h5>\n\t\t\t\t\t<div class="debug-events">\n\t\t\t\t\t\t${s.length>0?s.join("<br>"):"Ôºà„Ç§„Éô„É≥„Éà„Å™„ÅóÔºâ"}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="debug-section">\n\t\t\t\t\t<h5>„Çπ„ÇØ„Ç§„Éº„Ç∫Âå∫Èñì</h5>\n\t\t\t\t\t<div class="debug-squeezes">\n\t\t\t\t\t\t${a.length>0?a.join("<br>"):"Ôºà„Çπ„ÇØ„Ç§„Éº„Ç∫„Å™„ÅóÔºâ"}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="debug-section">\n\t\t\t\t\t<h5>ÁÑ°ÂÖ•ÂäõÊúüÈñì</h5>\n\t\t\t\t\t<div class="debug-gaps">\n\t\t\t\t\t\t${i.length>0?i.join("<br>"):"Ôºà„ÇÆ„É£„ÉÉ„Éó„Å™„ÅóÔºâ"}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}openSettingsModal(){
//! ÁèæÂú®„ÅÆË®≠ÂÆöÂÄ§„ÇíÂèñÂæó„ÄÇ
const t={volume:Math.round(100*this.audio.getVolume()),frequency:this.audio.getFrequency(),wpm:this.currentWPM,iambicMode:this.iambicMode,paddleLayout:this.paddleLayout,leftKeyCode:this.leftKeyCode,rightKeyCode:this.rightKeyCode},e={volume:this.audio.getVolume(),frequency:this.audio.getFrequency(),wpm:this.currentWPM,iambicMode:this.iambicMode,paddleLayout:this.paddleLayout,leftKeyCode:this.leftKeyCode,rightKeyCode:this.rightKeyCode};
//! Ë®≠ÂÆöÂ§âÊõ¥Ââç„ÅÆÂÄ§„Çí‰øùÂ≠òÔºà„Ç≠„É£„É≥„Çª„É´ÊôÇ„ÅÆÂæ©ÂÖÉÁî®Ôºâ„ÄÇ
//! „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫„ÄÇ
new i("horizontal-key-settings-modal",r,t,{onSave:t=>{
//! Ë®≠ÂÆö„Çí‰øùÂ≠ò„ÄÇ
this.audio.setVolume(t.volume/100),this.audio.setFrequency(t.frequency),this.audio.setWPM(t.wpm),this.currentWPM=t.wpm,this.iambicMode=t.iambicMode,this.paddleLayout=t.paddleLayout,this.leftKeyCode=t.leftKeyCode,this.rightKeyCode=t.rightKeyCode,
//! localStorage„Å´‰øùÂ≠ò„ÄÇ
localStorage.setItem("horizontalKeyWPM",this.currentWPM.toString()),localStorage.setItem("horizontalKeyIambicMode",this.iambicMode),localStorage.setItem("horizontalKeyPaddleLayout",this.paddleLayout),localStorage.setItem("horizontalKeyLeftCode",this.leftKeyCode),localStorage.setItem("horizontalKeyRightCode",this.rightKeyCode);
//! ÁèæÂú®„ÅÆWPMË°®Á§∫„ÇíÊõ¥Êñ∞„ÄÇ
const e=document.getElementById("current-wpm");e&&(e.textContent=this.currentWPM.toString());
//! ÁèæÂú®„ÅÆIambic„É¢„Éº„ÉâË°®Á§∫„ÇíÊõ¥Êñ∞„ÄÇ
const n=document.getElementById("current-iambic-mode");n&&(n.textContent=this.iambicMode),
//! „Éë„Éâ„É´„É¨„Ç§„Ç¢„Ç¶„Éà„Å´Âøú„Åò„Å¶„É©„Éô„É´„ÇíÊõ¥Êñ∞„ÄÇ
this.updatePaddleLabels(),
//! „Éà„É¨„Éº„Éä„Éº„ÇíÂÜçÂàùÊúüÂåñ„ÄÇ
this.initializeTrainer()},onCancel:()=>{
//! Ë®≠ÂÆö„ÇíÂÖÉ„Å´Êàª„Åô„ÄÇ
this.audio.setVolume(e.volume),this.audio.setFrequency(e.frequency),this.audio.setWPM(e.wpm),this.currentWPM=e.wpm,this.iambicMode=e.iambicMode,this.paddleLayout=e.paddleLayout,this.leftKeyCode=e.leftKeyCode,this.rightKeyCode=e.rightKeyCode}}).show("horizontal-key")}destroy(){
//! „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíÂâäÈô§„ÄÇ
this.keyPressHandler&&(window.removeEventListener("keydown",this.keyPressHandler),this.keyPressHandler=null),this.keyReleaseHandler&&(window.removeEventListener("keyup",this.keyReleaseHandler),this.keyReleaseHandler=null),
//! ÂÆöÊúüÊõ¥Êñ∞„ÇíÂÅúÊ≠¢„ÄÇ
null!==this.updateIntervalId&&(clearInterval(this.updateIntervalId),this.updateIntervalId=null),
//! „Éà„É¨„Éº„Éä„Éº„Çí„ÇØ„É™„Ç¢„ÄÇ
this.trainer.clear()}}async function I(t){
//! TSV„Éï„Ç°„Ç§„É´„ÇíÂèñÂæó„ÄÇ
const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load flashcard data: ${e.statusText}`);return function(t){
//! Ë°å„Å´ÂàÜÂâ≤„ÄÇ
const e=t.split("\n").filter(t=>t.trim());if(0===e.length)return[];
//! ÂÖàÈ†≠Ë°å„ÅØ„Éò„ÉÉ„ÉÄ„Éº„Å™„ÅÆ„Åß„Çπ„Ç≠„ÉÉ„Éó„ÄÇ
return e.slice(1).map((t,e)=>{
//! „Çø„Éñ„ÅßÂàÜÂâ≤„ÄÇ
const n=t.split("\t");
//! ÊúÄ‰ΩéÈôê6ÂàóÔºà„Çø„Ç∞„ÄÅÈ†ªÂ∫¶„ÄÅÁï•Ë™û„ÄÅËã±Êñá„ÄÅÂíåË®≥„ÄÅË™¨ÊòéÔºâÂøÖË¶Å„ÄÇ
if(n.length<6)return null;return{tags:n[0].trim(),frequency:parseInt(n[1].trim(),10)||1,abbreviation:n[2].trim(),english:n[3].trim(),japanese:n[4].trim(),description:n[5]?.trim(),example:n[6]?.trim()}}).filter(t=>null!==t)}(await e.text())}class T{languageSwitcher=new L;allEntries=[];filteredEntries=[];currentState="loading";selectedTags=new Set;selectedFrequencies=new Set([5]);searchQuery="";displayMode="card";sortColumn="abbreviation";sortDirection="asc";learnQuestionType="abbr-to-meaning";learnCards=[];currentLearnIndex=0;isFlipped=!1;reviewMode=!1;progress={known:new Set,unknown:new Set};questionType="abbr-to-meaning";questionCount=10;questions=[];currentQuestionIndex=0;results=[];audio;currentlyPlaying=null;constructor(){this.audio=new n({frequency:700,volume:.5,wpm:20}),
//! „É©„Ç§„Éñ„É©„É™„Åã„ÇâÁä∂ÊÖã„ÇíË™≠„ÅøËæº„ÇÄ„ÄÇ
this.progress=c.loadProgress();const t=c.loadFilters();this.selectedTags=t.selectedTags,this.selectedFrequencies=t.selectedFrequencies,this.searchQuery=t.searchQuery;const e=c.loadViewState();this.displayMode=e.displayMode,this.sortColumn=e.sortColumn,this.sortDirection=e.sortDirection,this.learnQuestionType=e.learnQuestionType,this.questionType=e.examQuestionType}saveProgress(){c.saveProgress(this.progress)}clearProgress(){this.progress={known:new Set,unknown:new Set},c.clearProgress()}saveFilters(){c.saveFilters({selectedTags:this.selectedTags,selectedFrequencies:this.selectedFrequencies,searchQuery:this.searchQuery})}async render(){const t=document.getElementById("app");if(t)if("loading"===this.currentState){
//! „É≠„Éº„Éá„Ç£„É≥„Ç∞ÁîªÈù¢„ÇíË°®Á§∫„ÄÇ
t.innerHTML=`\n\t\t\t\t<div class="container">\n\t\t\t\t\t<header class="header">\n\t\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t\t<h1>${$("flashcard.title")}</h1>\n\t\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</header>\n\t\t\t\t\t<div class="loading-container">\n\t\t\t\t\t\t<p>${$("flashcard.loading")}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;const n=document.querySelector(".back-btn");n?.addEventListener("click",()=>{window.location.hash="#menu"});
//! „Éá„Éº„Çø„Çí„É≠„Éº„Éâ„ÄÇ
try{this.allEntries=await I("/flashcard.tsv"),this.updateFilteredEntries();
//! „Éá„Éº„Çø„É≠„Éº„ÉâÂÆå‰∫ÜÂæå„ÄÅ‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„ÅüviewMode„ÇíÂæ©ÂÖÉ„ÄÇ
const t=c.loadViewState();this.currentState=t.viewMode,this.render()}catch(e){t.innerHTML=`\n\t\t\t\t\t<div class="container">\n\t\t\t\t\t\t<header class="header">\n\t\t\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t\t\t<h1>${$("flashcard.title")}</h1>\n\t\t\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</header>\n\t\t\t\t\t\t<div class="error-container">\n\t\t\t\t\t\t\t<p>${$("flashcard.loadError")}</p>\n\t\t\t\t\t\t\t<p>${$("flashcard.error")} ${e}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`}}else"browse"===this.currentState?this.renderBrowseMode():"learn"===this.currentState?this.renderLearnMode():"exam"===this.currentState?this.renderExamMode():"exam-result"===this.currentState&&this.renderExamResultMode()}renderFilterSection(){const t=l.getAllTags(this.allEntries);return`\n\t\t\t<div class="filter-section">\n\t\t\t\t<h3>${$("flashcard.filter.title")}</h3>\n\n\t\t\t\t<div class="filter-group">\n\t\t\t\t\t<label>${$("flashcard.filter.tagLabel")}</label>\n\t\t\t\t\t<div class="tag-filter" id="tag-filter">\n\t\t\t\t\t\t${t.map(t=>`\n\t\t\t\t\t\t\t<label class="tag-checkbox">\n\t\t\t\t\t\t\t\t<input type="checkbox" value="${t}" ${this.selectedTags.has(t)?"checked":""}>\n\t\t\t\t\t\t\t\t<span>${t}</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="filter-group">\n\t\t\t\t\t<label>${$("flashcard.filter.frequencyLabel")}</label>\n\t\t\t\t\t<div class="frequency-filter" id="frequency-filter">\n\t\t\t\t\t\t${[5,4,3,2,1].map(t=>`\n\t\t\t\t\t\t\t<label class="frequency-checkbox">\n\t\t\t\t\t\t\t\t<input type="checkbox" value="${t}" ${this.selectedFrequencies.has(t)?"checked":""}>\n\t\t\t\t\t\t\t\t<span>‚òÖ${t}</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="filter-group">\n\t\t\t\t\t<label for="search-input">${$("flashcard.filter.searchLabel")}</label>\n\t\t\t\t\t<input type="text" id="search-input" class="search-input" placeholder="${$("flashcard.filter.searchPlaceholder")}" value="${this.searchQuery}">\n\t\t\t\t</div>\n\n\t\t\t\t<div class="filter-stats">\n\t\t\t\t\t<span>${$("flashcard.filter.filteredCount")} <strong id="filtered-count">${this.filteredEntries.length}</strong> ${$("flashcard.filter.items")}</span>\n\t\t\t\t\t<span>${$("flashcard.filter.totalCount")} <strong>${this.allEntries.length}</strong> ${$("flashcard.filter.items")}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}renderBrowseMode(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t<h1>${$("flashcard.title")}</h1>\n\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="tabs">\n\t\t\t\t\t<button class="tab-button active" data-tab="browse">${$("flashcard.tabs.browse")}</button>\n\t\t\t\t\t<button class="tab-button" data-tab="learn">${$("flashcard.tabs.learn")}</button>\n\t\t\t\t\t<button class="tab-button" data-tab="exam">${$("flashcard.tabs.exam")}</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="flashcard-container">\n\t\t\t\t\t${this.renderFilterSection()}\n\n\t\t\t\t\t<div class="entries-section" id="entries-section">\n\t\t\t\t\t\t\x3c!-- „Åì„Åì„Å´‰∏ÄË¶ß„ÅåË°®Á§∫„Åï„Çå„Çã --\x3e\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>${$("flashcard.browse.howToUse")}</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction1")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction2")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction3")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction4")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction5")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.browse.instruction6")}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.renderEntries(),this.attachBrowseModeListeners())}renderEntries(){const t=document.getElementById("entries-section");t&&("card"===this.displayMode?this.renderCardView(t):this.renderListView(t))}renderCardView(t){t.innerHTML=`\n\t\t\t<div class="entries-header">\n\t\t\t\t<h3>${$("flashcard.browse.entriesHeader")} (${this.filteredEntries.length}${$("flashcard.browse.entriesCount")})</h3>\n\t\t\t\t<button id="toggle-display-btn" class="toggle-display-btn">${$("flashcard.browse.toggleList")}</button>\n\t\t\t</div>\n\t\t\t<div class="entries-grid">\n\t\t\t\t${this.filteredEntries.map(t=>`\n\t\t\t\t\t<div class="entry-card ${this.currentlyPlaying===t.abbreviation?"playing":""}" data-abbr="${t.abbreviation}">\n\t\t\t\t\t\t<div class="entry-header">\n\t\t\t\t\t\t\t<div class="entry-abbr">${this.formatAbbreviation(t.abbreviation)}</div>\n\t\t\t\t\t\t\t<div class="entry-frequency" title="${$("flashcard.filter.frequencyLabel")}: ${t.frequency}/5">${"‚òÖ".repeat(t.frequency)}${"‚òÜ".repeat(5-t.frequency)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="entry-english">${t.english}</div>\n\t\t\t\t\t\t<div class="entry-japanese">${t.japanese}</div>\n\t\t\t\t\t\t${t.description?`<div class="entry-description">${t.description}</div>`:""}\n\t\t\t\t\t\t${t.example?`<div class="entry-example">${$("flashcard.browse.examplePrefix")}${t.example}</div>`:""}\n\t\t\t\t\t\t<div class="entry-tags">${t.tags}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`).join("")}\n\t\t\t</div>\n\t\t`,
//! „Ç´„Éº„Éâ„ÇØ„É™„ÉÉ„ÇØ„Åß„É¢„Éº„É´„ÇπÂÜçÁîü„ÄÇ
t.querySelectorAll(".entry-card").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-abbr");e&&this.playMorse(e)})});
//! Ë°®Á§∫„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("toggle-display-btn");e&&e.addEventListener("click",()=>{this.displayMode="list",c.saveDisplayMode(this.displayMode),this.renderEntries()})}renderListView(t){t.innerHTML=`\n\t\t\t<div class="entries-header">\n\t\t\t\t<h3>${$("flashcard.browse.entriesHeader")} (${this.filteredEntries.length}${$("flashcard.browse.entriesCount")})</h3>\n\t\t\t\t<button id="toggle-display-btn" class="toggle-display-btn">${$("flashcard.browse.toggleCard")}</button>\n\t\t\t</div>\n\t\t\t<div class="list-table-container">\n\t\t\t\t<table class="list-table">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th class="sortable" data-column="abbreviation">${$("flashcard.browse.tableHeaders.abbreviation")}${this.getSortIndicator("abbreviation")}</th>\n\t\t\t\t\t\t\t<th class="sortable" data-column="english">${$("flashcard.browse.tableHeaders.english")}${this.getSortIndicator("english")}</th>\n\t\t\t\t\t\t\t<th class="sortable" data-column="japanese">${$("flashcard.browse.tableHeaders.japanese")}${this.getSortIndicator("japanese")}</th>\n\t\t\t\t\t\t\t<th class="sortable" data-column="frequency">${$("flashcard.browse.tableHeaders.frequency")}${this.getSortIndicator("frequency")}</th>\n\t\t\t\t\t\t\t<th class="sortable" data-column="tags">${$("flashcard.browse.tableHeaders.tags")}${this.getSortIndicator("tags")}</th>\n\t\t\t\t\t\t\t<th>${$("flashcard.browse.tableHeaders.description")}</th>\n\t\t\t\t\t\t\t<th>${$("flashcard.browse.tableHeaders.example")}</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t${this.filteredEntries.map(t=>`\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class="list-abbr">\n\t\t\t\t\t\t\t\t\t<button class="abbr-play-btn ${this.currentlyPlaying===t.abbreviation?"playing":""}" data-abbr="${t.abbreviation}">\n\t\t\t\t\t\t\t\t\t\t${this.formatAbbreviation(t.abbreviation)}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>${t.english}</td>\n\t\t\t\t\t\t\t\t<td>${t.japanese}</td>\n\t\t\t\t\t\t\t\t<td title="${$("flashcard.filter.frequencyLabel")}: ${t.frequency}/5">${"‚òÖ".repeat(t.frequency)}${"‚òÜ".repeat(5-t.frequency)}</td>\n\t\t\t\t\t\t\t\t<td>${t.tags}</td>\n\t\t\t\t\t\t\t\t<td>${t.description||""}</td>\n\t\t\t\t\t\t\t\t<td>${t.example||""}</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t`;t.querySelectorAll("th.sortable").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-column");e&&this.toggleSort(e)})});t.querySelectorAll(".abbr-play-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-abbr");e&&this.playMorse(e)})});
//! Ë°®Á§∫„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("toggle-display-btn");e&&e.addEventListener("click",()=>{this.displayMode="card",c.saveDisplayMode(this.displayMode),this.renderEntries()})}renderLearnMode(){0===this.learnCards.length?
//! „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢„ÇíË°®Á§∫„ÄÇ
this.renderLearnSetup():
//! Â≠¶Áøí„Ç´„Éº„Éâ„ÇíË°®Á§∫„ÄÇ
this.renderLearnCard()}renderLearnSetup(){const t=document.getElementById("app");if(!t)return;
//! „Ç´„Éº„ÉâÊûöÊï∞„ÇíË®àÁÆó„ÄÇ
let e=this.filteredEntries.length;this.reviewMode&&(e=this.filteredEntries.filter(t=>this.progress.unknown.has(t.abbreviation)).length),t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<div class="header-top">\n\t\t\t\t\t\t<button class="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t\t<h1>${$("flashcard.title")}</h1>\n\t\t\t\t\t\t<div id="languageSwitcherContainer">\n\t\t\t\t\t\t\t${this.languageSwitcher.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="tabs">\n\t\t\t\t\t<button class="tab-button" data-tab="browse">${$("flashcard.tabs.browse")}</button>\n\t\t\t\t\t<button class="tab-button active" data-tab="learn">${$("flashcard.tabs.learn")}</button>\n\t\t\t\t\t<button class="tab-button" data-tab="exam">${$("flashcard.tabs.exam")}</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="flashcard-container">\n\t\t\t\t\t${this.renderFilterSection()}\n\n\t\t\t\t\t<div class="learn-setup-section">\n\t\t\t\t\t\t<h3>${$("flashcard.learn.setupTitle")}</h3>\n\n\t\t\t\t\t\t<div class="filter-group">\n\t\t\t\t\t\t\t<label>${$("flashcard.learn.modeLabel")}</label>\n\t\t\t\t\t\t\t<div class="mode-buttons">\n\t\t\t\t\t\t\t\t<button class="mode-btn ${this.reviewMode?"active":""}" id="review-mode-btn">\n\t\t\t\t\t\t\t\t\t${$("flashcard.learn.reviewMode")}${this.progress.unknown.size}${$("flashcard.learn.reviewModeCount")}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="filter-group">\n\t\t\t\t\t\t\t<label>${$("flashcard.learn.questionTypeLabel")}</label>\n\t\t\t\t\t\t\t<div class="question-type-buttons">\n\t\t\t\t\t\t\t\t<button class="question-type-btn ${"abbr-to-meaning"===this.learnQuestionType?"active":""}" data-type="abbr-to-meaning">${$("flashcard.learn.questionTypes.abbrToMeaning")}</button>\n\t\t\t\t\t\t\t\t<button class="question-type-btn ${"meaning-to-abbr"===this.learnQuestionType?"active":""}" data-type="meaning-to-abbr">${$("flashcard.learn.questionTypes.meaningToAbbr")}</button>\n\t\t\t\t\t\t\t\t<button class="question-type-btn ${"morse-to-abbr"===this.learnQuestionType?"active":""}" data-type="morse-to-abbr">${$("flashcard.learn.questionTypes.morseToAbbr")}</button>\n\t\t\t\t\t\t\t\t<button class="question-type-btn ${"morse-to-meaning"===this.learnQuestionType?"active":""}" data-type="morse-to-meaning">${$("flashcard.learn.questionTypes.morseToMeaning")}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="filter-stats">\n\t\t\t\t\t\t\t<span>${$("flashcard.learn.availableCards")} <strong>${e}</strong> ${$("flashcard.learn.cardsUnit")}</span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="action-area">\n\t\t\t\t\t\t\t<button class="btn btn-large btn-primary" id="start-learn-btn" ${0===e?"disabled":""}>${$("flashcard.learn.startButton")}</button>\n\t\t\t\t\t\t\t<button class="btn btn-large btn-secondary" id="clear-progress-btn">${$("flashcard.learn.clearProgressButton")}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>${$("flashcard.learn.howToUse")}</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>${$("flashcard.learn.instruction1")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.learn.instruction2")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.learn.instruction3")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.learn.instruction4")}</li>\n\t\t\t\t\t\t\t<li>${$("flashcard.learn.instruction5")}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachCommonListeners(),this.attachLearnSetupListeners()}attachLearnSetupListeners(){
//! „Çø„Ç∞„Éï„Ç£„É´„Çø„Éº„ÄÇ
const t=document.getElementById("tag-filter");t?.addEventListener("change",t=>{const e=t.target;"checkbox"===e.type&&(e.checked?this.selectedTags.add(e.value):this.selectedTags.delete(e.value),this.updateFilteredEntries(),this.renderLearnSetup())});
//! ‰ΩøÁî®È†ªÂ∫¶„Éï„Ç£„É´„Çø„Éº„ÄÇ
const e=document.getElementById("frequency-filter");e?.addEventListener("change",t=>{const e=t.target;if("checkbox"===e.type){const t=parseInt(e.value,10);e.checked?this.selectedFrequencies.add(t):this.selectedFrequencies.delete(t),this.updateFilteredEntries(),this.renderLearnSetup()}});
//! Ê§úÁ¥¢„ÄÇ
const n=document.getElementById("learn-search-input");n?.addEventListener("input",()=>{this.searchQuery=n.value,this.updateFilteredEntries(),this.renderLearnSetup()});
//! Âæ©Áøí„É¢„Éº„Éâ„Éú„Çø„É≥„ÄÇ
const s=document.getElementById("review-mode-btn");s?.addEventListener("click",()=>{this.reviewMode=!this.reviewMode,this.renderLearnSetup()});document.querySelectorAll(".question-type-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-type");e&&(this.learnQuestionType=e,c.saveLearnQuestionType(this.learnQuestionType),this.renderLearnSetup())})});
//! Â≠¶ÁøíÈñãÂßã„Éú„Çø„É≥„ÄÇ
const a=document.getElementById("start-learn-btn");a?.addEventListener("click",()=>{this.startLearn()});
//! ÈÄ≤Êçó„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥„ÄÇ
const i=document.getElementById("clear-progress-btn");i?.addEventListener("click",()=>{confirm($("flashcard.learn.confirmReset"))&&(this.clearProgress(),this.renderLearnSetup())})}startLearn(){
//! „Éï„Ç£„É´„Çø„É™„É≥„Ç∞Ê∏à„Åø„ÅÆ„Ç®„É≥„Éà„É™„Éº„Åã„ÇâÂ≠¶Áøí„Ç´„Éº„Éâ„Çí‰ΩúÊàê„ÄÇ
let t=[...this.filteredEntries];this.reviewMode&&(
//! Âæ©Áøí„É¢„Éº„Éâ: „Çè„Åã„Çâ„Å™„ÅÑ„Ç´„Éº„Éâ„ÅÆ„Åø„ÄÇ
t=t.filter(t=>this.progress.unknown.has(t.abbreviation))),0!==t.length?(
//! „Ç∑„É£„ÉÉ„Éï„É´„ÄÇ
t=t.sort(()=>Math.random()-.5),this.learnCards=t,this.currentLearnIndex=0,this.isFlipped=!1,this.renderLearnCard()):alert($("flashcard.learn.noCards"))}renderLearnCard(){const t=document.getElementById("app");if(!t)return;const e=this.learnCards[this.currentLearnIndex],n=this.currentLearnIndex+1,s=this.learnCards.length;
//! ÂïèÈ°å„Å®Ê≠£Ëß£„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÁîüÊàê„ÄÇ
let a="",i="";switch(this.learnQuestionType){case"abbr-to-meaning":a=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.abbreviation")}</div>\n\t\t\t\t\t<div class="card-content-abbr">${this.formatAbbreviation(e.abbreviation)}</div>\n\t\t\t\t`,i=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.meaning")}</div>\n\t\t\t\t\t<div class="card-content-text">${e.english}</div>\n\t\t\t\t\t<div class="card-content-text">${e.japanese}</div>\n\t\t\t\t`;break;case"meaning-to-abbr":a=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.meaning")}</div>\n\t\t\t\t\t<div class="card-content-text">${e.english}</div>\n\t\t\t\t\t<div class="card-content-text">${e.japanese}</div>\n\t\t\t\t`,i=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.abbreviation")}</div>\n\t\t\t\t\t<div class="card-content-abbr">${this.formatAbbreviation(e.abbreviation)}</div>\n\t\t\t\t`;break;case"morse-to-abbr":a=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.morseToAbbrPrompt")}</div>\n\t\t\t\t\t<button class="play-morse-btn" id="play-morse-btn">${$("flashcard.learn.playMorseButton")}</button>\n\t\t\t\t`,i=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.abbreviation")}</div>\n\t\t\t\t\t<div class="card-content-abbr">${this.formatAbbreviation(e.abbreviation)}</div>\n\t\t\t\t`;break;case"morse-to-meaning":a=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.morseToMeaningPrompt")}</div>\n\t\t\t\t\t<button class="play-morse-btn" id="play-morse-btn">${$("flashcard.learn.playMorseButton")}</button>\n\t\t\t\t`,i=`\n\t\t\t\t\t<div class="card-label">${$("flashcard.learn.cardLabels.meaning")}</div>\n\t\t\t\t\t<div class="card-content-abbr">${this.formatAbbreviation(e.abbreviation)}</div>\n\t\t\t\t\t<div class="card-content-text">${e.english}</div>\n\t\t\t\t\t<div class="card-content-text">${e.japanese}</div>\n\t\t\t\t`}
//! Âà§ÂÆö„Éú„Çø„É≥„ÅÆHTML„ÄÇ
const r=this.progress.known.has(e.abbreviation),o=`\n\t\t\t<div class="judgment-controls">\n\t\t\t\t<button id="mark-unknown-btn" class="judgment-button unknown ${this.progress.unknown.has(e.abbreviation)?"active":""}">\n\t\t\t\t\t${$("flashcard.learn.judgmentButtons.unknown")}\n\t\t\t\t</button>\n\t\t\t\t<button id="mark-known-btn" class="judgment-button known ${r?"active":""}">\n\t\t\t\t\t${$("flashcard.learn.judgmentButtons.known")}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;t.innerHTML=`\n\t\t\t<div class="container learning-view">\n\t\t\t\t<div class="learning-header">\n\t\t\t\t\t<button id="back-to-setup-btn" class="back-btn">${$("flashcard.learn.backToSetup")}</button>\n\t\t\t\t\t<div class="progress-indicator">${n}${$("flashcard.learn.progressIndicator")}${s}</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-container">\n\t\t\t\t\t<div class="flashcard ${this.isFlipped?"flipped":""}" id="flashcard">\n\t\t\t\t\t\t<div class="card-front">\n\t\t\t\t\t\t\t${a}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="card-back">\n\t\t\t\t\t\t\t${i}\n\t\t\t\t\t\t\t${e.description?`<div class="card-description">${e.description}</div>`:""}\n\t\t\t\t\t\t\t${e.example?`<div class="card-example">${$("flashcard.browse.examplePrefix")}${e.example}</div>`:""}\n\t\t\t\t\t\t\t<div class="card-tags">${e.tags} / ${"‚òÖ".repeat(e.frequency)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="card-controls">\n\t\t\t\t\t<button id="flip-card-btn" class="control-button">\n\t\t\t\t\t\t${this.isFlipped?$("flashcard.learn.flipToQuestion"):$("flashcard.learn.flipToAnswer")} ${$("flashcard.learn.spaceHint")}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t${this.isFlipped?o:""}\n\n\t\t\t\t<div class="navigation-controls">\n\t\t\t\t\t<button id="prev-card-btn" class="nav-button" ${0===this.currentLearnIndex?"disabled":""}>\n\t\t\t\t\t\t${$("flashcard.learn.navigation.prev")}\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="next-card-btn" class="nav-button" ${this.currentLearnIndex>=this.learnCards.length-1?"disabled":""}>\n\t\t\t\t\t\t${$("flashcard.learn.navigation.next")}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachLearnCardListeners()}attachLearnCardListeners(){
//! Ë®≠ÂÆö„Å´Êàª„Çã„Éú„Çø„É≥„ÄÇ
const t=document.getElementById("back-to-setup-btn");t?.addEventListener("click",()=>{this.learnCards=[],this.currentLearnIndex=0,this.isFlipped=!1,this.renderLearnSetup()});
//! „Éï„É™„ÉÉ„Éó„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("flip-card-btn");e?.addEventListener("click",()=>{this.isFlipped=!this.isFlipped,this.renderLearnCard()});document.addEventListener("keydown",t=>{"Space"===t.code&&t.target===document.body&&(t.preventDefault(),this.isFlipped=!this.isFlipped,this.renderLearnCard())});
//! „É¢„Éº„É´„ÇπÂÜçÁîü„Éú„Çø„É≥„ÄÇ
const n=document.getElementById("play-morse-btn");n&&n.addEventListener("click",()=>{const t=this.learnCards[this.currentLearnIndex];this.playMorse(t.abbreviation)});
//! Âà§ÂÆö„Éú„Çø„É≥Ôºà„Çè„Åã„Çâ„Å™„ÅÑÔºâ„ÄÇ
const s=document.getElementById("mark-unknown-btn");s?.addEventListener("click",()=>{const t=this.learnCards[this.currentLearnIndex];this.progress.unknown.add(t.abbreviation),this.progress.known.delete(t.abbreviation),this.saveProgress(),this.moveToNextCard()});
//! Âà§ÂÆö„Éú„Çø„É≥Ôºà„Çè„Åã„ÇãÔºâ„ÄÇ
const a=document.getElementById("mark-known-btn");a?.addEventListener("click",()=>{const t=this.learnCards[this.currentLearnIndex];this.progress.known.add(t.abbreviation),this.progress.unknown.delete(t.abbreviation),this.saveProgress(),this.moveToNextCard()});
//! Ââç„ÅÆ„Ç´„Éº„Éâ„Éú„Çø„É≥„ÄÇ
const i=document.getElementById("prev-card-btn");i?.addEventListener("click",()=>{this.currentLearnIndex>0&&(this.currentLearnIndex--,this.isFlipped=!1,this.renderLearnCard())});
//! Ê¨°„ÅÆ„Ç´„Éº„Éâ„Éú„Çø„É≥„ÄÇ
const r=document.getElementById("next-card-btn");r?.addEventListener("click",()=>{this.currentLearnIndex<this.learnCards.length-1&&(this.currentLearnIndex++,this.isFlipped=!1,this.renderLearnCard())})}moveToNextCard(){this.currentLearnIndex<this.learnCards.length-1?(
//! Ê¨°„ÅÆ„Ç´„Éº„Éâ„Åå„ÅÇ„Çå„Å∞ÁßªÂãï„ÄÇ
this.currentLearnIndex++,this.isFlipped=!1,this.renderLearnCard()):(
//! ÊúÄÂæå„ÅÆ„Ç´„Éº„Éâ„ÅÆÂ†¥Âêà„ÅØÂ≠¶ÁøíÂÆå‰∫Ü„ÄÇ
alert($("flashcard.learn.completed")),this.learnCards=[],this.currentLearnIndex=0,this.isFlipped=!1,this.renderLearnSetup())}renderExamMode(){document.getElementById("app")&&(0===this.questions.length?this.renderExamSetup():this.renderExamQuestion())}renderExamSetup(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<button class="back-btn">„É°„Éã„É•„Éº„Å´Êàª„Çã</button>\n\t\t\t\t\t<h1>CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí</h1>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="tabs">\n\t\t\t\t\t<button class="tab-button" data-tab="browse">‰∏ÄË¶ß</button>\n\t\t\t\t\t<button class="tab-button" data-tab="learn">Â≠¶Áøí„É¢„Éº„Éâ</button>\n\t\t\t\t\t<button class="tab-button active" data-tab="exam">Ë©¶È®ì„É¢„Éº„Éâ</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="flashcard-container">\n\t\t\t\t\t${this.renderFilterSection()}\n\n\t\t\t\t\t<div class="exam-setup-section">\n\t\t\t\t\t\t<h3>Âá∫È°åÂΩ¢Âºè</h3>\n\t\t\t\t\t\t<div class="question-type-buttons">\n\t\t\t\t\t\t\t<button class="question-type-btn ${"abbr-to-meaning"===this.questionType?"active":""}" data-type="abbr-to-meaning">Áï•Ë™û‚ÜíÊÑèÂë≥ÔºàÂü∫Á§éÔºâ</button>\n\t\t\t\t\t\t\t<button class="question-type-btn ${"meaning-to-abbr"===this.questionType?"active":""}" data-type="meaning-to-abbr">ÊÑèÂë≥‚ÜíÁï•Ë™ûÔºàÂøúÁî®Ôºâ</button>\n\t\t\t\t\t\t\t<button class="question-type-btn ${"morse-to-abbr"===this.questionType?"active":""}" data-type="morse-to-abbr">„É¢„Éº„É´„ÇπÈü≥‚ÜíÁï•Ë™ûÔºàÂÆüË∑µÔºâ</button>\n\t\t\t\t\t\t\t<button class="question-type-btn ${"morse-to-meaning"===this.questionType?"active":""}" data-type="morse-to-meaning">„É¢„Éº„É´„ÇπÈü≥‚ÜíÊÑèÂë≥ÔºàÂÆüË∑µÔºâ</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<h3>ÂïèÈ°åÊï∞</h3>\n\t\t\t\t\t\t<div class="question-count-buttons">\n\t\t\t\t\t\t\t<button class="question-count-btn ${5===this.questionCount?"active":""}" data-count="5">5Âïè</button>\n\t\t\t\t\t\t\t<button class="question-count-btn ${10===this.questionCount?"active":""}" data-count="10">10Âïè</button>\n\t\t\t\t\t\t\t<button class="question-count-btn ${20===this.questionCount?"active":""}" data-count="20">20Âïè</button>\n\t\t\t\t\t\t\t<button class="question-count-btn ${50===this.questionCount?"active":""}" data-count="50">50Âïè</button>\n\t\t\t\t\t\t\t<button class="question-count-btn ${"all"===this.questionCount?"active":""}" data-count="all">ÂÖ®Âïè</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="action-area">\n\t\t\t\t\t\t\t<button class="btn btn-large btn-primary" id="start-exam-btn">Ë©¶È®ìÈñãÂßã</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>‰Ωø„ÅÑÊñπ</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>„Éï„Ç£„É´„Çø„Éº„ÅßÂá∫È°åÁØÑÂõ≤„ÇíÁµû„ÇäËæº„Åø„Åæ„Åô</li>\n\t\t\t\t\t\t\t<li>Âá∫È°åÂΩ¢Âºè„ÇíÈÅ∏Êäû„Åó„Åæ„ÅôÔºàÁï•Ë™û‚ÜíÊÑèÂë≥„ÄÅÊÑèÂë≥‚ÜíÁï•Ë™û„ÄÅ„É¢„Éº„É´„ÇπÈü≥„Åã„ÇâÔºâ</li>\n\t\t\t\t\t\t\t<li>ÂïèÈ°åÊï∞„ÇíÈÅ∏Êäû„Åó„Åæ„ÅôÔºà5Âïè„ÄúÂÖ®ÂïèÔºâ</li>\n\t\t\t\t\t\t\t<li>4„Å§„ÅÆÈÅ∏ÊäûËÇ¢„Åã„ÇâÊ≠£Ëß£„ÇíÈÅ∏„Å≥„Åæ„Åô</li>\n\t\t\t\t\t\t\t<li>80%‰ª•‰∏ä„ÅßÂêàÊ†º„Åß„Åô</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachExamSetupListeners())}renderExamQuestion(){const t=document.getElementById("app");if(!t)return;const e=this.questions[this.currentQuestionIndex],n=this.currentQuestionIndex+1,s=this.questions.length;let a="";switch(e.type){case"abbr-to-meaning":a=`Ê¨°„ÅÆÁï•Ë™û„ÅÆÊÑèÂë≥„ÅØÔºü<br><strong class="question-text">${e.entry.abbreviation}</strong>`;break;case"meaning-to-abbr":a=`Ê¨°„ÅÆÊÑèÂë≥„ÇíË°®„ÅôÁï•Ë™û„ÅØÔºü<br><strong class="question-text">${e.entry.english} / ${e.entry.japanese}</strong>`;break;case"morse-to-abbr":a='„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶„ÄÅÂØæÂøú„Åô„ÇãÁï•Ë™û„ÅØÔºü<br><button id="replay-morse-btn" class="btn btn-secondary">üîä „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÂÜçÁîü</button>';break;case"morse-to-meaning":a='„É¢„Éº„É´„ÇπÈü≥„ÇíËÅû„ÅÑ„Å¶„ÄÅÂØæÂøú„Åô„ÇãÊÑèÂë≥„ÅØÔºü<br><button id="replay-morse-btn" class="btn btn-secondary">üîä „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÂÜçÁîü</button>'}t.innerHTML=`\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<h1>CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí - Ë©¶È®ì‰∏≠</h1>\n\t\t\t\t\t<button class="back-btn">‰∏≠Êñ≠</button>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="exam-container">\n\t\t\t\t\t<div class="exam-progress">\n\t\t\t\t\t\t<span>ÂïèÈ°å <strong>${n}</strong> / ${s}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="question-area">\n\t\t\t\t\t\t<p class="question">${a}</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="choices-area">\n\t\t\t\t\t\t${e.choices.map((t,e)=>`\n\t\t\t\t\t\t\t<button class="choice-btn" data-choice="${t}">\n\t\t\t\t\t\t\t\t${e+1}. ${t}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachExamQuestionListeners(),
//! „É¢„Éº„É´„ÇπÈü≥„ÅåÂøÖË¶Å„Å™Â†¥Âêà„ÅØËá™ÂãïÂÜçÁîü„ÄÇ
"morse-to-abbr"!==e.type&&"morse-to-meaning"!==e.type||setTimeout(()=>this.playMorse(e.entry.abbreviation),500)}renderExamResultMode(){const t=document.getElementById("app");if(!t)return;const e=l.calculateScore(this.results),n=l.isPassed(e.percentage),s=l.getWrongAnswers(this.results);t.innerHTML=`\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<h1>CWÁï•Ë™û„ÉªQÁ¨¶Âè∑Â≠¶Áøí - ÁµêÊûú</h1>\n\t\t\t\t\t<button class="back-btn">„É°„Éã„É•„Éº„Å´Êàª„Çã</button>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="result-container">\n\t\t\t\t\t<div class="score-area ${n?"passed":"failed"}">\n\t\t\t\t\t\t<h2>${n?"ÂêàÊ†ºÔºÅ":"‰∏çÂêàÊ†º"}</h2>\n\t\t\t\t\t\t<div class="score-display">\n\t\t\t\t\t\t\t<span class="score-percentage">${e.percentage}%</span>\n\t\t\t\t\t\t\t<span class="score-detail">${e.correct} / ${e.total} ÂïèÊ≠£Ëß£</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t${s.length>0?`\n\t\t\t\t\t\t<div class="wrong-answers-section">\n\t\t\t\t\t\t\t<h3>ÈñìÈÅï„Åà„ÅüÂïèÈ°åÔºà${s.length}‰ª∂Ôºâ</h3>\n\t\t\t\t\t\t\t<div class="wrong-answers-list">\n\t\t\t\t\t\t\t\t${this.results.filter(t=>!t.isCorrect).map(t=>`\n\t\t\t\t\t\t\t\t\t<div class="wrong-answer-item">\n\t\t\t\t\t\t\t\t\t\t<div class="wrong-answer-question">\n\t\t\t\t\t\t\t\t\t\t\t<strong>${t.question.entry.abbreviation}</strong>\n\t\t\t\t\t\t\t\t\t\t\t<span>${t.question.entry.english} / ${t.question.entry.japanese}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="wrong-answer-detail">\n\t\t\t\t\t\t\t\t\t\t\t<span class="wrong-label">„ÅÇ„Å™„Åü„ÅÆÂõûÁ≠î:</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="wrong-user-answer">${t.userAnswer}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="correct-label">Ê≠£Ëß£:</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="correct-answer">${t.question.correctAnswer}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t${t.question.entry.description?`\n\t\t\t\t\t\t\t\t\t\t\t<div class="wrong-answer-description">\n\t\t\t\t\t\t\t\t\t\t\t\t${t.question.entry.description}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`:'\n\t\t\t\t\t\t<div class="perfect-score">\n\t\t\t\t\t\t\t<p>„Åô„Åπ„Å¶Ê≠£Ëß£„Åó„Åæ„Åó„ÅüÔºÅ</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t'}\n\n\t\t\t\t\t<div class="action-area">\n\t\t\t\t\t\t<button class="btn btn-primary btn-large" id="retry-btn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶</button>\n\t\t\t\t\t\t<button class="btn btn-secondary btn-large" id="back-to-setup-btn">Ë®≠ÂÆö„Å´Êàª„Çã</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachResultListeners()}attachBrowseModeListeners(){this.attachCommonListeners();
//! „Çø„Ç∞„Éï„Ç£„É´„Çø„Éº„ÄÇ
const t=document.getElementById("tag-filter");t?.addEventListener("change",t=>{const e=t.target;"checkbox"===e.type&&(e.checked?this.selectedTags.add(e.value):this.selectedTags.delete(e.value),this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount(),this.renderEntries())});
//! ‰ΩøÁî®È†ªÂ∫¶„Éï„Ç£„É´„Çø„Éº„ÄÇ
const e=document.getElementById("frequency-filter");e?.addEventListener("change",t=>{const e=t.target;if("checkbox"===e.type){const t=parseInt(e.value,10);e.checked?this.selectedFrequencies.add(t):this.selectedFrequencies.delete(t),this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount(),this.renderEntries()}});
//! Ê§úÁ¥¢„ÄÇ
const n=document.getElementById("search-input");n?.addEventListener("input",()=>{this.searchQuery=n.value,this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount(),this.renderEntries()})}attachExamSetupListeners(){this.attachCommonListeners();
//! „Çø„Ç∞„Éï„Ç£„É´„Çø„Éº„ÄÇ
const t=document.getElementById("tag-filter");t?.addEventListener("change",t=>{const e=t.target;"checkbox"===e.type&&(e.checked?this.selectedTags.add(e.value):this.selectedTags.delete(e.value),this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount())});
//! ‰ΩøÁî®È†ªÂ∫¶„Éï„Ç£„É´„Çø„Éº„ÄÇ
const e=document.getElementById("frequency-filter");e?.addEventListener("change",t=>{const e=t.target;if("checkbox"===e.type){const t=parseInt(e.value,10);e.checked?this.selectedFrequencies.add(t):this.selectedFrequencies.delete(t),this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount()}});
//! Ê§úÁ¥¢„ÄÇ
const n=document.getElementById("search-input");n?.addEventListener("input",()=>{this.searchQuery=n.value,this.saveFilters(),this.updateFilteredEntries(),this.updateFilteredCount()});document.querySelectorAll(".question-type-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-type");e&&(this.questionType=e,c.saveExamQuestionType(this.questionType),this.renderExamSetup())})});document.querySelectorAll(".question-count-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-count");e&&(this.questionCount="all"===e?"all":parseInt(e,10),this.renderExamSetup())})});
//! Ë©¶È®ìÈñãÂßã„Éú„Çø„É≥„ÄÇ
const s=document.getElementById("start-exam-btn");s?.addEventListener("click",()=>{this.startExam()})}attachExamQuestionListeners(){
//! ‰∏≠Êñ≠„Éú„Çø„É≥„ÄÇ
const t=document.querySelector(".back-btn");t?.addEventListener("click",()=>{confirm("Ë©¶È®ì„Çí‰∏≠Êñ≠„Åó„Å¶„É°„Éã„É•„Éº„Å´Êàª„Çä„Åæ„Åô„ÅãÔºü")&&(window.location.hash="#menu")});
//! „É¢„Éº„É´„ÇπÂÜçÁîü„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("replay-morse-btn");if(e){const t=this.questions[this.currentQuestionIndex];e.addEventListener("click",()=>{this.playMorse(t.entry.abbreviation)})}
//! ÈÅ∏ÊäûËÇ¢„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".choice-btn").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget.dataset.choice||"";this.handleAnswer(e)})})}attachResultListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
const t=document.querySelector(".back-btn");t?.addEventListener("click",()=>{window.location.hash="#menu"});
//! „ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éú„Çø„É≥„ÄÇ
const e=document.getElementById("retry-btn");e?.addEventListener("click",()=>{this.questions=[],this.results=[],this.currentQuestionIndex=0,this.currentState="exam",this.render()});
//! Ë®≠ÂÆö„Å´Êàª„Çã„Éú„Çø„É≥„ÄÇ
const n=document.getElementById("back-to-setup-btn");n?.addEventListener("click",()=>{this.questions=[],this.results=[],this.currentQuestionIndex=0,this.currentState="exam",this.render()})}attachCommonListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
const t=document.querySelector(".back-btn");t?.addEventListener("click",()=>{window.location.hash="#menu"}),
//! Ë®≠ÂÆö„Ç¢„Ç§„Ç≥„É≥„ÄÇ
document.getElementById("settingsIcon")?.addEventListener("click",()=>{this.openSettingsModal()});
//! Ë®ÄË™ûÂàá„ÇäÊõø„Åà„ÄÇ
const e=document.getElementById("languageSwitcherContainer");e&&this.languageSwitcher.attachEventListeners(e);
//! „Çø„ÉñÂàá„ÇäÊõø„Åà„ÄÇ
document.querySelectorAll(".tab-button").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-tab");"browse"===e?(this.currentState="browse",c.saveViewMode("browse"),this.render()):"learn"===e?(this.currentState="learn",c.saveViewMode("learn"),this.render()):"exam"===e&&(this.questions=[],this.results=[],this.currentQuestionIndex=0,this.currentState="exam",c.saveViewMode("exam"),this.render())})})}updateFilteredCount(){const t=document.getElementById("filtered-count");t&&(t.textContent=this.filteredEntries.length.toString());
//! ÂïèÈ°åÊï∞„ÅÆÊúÄÂ§ßÂÄ§„ÇÇÊõ¥Êñ∞ÔºàË©¶È®ì„É¢„Éº„Éâ„ÅÆÂ†¥ÂêàÔºâ„ÄÇ
const e=document.getElementById("question-count");e&&(e.max=this.filteredEntries.length.toString(),parseInt(e.value,10)>this.filteredEntries.length&&(e.value=this.filteredEntries.length.toString(),this.questionCount=this.filteredEntries.length))}updateFilteredEntries(){let t=this.allEntries;
//! „Çø„Ç∞„Åß„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„ÄÇ
t=l.filterByTags(t,this.selectedTags),
//! ‰ΩøÁî®È†ªÂ∫¶„Åß„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„ÄÇ
t=l.filterByFrequencies(t,this.selectedFrequencies),
//! Ê§úÁ¥¢„ÇØ„Ç®„É™„Åß„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„ÄÇ
t=l.filterByQuery(t,this.searchQuery),
//! „ÇΩ„Éº„ÉàÈÅ©Áî®„ÄÇ
this.filteredEntries=this.sortEntries(t)}sortEntries(t){const e="asc"===this.sortDirection;switch(this.sortColumn){case"abbreviation":return l.sortByAbbreviation(t,e);case"english":return l.sortByEnglish(t,e);case"japanese":return l.sortByJapanese(t,e);case"frequency":return l.sortByFrequency(t,e);case"tags":return l.sortByTags(t,e);default:return t}}toggleSort(t){this.sortColumn===t?
//! Âêå„ÅòÂàó„Å™„ÇâÊñπÂêë„ÇíÂèçËª¢„ÄÇ
this.sortDirection="asc"===this.sortDirection?"desc":"asc":(
//! Áï∞„Å™„ÇãÂàó„Å™„ÇâÊòáÈ†Ü„ÅßÈñãÂßã„ÄÇ
this.sortColumn=t,this.sortDirection="asc"),
//! „ÇΩ„Éº„ÉàÁä∂ÊÖã„Çí‰øùÂ≠ò„ÄÇ
c.saveSortState(this.sortColumn,this.sortDirection),this.updateFilteredEntries(),this.renderEntries()}getSortIndicator(t){return this.sortColumn!==t?"":"asc"===this.sortDirection?" ‚ñ≤":" ‚ñº"}formatAbbreviation(t){const e=t.match(/^\[([A-Z]+)\]$/);return e?`<span class="prosign">${e[1]}</span>`:t}async playMorse(t){try{
//! Êó¢„Å´ÂÜçÁîü‰∏≠„ÅÆÂ†¥Âêà„ÅØÂÅúÊ≠¢„ÄÇ
if(this.currentlyPlaying===t)return this.audio.stopContinuousTone(),this.currentlyPlaying=null,void this.renderEntries();
//! Âà•„ÅÆ„ÇÇ„ÅÆ„ÅåÂÜçÁîü‰∏≠„Å™„ÇâÂÅúÊ≠¢„ÄÇ
this.currentlyPlaying&&this.audio.stopContinuousTone(),this.currentlyPlaying=t,this.renderEntries();
//! „É¢„Éº„É´„ÇπÁ¨¶Âè∑„Å´Â§âÊèõ„ÄÇ
const e=d.textToMorse(t);if(e)
//! „Ç∑„É≥„Éó„É´„Å™ÂÜçÁîüÂÆüË£ÖÔºàscheduleTone„Çí‰ΩøÁî®Ôºâ„ÄÇ
for(const t of e)"."===t?(this.audio.scheduleTone(0,60),await new Promise(t=>setTimeout(t,120))):"-"===t?(this.audio.scheduleTone(0,180),await new Promise(t=>setTimeout(t,240))):" "===t&&await new Promise(t=>setTimeout(t,60));this.currentlyPlaying=null,this.renderEntries()}catch(e){this.currentlyPlaying=null,this.renderEntries()}}startExam(){if(0===this.filteredEntries.length)return void alert("Ë©≤ÂΩì„Åô„Çã„Ç®„É≥„Éà„É™„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Éï„Ç£„É´„Çø„Éº„ÇíË™øÊï¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ");const t="all"===this.questionCount?this.filteredEntries.length:this.questionCount,e=Math.min(t,this.filteredEntries.length);0!==e?(
//! ÂïèÈ°å„ÇíÁîüÊàê„ÄÇ
this.questions=l.generateExamQuestions(this.filteredEntries,this.questionType,e),this.currentQuestionIndex=0,this.results=[],this.render()):alert("ÂïèÈ°åÊï∞„Çí1‰ª•‰∏ä„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ")}handleAnswer(t){const e=this.questions[this.currentQuestionIndex],n=l.checkAnswer(e,t);
//! ÁµêÊûú„ÇíË®òÈå≤„ÄÇ
this.results.push({question:e,userAnswer:t,isCorrect:n}),
//! Ê¨°„ÅÆÂïèÈ°å„Å´ÈÄ≤„ÇÄ„ÅãÁµêÊûúË°®Á§∫„ÄÇ
this.currentQuestionIndex++,this.currentQuestionIndex<this.questions.length||(this.currentState="exam-result"),this.render()}openSettingsModal(){
//! ÁèæÂú®„ÅÆË®≠ÂÆöÂÄ§„ÇíÂèñÂæóÔºà0-100„ÅÆÁØÑÂõ≤„Å´Â§âÊèõÔºâ„ÄÇ
const t={volume:Math.round(100*this.audio.getVolume()),frequency:this.audio.getFrequency(),wpm:this.audio.getWPM()},e={volume:this.audio.getVolume(),frequency:this.audio.getFrequency(),wpm:this.audio.getWPM()};
//! Ë®≠ÂÆöÂ§âÊõ¥Ââç„ÅÆÂÄ§„Çí‰øùÂ≠òÔºà„Ç≠„É£„É≥„Çª„É´ÊôÇ„ÅÆÂæ©ÂÖÉÁî®Ôºâ„ÄÇ
//! „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫„ÄÇ
new i("flashcard-settings-modal",r,t,{onSave:t=>{
//! Ë®≠ÂÆö„Çí‰øùÂ≠ò„ÄÇ
this.audio.setVolume(t.volume/100),this.audio.setFrequency(t.frequency),this.audio.setWPM(t.wpm)},onCancel:()=>{
//! Ë®≠ÂÆö„ÇíÂÖÉ„Å´Êàª„Åô„ÄÇ
this.audio.setVolume(e.volume),this.audio.setFrequency(e.frequency),this.audio.setWPM(e.wpm)},onTestPlay:async()=>{
//! „ÉÜ„Çπ„ÉàÂÜçÁîü„ÄÇ
await this.playMorse("CQ")}}).show("flashcard")}destroy(){
//! Èü≥Â£∞„ÇíÂÅúÊ≠¢„ÄÇ
this.currentlyPlaying&&this.audio.stopContinuousTone()}}const P={characterSpeed:20,effectiveSpeed:15,frequency:700,volume:.7,practiceDuration:60,groupSize:5,showInput:!0};class B{audio;viewMode="learning";settings={...P};languageSwitcher=new L;state={currentLesson:1,isPlaying:!1,userInput:"",correctAnswer:"",groups:[],currentGroupIndex:0};customState={selectedChars:new Set,isCustomRunning:!1,customUserInput:"",customCorrectAnswer:"",customGroups:[],customCurrentGroupIndex:0,customIsPlaying:!1};constructor(){
//! Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„ÇÄ„ÄÇ
this.loadSettings(),this.loadProgress(),this.loadViewMode(),this.loadSelectedChars(),
//! AudioGenerator„ÇíÂàùÊúüÂåñ„ÄÇ
this.audio=new n({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed})}
//! ========== Ë®≠ÂÆöÁÆ°ÁêÜ ==========
loadSettings(){try{const t=localStorage.getItem("v10.koch.settings");t&&(this.settings={...P,...JSON.parse(t)})}catch(t){}}saveSettings(){try{localStorage.setItem("v10.koch.settings",JSON.stringify(this.settings))}catch(t){}}loadProgress(){try{const t=localStorage.getItem("v10.koch.currentLesson");t&&(this.state.currentLesson=parseInt(t,10))}catch(t){}}saveProgress(){try{localStorage.setItem("v10.koch.currentLesson",this.state.currentLesson.toString())}catch(t){}}loadViewMode(){try{const t=localStorage.getItem("v10.koch.viewMode");t&&["learning","custom"].includes(t)&&(this.viewMode=t)}catch(t){}}saveViewMode(){try{localStorage.setItem("v10.koch.viewMode",this.viewMode)}catch(t){}}loadSelectedChars(){try{const t=localStorage.getItem("v10.koch.selectedChars");if(t){const e=JSON.parse(t);this.customState.selectedChars=new Set(e)}}catch(t){}}saveSelectedChars(){try{const t=Array.from(this.customState.selectedChars);localStorage.setItem("v10.koch.selectedChars",JSON.stringify(t))}catch(t){}}
//! ========== „É¨„ÉÉ„Çπ„É≥ÁÆ°ÁêÜ ==========
async startLesson(){const t=u.getCharsForLesson(this.state.currentLesson),e={groupSize:this.settings.groupSize,duration:this.settings.practiceDuration,wpm:this.settings.characterSpeed};this.state.groups=u.generateRandomGroups(t,e),this.state.currentGroupIndex=0,this.state.userInput="",this.state.correctAnswer=this.state.groups.join(""),this.state.isPlaying=!1,
//! AudioGenerator„ÅÆË®≠ÂÆö„ÇíÊõ¥Êñ∞„ÄÇ
this.audio.updateSettings({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed}),this.renderPractice()}async playMorse(){if(!this.state.isPlaying){this.state.isPlaying=!0,this.state.currentGroupIndex=0,this.updateProgress(),this.updatePlaybackButtons();
//! „É¢„Éº„É´„Çπ‰ø°Âè∑„ÇíÂÜçÁîü„ÄÇ
for(let t=0;t<this.state.groups.length&&this.state.isPlaying;t++){const e=this.state.groups[t],n=d.textToMorse(e);await this.audio.playMorseString(n+" /"),this.state.currentGroupIndex=t+1,this.updateProgress()}this.state.isPlaying=!1,this.updatePlaybackButtons(),this.state.currentGroupIndex>=this.state.groups.length&&this.showResult()}}pauseMorse(){this.state.isPlaying=!1,this.audio.stopPlaying(),this.updatePlaybackButtons()}stopLesson(){this.state.isPlaying=!1,this.audio.stopPlaying(),this.render()}showResult(){const t=u.calculateAccuracy(this.state.correctAnswer,this.state.userInput),e=t>=90,n=document.getElementById("resultContainer");n&&(n.innerHTML=`\n\t\t\t<div class="result ${e?"passed":"failed"}">\n\t\t\t\t<h2>${$(e?"koch.result.passed":"koch.result.failed")}</h2>\n\t\t\t\t<div class="accuracy">${$("koch.result.accuracy")} ${t.toFixed(1)}%</div>\n\t\t\t\t<div class="comparison">\n\t\t\t\t\t<div>${$("koch.result.sent")} ${this.state.correctAnswer}</div>\n\t\t\t\t\t<div>${$("koch.result.input")} ${this.state.userInput||$("koch.result.noInput")}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="actions">\n\t\t\t\t\t${e?`<button class="btn primary" id="nextLessonBtn">${$("koch.result.nextLesson")}</button>`:""}\n\t\t\t\t\t<button class="btn" id="retryBtn">${$("koch.result.retry")}</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,e&&this.state.currentLesson<40&&(this.state.currentLesson++,this.saveProgress(),document.getElementById("nextLessonBtn")?.addEventListener("click",()=>{this.render()})),document.getElementById("retryBtn")?.addEventListener("click",()=>{this.render()}))}updateProgress(){const t=document.getElementById("lessonProgress"),e=document.getElementById("progressBar");if(t&&e){const n=this.state.currentGroupIndex/this.state.groups.length*100;t.textContent=`${$("koch.practice.progress")} ${this.state.currentGroupIndex}/${this.state.groups.length} (${n.toFixed(0)}%)`,e.style.width=`${n}%`}this.updatePlaybackButtons()}updatePlaybackButtons(){const t=document.getElementById("playBtn"),e=document.getElementById("pauseBtn");t&&e&&(this.state.isPlaying?(t.disabled=!0,e.disabled=!1):(t.disabled=!1,e.disabled=!0))}
//! ========== „Ç´„Çπ„Çø„É†„É¢„Éº„ÉâÁÆ°ÁêÜ ==========
async startCustom(){const t=Array.from(this.customState.selectedChars),e={groupSize:this.settings.groupSize,duration:this.settings.practiceDuration,wpm:this.settings.characterSpeed};this.customState.customGroups=u.generateRandomGroups(t,e),this.customState.customCurrentGroupIndex=0,this.customState.customUserInput="",this.customState.customCorrectAnswer=this.customState.customGroups.join(""),this.customState.customIsPlaying=!1,this.customState.isCustomRunning=!0,
//! AudioGenerator„ÅÆË®≠ÂÆö„ÇíÊõ¥Êñ∞„ÄÇ
this.audio.updateSettings({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed}),this.render(),this.renderCustomPractice()}async playCustomMorse(){if(!this.customState.customIsPlaying){this.customState.customIsPlaying=!0,this.customState.customCurrentGroupIndex=0,this.updateCustomProgress(),this.updateCustomPlaybackButtons();
//! „É¢„Éº„É´„Çπ‰ø°Âè∑„ÇíÂÜçÁîü„ÄÇ
for(let t=0;t<this.customState.customGroups.length&&this.customState.customIsPlaying;t++){const e=this.customState.customGroups[t],n=d.textToMorse(e);await this.audio.playMorseString(n+" /"),this.customState.customCurrentGroupIndex=t+1,this.updateCustomProgress()}this.customState.customIsPlaying=!1,this.updateCustomPlaybackButtons()}}pauseCustomMorse(){this.customState.customIsPlaying=!1,this.audio.stopPlaying(),this.updateCustomPlaybackButtons()}stopCustom(){this.customState.customIsPlaying=!1,this.audio.stopPlaying(),this.customState.isCustomRunning=!1,this.render()}updateCustomProgress(){const t=document.getElementById("customProgress"),e=document.getElementById("customProgressBar");if(t&&e){const n=this.customState.customCurrentGroupIndex/this.customState.customGroups.length*100;t.textContent=`${$("koch.practice.progress")} ${this.customState.customCurrentGroupIndex}/${this.customState.customGroups.length} (${n.toFixed(0)}%)`,e.style.width=`${n}%`}this.updateCustomPlaybackButtons()}updateCustomPlaybackButtons(){const t=document.getElementById("customPlayBtn"),e=document.getElementById("customPauseBtn");t&&e&&(this.customState.customIsPlaying?(t.disabled=!0,e.disabled=!1):(t.disabled=!1,e.disabled=!0))}showCustomResult(){const t=document.getElementById("customResultContainer");if(!t)return;
//! libÂÅ¥„ÅÆÈñ¢Êï∞„Çí‰ΩøÁî®„Åó„Å¶Ê≠£Á≠îÁéá„ÇíË®àÁÆó„ÄÇ
const e=u.calculateAccuracy(this.customState.customCorrectAnswer,this.customState.customUserInput),n=this.customState.customUserInput.replace(/\s+/g,""),s=this.customState.customCorrectAnswer.replace(/\s+/g,"");t.innerHTML=`\n\t\t\t<div class="result">\n\t\t\t\t<h2>${$("koch.result.customTitle")}</h2>\n\t\t\t\t<div class="accuracy">${$("koch.result.accuracy")} ${e}%</div>\n\t\t\t\t<div class="comparison">\n\t\t\t\t\t<div>${$("koch.result.sent")} ${s}</div>\n\t\t\t\t\t<div>${$("koch.result.yourInput")} ${n}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="actions">\n\t\t\t\t\t<button id="retryCustomBtn" class="btn">${$("koch.result.retry")}</button>\n\t\t\t\t\t<button id="backToCustomMenuBtn" class="btn primary">${$("koch.result.back")}</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,document.getElementById("retryCustomBtn")?.addEventListener("click",()=>{this.customState.isCustomRunning=!1,this.render(),this.startCustom()}),document.getElementById("backToCustomMenuBtn")?.addEventListener("click",()=>{this.customState.isCustomRunning=!1,this.render()})}
//! ========== Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ ==========
showSettings(){
//! ÁèæÂú®„ÅÆË®≠ÂÆöÂÄ§„ÇíÂèñÂæóÔºàvolume„Çí0-100„ÅÆÁØÑÂõ≤„Å´Â§âÊèõÔºâ„ÄÇ
const t={volume:Math.round(100*this.settings.volume),frequency:this.settings.frequency,wpm:this.settings.characterSpeed,characterSpeed:this.settings.characterSpeed,effectiveSpeed:this.settings.effectiveSpeed,practiceDuration:this.settings.practiceDuration,groupSize:this.settings.groupSize,showInput:this.settings.showInput},e={...this.settings};
//! Ë®≠ÂÆöÂ§âÊõ¥Ââç„ÅÆÂÄ§„Çí‰øùÂ≠òÔºà„Ç≠„É£„É≥„Çª„É´ÊôÇ„ÅÆÂæ©ÂÖÉÁî®Ôºâ„ÄÇ
//! „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫„ÄÇ
new i("koch-settings-modal",r,t,{onSave:t=>{
//! ÂÆüÂäπÈÄüÂ∫¶„ÅØÊñáÂ≠óÈÄüÂ∫¶„Çí‰∏äÈôê„Å®„Åô„Çã„ÄÇ
let e=t.effectiveSpeed;const n=t.characterSpeed;e>n&&(e=n),
//! Ë®≠ÂÆö„Çí‰øùÂ≠ò„ÄÇ
this.settings.characterSpeed=n,this.settings.effectiveSpeed=e,this.settings.frequency=t.frequency,this.settings.volume=t.volume/100,this.settings.practiceDuration=t.practiceDuration,this.settings.groupSize=t.groupSize,this.settings.showInput=t.showInput,this.saveSettings(),
//! AudioGenerator„ÇíÊõ¥Êñ∞„ÄÇ
this.audio.updateSettings({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed}),
//! Á∑¥Áøí‰∏≠„ÅÆÂ†¥Âêà„ÄÅË°®Á§∫„ÇíÊõ¥Êñ∞„ÄÇ
this.state.groups.length>0&&this.renderPractice()},onCancel:()=>{
//! Ë®≠ÂÆö„ÇíÂÖÉ„Å´Êàª„Åô„ÄÇ
this.settings={...e},this.audio.updateSettings({frequency:e.frequency,volume:e.volume,wpm:e.characterSpeed,effectiveWpm:e.effectiveSpeed})}}).show("koch")}
//! ========== „É¨„É≥„ÉÄ„É™„É≥„Ç∞ ==========
render(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="header-top">\n\t\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div id="languageSwitcherContainer"></div>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<button class="back-btn" id="back-btn">${$("common.backToMenu")}</button>\n\t\t\t\t\t<h1>${$("koch.title")}</h1>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="tabs">\n\t\t\t\t\t<button class="tab-button ${"learning"===this.viewMode?"active":""}" data-tab="learning">${$("koch.tabs.learning")}</button>\n\t\t\t\t\t<button class="tab-button ${"custom"===this.viewMode?"active":""}" data-tab="custom">${$("koch.tabs.custom")}</button>\n\t\t\t\t</div>\n\n\t\t\t\t${this.renderModeContent()}\n\t\t\t</div>\n\t\t`,this.attachEventListeners())}renderModeContent(){switch(this.viewMode){case"learning":default:return this.renderLearningMode();case"custom":return this.renderCustomMode()}}renderLearningMode(){const t=u.getCharsForLesson(this.state.currentLesson),e=h.slice(0,40).map((t,e)=>{const n=e+1,s=u.getCharsForLesson(n);return`\n\t\t\t\t<div class="lesson-item ${n===this.state.currentLesson?"current":""} ${n<this.state.currentLesson?"passed":""}" data-lesson="${n}">\n\t\t\t\t\t<div class="lesson-num">L${n}</div>\n\t\t\t\t\t<div class="lesson-chars">${s.join("")}</div>\n\t\t\t\t</div>\n\t\t\t`}).join("");return`\n\t\t\t<div class="flashcard-container">\n\t\t\t\t<div class="lesson-info">\n\t\t\t\t\t<h2>${$("koch.learning.lessonTitle")} ${this.state.currentLesson}${$("koch.learning.lessonProgress")}</h2>\n\t\t\t\t\t<div class="chars">${$("koch.learning.learnedChars")} ${t.join("")}</div>\n\t\t\t\t\t<button id="startBtn" class="btn btn-primary">${$("koch.learning.startPractice")}</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div id="practiceContainer"></div>\n\t\t\t\t<div id="resultContainer"></div>\n\n\t\t\t\t<div class="instructions">\n\t\t\t\t\t<h3>${$("koch.learning.howToUse")}</h3>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>${$("koch.learning.instruction1")}</li>\n\t\t\t\t\t\t<li>${$("koch.learning.instruction2")}</li>\n\t\t\t\t\t\t<li>${$("koch.learning.instruction3")}</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="lesson-list-section">\n\t\t\t\t\t<h3>${$("koch.learning.lessonListTitle")}</h3>\n\t\t\t\t\t<div class="lesson-list">\n\t\t\t\t\t\t${e}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}renderCustomMode(){if(this.customState.isCustomRunning)
//! Á∑¥ÁøíÂÆüË°åÁîªÈù¢„ÄÇ
return'\n\t\t\t\t<div class="flashcard-container">\n\t\t\t\t\t<div id="customPracticeContainer"></div>\n\t\t\t\t\t<div id="customResultContainer"></div>\n\t\t\t\t</div>\n\t\t\t';{
//! ÊñáÂ≠óÈÅ∏ÊäûÁîªÈù¢„ÄÇ
const t=h.map(t=>`\n\t\t\t\t<button class="char-select-btn ${this.customState.selectedChars.has(t)?"selected":""}" data-char="${t}">\n\t\t\t\t\t${t}\n\t\t\t\t</button>\n\t\t\t`).join("");return`\n\t\t\t\t<div class="flashcard-container">\n\t\t\t\t\t<div class="lesson-info">\n\t\t\t\t\t\t<h2>${$("koch.custom.title")}</h2>\n\t\t\t\t\t\t<p>${$("koch.custom.selectPrompt")}</p>\n\t\t\t\t\t\t<div class="char-selection">\n\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button id="startCustomBtn" class="btn btn-primary" ${this.customState.selectedChars.size<2?"disabled":""}>${$("koch.custom.startPractice")}</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="instructions">\n\t\t\t\t\t\t<h3>${$("koch.custom.howToUse")}</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>${$("koch.custom.instruction1")}</li>\n\t\t\t\t\t\t\t<li>${$("koch.custom.instruction2")}</li>\n\t\t\t\t\t\t\t<li>${$("koch.custom.instruction3")}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`}}renderPractice(){const t=document.getElementById("practiceContainer");if(!t)return;const e=u.getCharsForLesson(this.state.currentLesson);t.innerHTML=`\n\t\t\t<div class="practice-area">\n\t\t\t\t<div class="progress-section">\n\t\t\t\t\t<div class="progress-bar-container">\n\t\t\t\t\t\t<div id="progressBar" class="progress-bar" style="width: 0%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="lessonProgress" class="progress-text">${$("koch.practice.ready")}</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="playback-controls">\n\t\t\t\t\t<button id="playBtn" class="control-btn" title="${$("koch.practice.playButton")}">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M8 5v14l11-7z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="pauseBtn" class="control-btn" title="${$("koch.practice.pauseButton")}" disabled>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="stopBtn" class="control-btn" title="${$("koch.practice.stopButton")}">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<rect x="6" y="6" width="12" height="12"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<textarea id="userInput" class="input-area" placeholder="${$("koch.practice.inputPlaceholder")}" ${this.settings.showInput?"":'style="opacity: 0.3; pointer-events: none;"'}></textarea>\n\t\t\t\t${this.renderKeyboard(e)}\n\t\t\t</div>\n\t\t`;const n=document.getElementById("userInput");n&&n.addEventListener("input",t=>{this.state.userInput=t.target.value.toUpperCase()}),document.getElementById("playBtn")?.addEventListener("click",()=>{this.playMorse()}),document.getElementById("pauseBtn")?.addEventListener("click",()=>{this.pauseMorse()}),document.getElementById("stopBtn")?.addEventListener("click",()=>{this.stopLesson()}),
//! „Ç≠„Éº„Éú„Éº„Éâ„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„ÉàË®≠ÂÆö„ÄÇ
this.setupKeyboardEvents(e),this.updatePlaybackButtons()}renderCustomPractice(){const t=document.getElementById("customPracticeContainer");t&&(t.innerHTML=`\n\t\t\t<div class="practice-area">\n\t\t\t\t<div class="progress-section">\n\t\t\t\t\t<div class="progress-bar-container">\n\t\t\t\t\t\t<div id="customProgressBar" class="progress-bar" style="width: 0%"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="customProgress" class="progress-text">${$("koch.practice.ready")}</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="playback-controls">\n\t\t\t\t\t<button id="customPlayBtn" class="control-btn" title="${$("koch.practice.playButton")}">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M8 5v14l11-7z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="customPauseBtn" class="control-btn" title="${$("koch.practice.pauseButton")}" disabled>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="customStopBtn" class="control-btn" title="${$("koch.practice.stopButton")}">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<rect x="6" y="6" width="12" height="12"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t${this.settings.showInput?`\n\t\t\t\t\t<textarea id="customInputArea" class="input-area" placeholder="${$("koch.practice.customInputPlaceholder")}"></textarea>\n\t\t\t\t`:""}\n\n\t\t\t\t<button id="customEndBtn" class="btn btn-primary">${$("koch.practice.showResult")}</button>\n\t\t\t</div>\n\t\t`,this.setupCustomControls())}renderKeyboard(t){const e=[];
//! KOCH_SEQUENCE„ÇígroupSize„Åî„Å®„Å´ÂàÜÂâ≤„ÄÇ
for(let n=0;n<h.length;n+=this.settings.groupSize)e.push(h.slice(n,n+this.settings.groupSize));return`\n\t\t\t<div class="keyboard">\n\t\t\t\t<div class="keyboard-header">\n\t\t\t\t\t<small>${$("koch.keyboard.header")}</small>\n\t\t\t\t</div>\n\t\t\t\t<div class="keyboard-controls">\n\t\t\t\t\t<button id="spaceBtn" class="key-btn special">${$("koch.keyboard.space")}</button>\n\t\t\t\t\t<button id="backspaceBtn" class="key-btn special">${$("koch.keyboard.backspace")}</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="keyboard-groups-wrapper">\n\t\t\t\t\t<div class="keyboard-groups">\n\t\t\t\t\t\t${e.map((e,n)=>`\n\t\t\t\t\t\t\t<div class="keyboard-group">\n\t\t\t\t\t\t\t\t<div class="group-label">${$("koch.keyboard.groupLabel")}${n+1}</div>\n\t\t\t\t\t\t\t\t<div class="group-keys">\n\t\t\t\t\t\t\t\t\t${e.map(e=>{const n=t.includes(e);return`\n\t\t\t\t\t\t\t\t\t\t\t<button class="key-btn ${n?"":"disabled"}"\n\t\t\t\t\t\t\t\t\t\t\t        data-char="${e}"\n\t\t\t\t\t\t\t\t\t\t\t        ${n?"":"disabled"}>\n\t\t\t\t\t\t\t\t\t\t\t\t${e}\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t`}).join("")}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}setupKeyboardEvents(t){const e=document.getElementById("userInput");e&&(
//! ÊñáÂ≠ó„Ç≠„Éº„ÄÇ
document.querySelectorAll(".key-btn:not(.special)").forEach(n=>{n.addEventListener("click",n=>{n.preventDefault();const s=n.target.getAttribute("data-char");s&&t.includes(s)&&(e.value+=s,this.state.userInput=e.value.toUpperCase())})}),
//! „Çπ„Éö„Éº„Çπ„Ç≠„Éº„ÄÇ
document.getElementById("spaceBtn")?.addEventListener("click",t=>{t.preventDefault(),e.value+=" ",this.state.userInput=e.value.toUpperCase()}),
//! „Éê„ÉÉ„ÇØ„Çπ„Éö„Éº„Çπ„Ç≠„Éº„ÄÇ
document.getElementById("backspaceBtn")?.addEventListener("click",t=>{t.preventDefault(),e.value=e.value.slice(0,-1),this.state.userInput=e.value.toUpperCase()}))}setupCustomControls(){
//! ÂÖ•ÂäõÊ¨Ñ„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÄÇ
const t=document.getElementById("customInputArea");t&&t.addEventListener("input",t=>{this.customState.customUserInput=t.target.value.toUpperCase()}),document.getElementById("customPlayBtn")?.addEventListener("click",()=>{this.playCustomMorse()}),document.getElementById("customPauseBtn")?.addEventListener("click",()=>{this.pauseCustomMorse()}),document.getElementById("customStopBtn")?.addEventListener("click",()=>{this.stopCustom()}),document.getElementById("customEndBtn")?.addEventListener("click",()=>{this.showCustomResult()}),this.updateCustomPlaybackButtons()}attachEventListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
document.getElementById("back-btn")?.addEventListener("click",()=>{window.location.hash="#menu"}),
//! Ë®≠ÂÆö„Ç¢„Ç§„Ç≥„É≥„ÄÇ
document.getElementById("settingsIcon")?.addEventListener("click",()=>{this.showSettings()});
//! Ë®ÄË™ûÂàá„ÇäÊõø„Åà„ÄÇ
const t=document.getElementById("languageSwitcherContainer");t&&this.languageSwitcher.attachEventListeners(t),
//! „Çø„Éñ„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".tab-button").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-tab");e&&(this.viewMode=e,this.saveViewMode(),this.render())})}),
//! „É¢„Éº„ÉâÂà•„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö„ÄÇ
this.setupModeEventListeners()}setupModeEventListeners(){"learning"===this.viewMode?(document.getElementById("startBtn")?.addEventListener("click",()=>{this.startLesson()}),
//! „É¨„ÉÉ„Çπ„É≥„Ç¢„Ç§„ÉÜ„É†„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„ÄÇ
document.querySelectorAll(".lesson-item").forEach(t=>{t.addEventListener("click",()=>{const e=parseInt(t.getAttribute("data-lesson")||"1",10);this.state.currentLesson=e,this.saveProgress(),this.render(),window.scrollTo({top:0,behavior:"smooth"})})})):"custom"===this.viewMode&&(this.customState.isCustomRunning||(document.getElementById("startCustomBtn")?.addEventListener("click",()=>{this.startCustom()}),
//! ÊñáÂ≠óÈÅ∏Êäû„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".char-select-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-char");e&&(this.customState.selectedChars.has(e)?this.customState.selectedChars.delete(e):this.customState.selectedChars.add(e),this.saveSelectedChars(),this.render())})})))}destroy(){
//! Èü≥Â£∞„ÇíÂÅúÊ≠¢„ÄÇ
this.audio.stopPlaying()}}const M={characterSpeed:20,effectiveSpeed:15,frequency:700,bFrequency:600,volume:.7};class x{audio;audioB;settings={...M};state={currentCategory:"qso",selectedTemplate:null,isPlaying:!1,userInput:"",showResult:!1,showAnswer:!1,showDialogFormat:!1};customTemplates=[];constructor(){
//! Ë®≠ÂÆö„ÇíË™≠„ÅøËæº„ÇÄ„ÄÇ
this.loadSettings(),this.loadCategory(),this.loadCustomTemplates(),
//! AÂÅ¥„ÅÆAudioGenerator„ÇíÂàùÊúüÂåñ„ÄÇ
this.audio=new n({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed}),
//! BÂÅ¥„ÅÆAudioGenerator„ÇíÂàùÊúüÂåñ„ÄÇ
this.audioB=new n({frequency:this.settings.bFrequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed})}
//! ========== Ë®≠ÂÆöÁÆ°ÁêÜ ==========
loadSettings(){try{const t=localStorage.getItem("v10.listening.settings");t&&(this.settings={...M,...JSON.parse(t)})}catch(t){}}saveSettings(){try{localStorage.setItem("v10.listening.settings",JSON.stringify(this.settings))}catch(t){}}loadCategory(){try{const t=localStorage.getItem("v10.listening.category");t&&["qso","text100","text200","text300","custom"].includes(t)&&(this.state.currentCategory=t)}catch(t){}}saveCategory(){try{localStorage.setItem("v10.listening.category",this.state.currentCategory)}catch(t){}}loadCustomTemplates(){try{const t=localStorage.getItem("v10.listening.customTemplates");t&&(this.customTemplates=JSON.parse(t))}catch(t){}}saveCustomTemplates(){try{localStorage.setItem("v10.listening.customTemplates",JSON.stringify(this.customTemplates))}catch(t){}}
//! ========== „ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ ==========
getTemplates(){if("custom"===this.state.currentCategory){return[{id:"qso-random-generate",category:"qso",title:"„É©„É≥„ÉÄ„É†QSOÁîüÊàê",content:""},...this.customTemplates]}{const t=p.getBuiltinTemplates(this.state.currentCategory);
//! QSO„Ç´„ÉÜ„Ç¥„É™„Éº„Å´„ÅØ„É©„É≥„ÉÄ„É†QSOÁîüÊàê„Éú„Çø„É≥„ÇíËøΩÂä†„ÄÇ
if("qso"===this.state.currentCategory){return[{id:"qso-random-generate",category:"qso",title:"„É©„É≥„ÉÄ„É†QSOÁîüÊàê",content:""},...t]}return t}}
//! ========== ÂÜçÁîüÂà∂Âæ° ==========
async playMorse(){if(this.state.selectedTemplate&&!this.state.isPlaying){
//! „ÉÜ„É≥„Éó„É¨„Éº„Éà„Å´Âøú„Åò„Å¶ÂÜçÁîüÔºàdialog„Åå„ÅÇ„Çå„Å∞A/B‰∫§‰∫í„ÄÅ„Å™„Åë„Çå„Å∞content„ÇíÂÜçÁîüÔºâ„ÄÇ
if(this.state.isPlaying=!0,this.updatePlaybackButtons(),this.state.showDialogFormat&&this.state.selectedTemplate.dialog)
//! ÂØæË©±ÂΩ¢Âºè„ÅßÂÜçÁîüÔºàAÂÅ¥„Å®BÂÅ¥„Çí‰∫§‰∫í„Å´ÂÜçÁîüÔºâ„ÄÇ
await this.playDialogQSO(this.state.selectedTemplate);else if(this.state.selectedTemplate.content){
//! ÈÄöÂ∏∏„É¢„Éº„Éâ„ÅßÂÜçÁîüÔºàÂÖ®‰Ωì„ÇíAÂÅ¥„ÅßÂÜçÁîüÔºâ„ÄÇ
const t=d.textToMorse(this.state.selectedTemplate.content);await this.audio.playMorseString(t)}this.state.isPlaying=!1,this.updatePlaybackButtons()}}getTemplateText(t){return t.dialog&&t.dialog.length>0?t.dialog.map(t=>t.text).join(" BT "):t.content||""}async playDialogQSO(t){
//! dialog„Åå„Å™„ÅÑÂ†¥ÂêàÔºà„ÉÜ„Ç≠„Çπ„Éà„Ç´„ÉÜ„Ç¥„É™Ôºâ„ÅØcontent„ÇíÂÜçÁîü„ÄÇ
if(t.dialog&&0!==t.dialog.length)
//! ÂêÑ„Çª„Ç∞„É°„É≥„Éà„Çí‰∫§‰∫í„Å´AÂÅ¥„Å®BÂÅ¥„ÅßÂÜçÁîü„ÄÇ
for(let e=0;e<t.dialog.length;e++){const n=t.dialog[e],s=d.textToMorse(n.text),a="A"===n.side?this.audio:this.audioB;await a.playMorseString(s),
//! „Çª„Ç∞„É°„É≥„ÉàÈñì„Å´Áü≠„ÅÑÈñìÈöî„ÇíÂÖ•„Çå„Çã„ÄÇ
e<t.dialog.length-1&&await new Promise(t=>setTimeout(t,500))}else if(t.content){const e=d.textToMorse(t.content);await this.audio.playMorseString(e)}}pauseMorse(){this.audio.stopPlaying(),this.state.isPlaying=!1,this.updatePlaybackButtons()}stopMorse(){this.audio.stopPlaying(),this.state.isPlaying=!1,this.state.userInput="",this.state.showResult=!1,this.state.showAnswer=!1,this.renderPracticeArea()}updatePlaybackButtons(){const t=document.getElementById("playBtn"),e=document.getElementById("pauseBtn");t&&(t.disabled=this.state.isPlaying),e&&(e.disabled=!this.state.isPlaying)}
//! ========== Êé°ÁÇπ„Å®ÁµêÊûúË°®Á§∫ ==========
checkAnswer(){this.state.selectedTemplate&&(this.state.showResult=!0,this.state.showAnswer=!0,this.renderPracticeArea())}toggleAnswer(){this.state.showAnswer=!this.state.showAnswer,this.renderPracticeArea()}toggleDialogFormat(){this.state.showDialogFormat=!this.state.showDialogFormat,this.renderAnswer()}
//! ========== „Ç´„Çπ„Çø„É†„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ ==========
showCustomTemplateDialog(t){const e=!!t,n=e?t.title:"",s=e?t.content:"",a=document.createElement("div");a.className="modal-overlay",a.innerHTML=`\n\t\t\t<div class="modal">\n\t\t\t\t<h2>${e?"„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁ∑®ÈõÜ":"„ÉÜ„É≥„Éó„É¨„Éº„ÉàÊñ∞Ë¶è‰ΩúÊàê"}</h2>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label for="templateTitle">„Çø„Ç§„Éà„É´:</label>\n\t\t\t\t\t<input type="text" id="templateTitle" value="${n}" placeholder="„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ">\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label for="templateContent">ÂÜÖÂÆπ:</label>\n\t\t\t\t\t<textarea id="templateContent" placeholder="„É¢„Éº„É´„Çπ‰ø°Âè∑„Å´Â§âÊèõ„Åô„Çã„ÉÜ„Ç≠„Çπ„Éà„ÇíÂÖ•Âäõ">${s}</textarea>\n\t\t\t\t</div>\n\t\t\t\t<div class="modal-actions">\n\t\t\t\t\t<button id="saveTemplateBtn" class="btn btn-primary">‰øùÂ≠ò</button>\n\t\t\t\t\t<button id="cancelTemplateBtn" class="btn">„Ç≠„É£„É≥„Çª„É´</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,document.body.appendChild(a),
//! ‰øùÂ≠ò„Éú„Çø„É≥„ÄÇ
document.getElementById("saveTemplateBtn")?.addEventListener("click",()=>{const n=document.getElementById("templateTitle"),s=document.getElementById("templateContent");if(n.value.trim()&&s.value.trim()){if(e&&t)
//! Êó¢Â≠ò„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÊõ¥Êñ∞„ÄÇ
t.title=n.value.trim(),t.content=s.value.trim().toUpperCase();else{
//! Êñ∞Ë¶è„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíËøΩÂä†„ÄÇ
const t={id:`custom-${Date.now()}`,category:"qso",title:n.value.trim(),content:s.value.trim().toUpperCase()};this.customTemplates.push(t)}this.saveCustomTemplates(),a.remove(),this.render()}else alert("„Çø„Ç§„Éà„É´„Å®ÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ")}),
//! „Ç≠„É£„É≥„Çª„É´„Éú„Çø„É≥„ÄÇ
document.getElementById("cancelTemplateBtn")?.addEventListener("click",()=>{a.remove()}),
//! „É¢„Éº„ÉÄ„É´Â§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã„ÄÇ
a.addEventListener("click",t=>{t.target===a&&a.remove()})}deleteCustomTemplate(t){confirm("„Åì„ÅÆÂÆöÂûãÊñá„ÇíÂâäÈô§„Åó„Åæ„Åô„Åã?")&&(this.customTemplates=this.customTemplates.filter(e=>e.id!==t),this.saveCustomTemplates(),this.render())}
//! ========== Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ ==========
showSettings(){
//! ÁèæÂú®„ÅÆË®≠ÂÆöÂÄ§„ÇíÂèñÂæóÔºàvolume„Çí0-100„ÅÆÁØÑÂõ≤„Å´Â§âÊèõÔºâ„ÄÇ
const t={characterSpeed:this.settings.characterSpeed,effectiveSpeed:this.settings.effectiveSpeed,frequency:this.settings.frequency,bFrequency:this.settings.bFrequency,volume:Math.round(100*this.settings.volume)},e={...this.settings};
//! Ë®≠ÂÆöÂ§âÊõ¥Ââç„ÅÆÂÄ§„Çí‰øùÂ≠òÔºà„Ç≠„É£„É≥„Çª„É´ÊôÇ„ÅÆÂæ©ÂÖÉÁî®Ôºâ„ÄÇ
//! „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫„ÄÇ
new i("listening-settings-modal",r,t,{onSave:t=>{
//! ÂÆüÂäπÈÄüÂ∫¶„ÅØÊñáÂ≠óÈÄüÂ∫¶„Çí‰∏äÈôê„Å®„Åô„Çã„ÄÇ
let e=t.effectiveSpeed;const n=t.characterSpeed;e>n&&(e=n),
//! Ë®≠ÂÆö„Çí‰øùÂ≠ò„ÄÇ
this.settings.characterSpeed=n,this.settings.effectiveSpeed=e,this.settings.frequency=t.frequency,this.settings.bFrequency=t.bFrequency,this.settings.volume=t.volume/100,this.saveSettings(),
//! AÂÅ¥„ÅÆAudioGenerator„ÇíÊõ¥Êñ∞„ÄÇ
this.audio.updateSettings({frequency:this.settings.frequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed}),
//! BÂÅ¥„ÅÆAudioGenerator„ÇíÊõ¥Êñ∞„ÄÇ
this.audioB.updateSettings({frequency:this.settings.bFrequency,volume:this.settings.volume,wpm:this.settings.characterSpeed,effectiveWpm:this.settings.effectiveSpeed})},onCancel:()=>{
//! Ë®≠ÂÆö„ÇíÂÖÉ„Å´Êàª„Åô„ÄÇ
this.settings={...e},this.audio.updateSettings({frequency:e.frequency,volume:e.volume,wpm:e.characterSpeed,effectiveWpm:e.effectiveSpeed}),this.audioB.updateSettings({frequency:e.bFrequency,volume:e.volume,wpm:e.characterSpeed,effectiveWpm:e.effectiveSpeed})},onTestPlay:async()=>{
//! „ÉÜ„Çπ„ÉàÂÜçÁîü: AÂÅ¥„Å®BÂÅ¥„ÅÆÂë®Ê≥¢Êï∞„ÅßÈ†ÜÁï™„Å´ÂÜçÁîü„ÄÇ
const t=d.textToMorse("CQ");await this.audio.playMorseString(t),await new Promise(t=>setTimeout(t,500)),await this.audioB.playMorseString(t)}}).show("listening")}
//! ========== „É¨„É≥„ÉÄ„É™„É≥„Ç∞ ==========
render(){const t=document.getElementById("app");t&&(t.innerHTML=`\n\t\t\t<div class="settings-icon" id="settingsIcon">\n\t\t\t\t<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="container">\n\t\t\t\t<header class="header">\n\t\t\t\t\t<button id="backBtn" class="back-btn">‚Üê Êàª„Çã</button>\n\t\t\t\t\t<h1>„É¢„Éº„É´„Çπ‰ø°Âè∑ËÅû„ÅçÂèñ„ÇäÁ∑¥Áøí</h1>\n\t\t\t\t</header>\n\n\t\t\t\t<div class="tabs">\n\t\t\t\t\t${this.renderCategoryTabs()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class="content-area">\n\t\t\t\t\t${this.state.selectedTemplate?this.renderPracticeContent():this.renderTemplateList()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.attachEventListeners())}renderCategoryTabs(){return[{id:"qso",label:"„É©„Éê„Éº„Çπ„Çø„É≥„ÉóQSO"},{id:"text100",label:"Ëã±Êñá100Â≠ó"},{id:"text200",label:"Ëã±Êñá200Â≠ó"},{id:"text300",label:"Ëã±Êñá300Â≠ó"},{id:"custom",label:"„É¶„Éº„Ç∂„ÉºÂÆöÁæ©"}].map(t=>`\n\t\t\t<button class="tab-button ${this.state.currentCategory===t.id?"active":""}" data-category="${t.id}">\n\t\t\t\t${t.label}\n\t\t\t</button>\n\t\t`).join("")}renderTemplateList(){const t=this.getTemplates();return 0===t.length||1===t.length&&"qso-random-generate"===t[0].id?`\n\t\t\t\t<div class="empty-state">\n\t\t\t\t\t<p>ÂÆöÂûãÊñá„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>\n\t\t\t\t\t${"custom"===this.state.currentCategory?'<button id="addCustomBtn" class="btn btn-primary">Êñ∞Ë¶è‰ΩúÊàê</button>':""}\n\t\t\t\t</div>\n\t\t\t`:`\n\t\t\t<div class="template-list">\n\t\t\t\t${"custom"===this.state.currentCategory?'<button id="addCustomBtn" class="btn btn-primary">Êñ∞Ë¶è‰ΩúÊàê</button>':""}\n\t\t\t\t${t.map(t=>{const e=this.getTemplateText(t),n="qso-random-generate"===t.id?"„Ç≥„Éº„É´„Çµ„Ç§„É≥„ÄÅÂú∞Âêç„ÄÅÂêçÂâç„ÄÅRS„É¨„Éù„Éº„Éà„ÄÅ„É™„Ç∞„Å™„Å©„Åå„É©„É≥„ÉÄ„É†„Å´ÁîüÊàê„Åï„Çå„ÅüÂÆåÂÖ®„Å™QSO„Åå‰ΩúÊàê„Åï„Çå„Åæ„Åô„ÄÇÊØéÂõûÁï∞„Å™„ÇãÂÜÖÂÆπ„ÅßÁ∑¥Áøí„Åß„Åç„Åæ„Åô„ÄÇ":`${e.substring(0,100)}${e.length>100?"...":""}`;return`\n\t\t\t\t\t<div class="template-card" data-template-id="${t.id}">\n\t\t\t\t\t\t<h3>${t.title}</h3>\n\t\t\t\t\t\t<p class="template-preview">${n}</p>\n\t\t\t\t\t\t<div class="template-actions">\n\t\t\t\t\t\t\t<button class="btn select-btn" data-template-id="${t.id}">ÈÅ∏Êäû</button>\n\t\t\t\t\t\t\t${"custom"===this.state.currentCategory&&"qso-random-generate"!==t.id?`\n\t\t\t\t\t\t\t\t<button class="btn edit-btn" data-template-id="${t.id}">Á∑®ÈõÜ</button>\n\t\t\t\t\t\t\t\t<button class="btn delete-btn" data-template-id="${t.id}">ÂâäÈô§</button>\n\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`}).join("")}\n\t\t\t</div>\n\t\t`}renderPracticeContent(){return this.state.selectedTemplate?`\n\t\t\t<div class="practice-area">\n\t\t\t\t<div class="practice-header">\n\t\t\t\t\t<h2>${this.state.selectedTemplate.title}</h2>\n\t\t\t\t\t<button id="backToListBtn" class="btn">‰∏ÄË¶ß„Å´Êàª„Çã</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="playback-controls">\n\t\t\t\t\t<button id="playBtn" class="control-btn" title="ÂÜçÁîü" ${this.state.isPlaying?"disabled":""}>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M8 5v14l11-7z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="pauseBtn" class="control-btn" title="‰∏ÄÊôÇÂÅúÊ≠¢" ${this.state.isPlaying?"":"disabled"}>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="stopBtn" class="control-btn" title="ÂÅúÊ≠¢">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<rect x="6" y="6" width="12" height="12"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button id="downloadBtn" class="control-btn" title="WAV„Éï„Ç°„Ç§„É´„Å®„Åó„Å¶„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">\n\t\t\t\t\t\t\t<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div id="practiceInputArea"></div>\n\t\t\t</div>\n\t\t`:""}renderPracticeArea(){const t=document.getElementById("practiceInputArea");if(!t)return;t.innerHTML=`\n\t\t\t<div class="input-section">\n\t\t\t\t<label for="userInput">ËÅû„ÅçÂèñ„Å£„ÅüÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:</label>\n\t\t\t\t<textarea id="userInput" class="input-area" placeholder="ËÅû„ÅçÂèñ„Å£„ÅüÊñáÂ≠ó„ÇíÂÖ•Âäõ...">${this.state.userInput}</textarea>\n\t\t\t</div>\n\n\t\t\t<div class="action-buttons">\n\t\t\t\t<button id="checkBtn" class="btn btn-primary">Êé°ÁÇπ</button>\n\t\t\t\t<button id="showAnswerBtn" class="btn">${this.state.showAnswer?"Ê≠£Ëß£„ÇíÈùûË°®Á§∫":"Ê≠£Ëß£„ÇíË°®Á§∫"}</button>\n\t\t\t</div>\n\n\t\t\t${this.state.showAnswer?'<div id="answerArea"></div>':""}\n\t\t\t${this.state.showResult?'<div id="resultArea"></div>':""}\n\t\t`;
//! „É¶„Éº„Ç∂„ÉºÂÖ•Âäõ„ÅÆÁõ£Ë¶ñ„ÄÇ
const e=document.getElementById("userInput");e?.addEventListener("input",()=>{this.state.userInput=e.value}),
//! Êé°ÁÇπ„Éú„Çø„É≥„ÄÇ
document.getElementById("checkBtn")?.addEventListener("click",()=>{this.checkAnswer()}),
//! Ê≠£Ëß£Ë°®Á§∫„Éú„Çø„É≥„ÄÇ
document.getElementById("showAnswerBtn")?.addEventListener("click",()=>{this.toggleAnswer()}),
//! Ê≠£Ëß£„Å®ÁµêÊûú„ÇíÊèèÁîª„ÄÇ
this.state.showAnswer&&this.renderAnswer(),this.state.showResult&&this.renderResult()}renderAnswer(){const t=document.getElementById("answerArea");if(!t||!this.state.selectedTemplate)return;const e="qso"===this.state.selectedTemplate.category,n=this.getTemplateText(this.state.selectedTemplate),s=e?`<button id="toggleDialogBtn" class="btn" style="margin-left: 10px;">${this.state.showDialogFormat?"ÈÄöÂ∏∏Ë°®Á§∫":"ÂØæË©±ÂΩ¢Âºè„ÅßË°®Á§∫"}</button>`:"";
//! ÂØæË©±ÂΩ¢ÂºèË°®Á§∫„ÅÆÁîüÊàê„ÄÇ
let a="";if(e&&this.state.showDialogFormat){a=`\n\t\t\t\t<table class="dialog-table">\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t${n.split(/\s+BT\s+/).map((t,e)=>`\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class="speaker-cell">${e%2==0?"A":"B"}</td>\n\t\t\t\t\t\t\t\t\t<td class="content-cell">${t.trim()}</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t`).join("")}\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t`}else a=`<div class="answer-text">${n}</div>`;t.innerHTML=`\n\t\t\t<div class="answer-area">\n\t\t\t\t<h3 style="display: inline-block;">Ê≠£Ëß£</h3>\n\t\t\t\t${s}\n\t\t\t\t${a}\n\t\t\t</div>\n\t\t`,
//! ÂØæË©±ÂΩ¢Âºè„Éú„Çø„É≥„ÄÇ
document.getElementById("toggleDialogBtn")?.addEventListener("click",()=>{this.toggleDialogFormat()})}renderResult(){const t=document.getElementById("resultArea");if(!t||!this.state.selectedTemplate)return;const e=this.getTemplateText(this.state.selectedTemplate),n=p.calculateAccuracy(e,this.state.userInput);t.innerHTML=`\n\t\t\t<div class="result-area">\n\t\t\t\t<h3>ÁµêÊûú</h3>\n\t\t\t\t<div class="accuracy">Ê≠£Á≠îÁéá: ${n}%</div>\n\t\t\t\t<div class="comparison">\n\t\t\t\t\t<div class="comparison-row">\n\t\t\t\t\t\t<strong>Ê≠£Ëß£:</strong>\n\t\t\t\t\t\t<div class="comparison-text">${e}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="comparison-row">\n\t\t\t\t\t\t<strong>ÂÖ•Âäõ:</strong>\n\t\t\t\t\t\t<div class="comparison-text">${this.state.userInput||"ÔºàÊú™ÂÖ•ÂäõÔºâ"}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}
//! ========== „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº ==========
attachEventListeners(){
//! Êàª„Çã„Éú„Çø„É≥„ÄÇ
document.getElementById("backBtn")?.addEventListener("click",()=>{window.location.hash="#menu"}),
//! Ë®≠ÂÆö„Ç¢„Ç§„Ç≥„É≥„ÄÇ
document.getElementById("settingsIcon")?.addEventListener("click",()=>{this.showSettings()}),
//! „Ç´„ÉÜ„Ç¥„É™„Éº„Çø„Éñ„ÄÇ
document.querySelectorAll(".tab-button").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-category");e&&(this.state.currentCategory=e,this.state.selectedTemplate=null,this.state.showResult=!1,this.state.showAnswer=!1,this.state.showDialogFormat=!1,this.state.userInput="",this.saveCategory(),this.render())})}),
//! ÂÆöÂûãÊñáÈÅ∏Êäû„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".select-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-template-id");if(e)
//! „É©„É≥„ÉÄ„É†QSOÁîüÊàê„Éú„Çø„É≥„ÅÆÂ†¥Âêà„ÄÇ
if("qso-random-generate"===e)this.state.selectedTemplate=p.generateRandomQSO(),this.state.showResult=!1,this.state.showAnswer=!1,this.state.showDialogFormat=!1,this.state.userInput="",this.render(),this.renderPracticeArea();else{
//! ÈÄöÂ∏∏„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„ÉàÈÅ∏Êäû„ÄÇ
const t=[...p.getBuiltinTemplates(),...this.customTemplates].find(t=>t.id===e);t&&(this.state.selectedTemplate=t,this.state.showResult=!1,this.state.showAnswer=!1,this.state.showDialogFormat=!1,this.state.userInput="",this.render(),this.renderPracticeArea())}})}),
//! ‰∏ÄË¶ß„Å´Êàª„Çã„Éú„Çø„É≥„ÄÇ
document.getElementById("backToListBtn")?.addEventListener("click",()=>{this.state.selectedTemplate=null,this.state.showResult=!1,this.state.showAnswer=!1,this.state.showDialogFormat=!1,this.state.userInput="",this.audio.stopPlaying(),this.render()}),
//! „É¶„Éº„Ç∂„ÉºÂÆöÁæ©ÂÆöÂûãÊñá„ÅÆÊñ∞Ë¶è‰ΩúÊàê„Éú„Çø„É≥„ÄÇ
document.getElementById("addCustomBtn")?.addEventListener("click",()=>{this.showCustomTemplateDialog()}),
//! „É¶„Éº„Ç∂„ÉºÂÆöÁæ©ÂÆöÂûãÊñá„ÅÆÁ∑®ÈõÜ„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".edit-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-template-id");if(e){const t=this.customTemplates.find(t=>t.id===e);t&&this.showCustomTemplateDialog(t)}})}),
//! „É¶„Éº„Ç∂„ÉºÂÆöÁæ©ÂÆöÂûãÊñá„ÅÆÂâäÈô§„Éú„Çø„É≥„ÄÇ
document.querySelectorAll(".delete-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-template-id");e&&this.deleteCustomTemplate(e)})}),
//! ÂÜçÁîü„Ç≥„É≥„Éà„É≠„Éº„É´ÔºàÁ∑¥ÁøíÁîªÈù¢„ÅÆ„ÅøÔºâ„ÄÇ
this.state.selectedTemplate&&(document.getElementById("playBtn")?.addEventListener("click",()=>{this.playMorse()}),document.getElementById("pauseBtn")?.addEventListener("click",()=>{this.pauseMorse()}),document.getElementById("stopBtn")?.addEventListener("click",()=>{this.stopMorse()}),document.getElementById("downloadBtn")?.addEventListener("click",()=>{this.downloadWav()}),this.renderPracticeArea())}async downloadWav(){if(this.state.selectedTemplate)try{
//! „ÉÜ„Ç≠„Çπ„Éà„Çí„É¢„Éº„É´„ÇπÁ¨¶Âè∑„Å´Â§âÊèõ„ÄÇ
const t=this.getTemplateText(this.state.selectedTemplate),e=d.textToMorse(t),n=await this.audio.generateWav(e);!function(t,e){const n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}(n,`${function(t){return t.replace(/[^a-zA-Z0-9_-]/g,"_")}(this.state.selectedTemplate.title)}.wav`)}catch(t){alert("WAV„Éï„Ç°„Ç§„É´„ÅÆÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ")}}destroy(){
//! AudioGenerator„ÇíÂÅúÊ≠¢„ÄÇ
this.audio.stopPlaying()}}class q{currentView=null;routes=[];constructor(){
//! „É´„Éº„ÉàÂÆöÁæ©„ÄÇ
this.routes=[{path:"",view:C},{path:"menu",view:C},{path:"vertical",view:E},{path:"horizontal",view:k},{path:"flashcard",view:T},{path:"koch",view:B},{path:"listening",view:x}]}init(){
//! „Éè„ÉÉ„Ç∑„É•Â§âÊõ¥ÊôÇ„ÅÆ„É™„Çπ„Éä„Éº„ÇíÁôªÈå≤„ÄÇ
window.addEventListener("hashchange",()=>this.handleRoute()),
//! ÂàùÂõû„É´„Éº„ÉÜ„Ç£„É≥„Ç∞„ÄÇ
this.handleRoute()}handleRoute(){
//! ÁèæÂú®„ÅÆ„Éì„É•„Éº„ÇíÁ†¥Ê£Ñ„ÄÇ
this.currentView&&(this.currentView.destroy(),this.currentView=null);
//! „Éè„ÉÉ„Ç∑„É•„Åã„Çâ„Éë„Çπ„ÇíÂèñÂæóÔºà#„ÇíÈô§ÂéªÔºâ„ÄÇ
const t=window.location.hash.slice(1),e=this.routes.find(e=>e.path===t);e?(
//! „Éì„É•„Éº„Çí‰ΩúÊàê„Åó„Å¶„É¨„É≥„ÉÄ„É™„É≥„Ç∞„ÄÇ
this.currentView=new e.view,this.currentView.render()):
//! Ë©≤ÂΩì„Åô„Çã„É´„Éº„Éà„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„É°„Éã„É•„Éº„Å´ÈÅ∑Áßª„ÄÇ
window.location.hash="#menu"}navigate(t){window.location.hash=`#${t}`}}
//! „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ëµ∑ÂãïÊôÇ„ÅÆÂá¶ÁêÜ„ÄÇ
function A(){b=f();(new q).init()}
//! DOMContentLoadedÂæå„Å´ÂàùÊúüÂåñ„ÄÇ
"loading"===document.readyState?document.addEventListener("DOMContentLoaded",A):A();
//# sourceMappingURL=index-CKd3pipR.js.map
